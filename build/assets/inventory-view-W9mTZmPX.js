import{n as oe,r as o,j as e,L as i,I as d,B as f,o as Fe,p as we,q as qe,t as u,s as Ee,C as De,h as Be,i as Te,k as Ue,P as Me,v as ne,c as $e,w as Ve,x as Oe,y as Re,z as He}from"./index-DyWq3L3w.js";import{B as ze}from"./badge-BiRkMtjm.js";import{D as _,a as G,b as Q,c as J,d as K,S as I,e as L,f as A,g as F,h as g,i as _e,u as Ge,j as Qe,k as Je,l as ie,P as Ke,m as We,B as Xe,T as Ye,n as Ze,o as ea,E as aa,p as ra,q as ta,r as ce,s as h,t as sa,v as x,w as la}from"./bulk-delete-dialog-BXHSaD15.js";/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const na=[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]],ia=oe("funnel",na);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ca=[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]],da=oe("square-pen",ca);function oa({open:S,onOpenChange:B,title:y,description:N,itemCount:j,field:p,onConfirm:b,isLoading:w=!1}){const[C,k]=o.useState(""),T=()=>{C&&(b(C),k(""))},P=r=>{r||k(""),B(r)};return e.jsx(_,{open:S,onOpenChange:P,children:e.jsxs(G,{children:[e.jsxs(Q,{children:[e.jsx(J,{children:y}),e.jsxs(K,{children:[N," (",j," item",j!==1?"s":"",")"]})]}),e.jsxs("div",{className:"py-4",children:[e.jsx(i,{htmlFor:"bulk-update-field",children:p.label}),p.type==="select"&&p.options?e.jsxs(I,{value:C,onValueChange:k,children:[e.jsx(L,{id:"bulk-update-field",className:"mt-2",children:e.jsx(A,{placeholder:p.placeholder||"Select..."})}),e.jsx(F,{children:p.options.map(r=>e.jsx(g,{value:r.value,children:r.label},r.value))})]}):e.jsx(d,{id:"bulk-update-field",type:p.type,value:C,onChange:r=>k(r.target.value),placeholder:p.placeholder,min:p.min,step:p.step,className:"mt-2"})]}),e.jsxs(_e,{children:[e.jsx(f,{variant:"outline",onClick:()=>P(!1),disabled:w,children:"Cancel"}),e.jsx(f,{onClick:T,disabled:w||!C,children:w?"Updating...":`Update ${j} item${j!==1?"s":""}`})]})]})})}const de=["Electronics","Furniture","Clothing","Food"];function ha(){const{inventory:S,isLoading:B,setInventory:y}=Fe(),{suppliers:N}=we(),[j,p]=o.useState(""),[b,w]=o.useState("all"),[C,k]=o.useState(!1),[T,P]=o.useState(null),[r,n]=o.useState({id:"",name:"",category:"Electronics",quantity:0,location:"",reorderLevel:0,brand:"",pricePerPiece:0,supplierId:"",maintainStockAt:0,minimumStock:0}),[l,E]=o.useState({}),U=Ge(j,300),W=o.useMemo(()=>S?S.map(a=>!a.brand||a.pricePerPiece===void 0||!a.supplierId||a.maintainStockAt===void 0||a.minimumStock===void 0?{...a,brand:a.brand||"Unknown",pricePerPiece:a.pricePerPiece??0,supplierId:a.supplierId||"SUP-001",maintainStockAt:a.maintainStockAt??a.reorderLevel*2,minimumStock:a.minimumStock??a.reorderLevel}:a):[],[S]),M=o.useMemo(()=>W.filter(a=>{if(b!=="all"&&a.category!==b)return!1;if(!U)return!0;const t=U.toLowerCase();return a.name.toLowerCase().includes(t)||a.id.toLowerCase().includes(t)}),[W,U,b]),{currentPage:ue,totalPages:me,paginatedData:X,goToPage:pe,totalItems:he,itemsPerPage:xe}=Qe(M,25),je=o.useMemo(()=>{const a=new Map;return N?.forEach(t=>a.set(t.id,t.name)),a},[N]),{selectedIds:D,toggleItem:ve,toggleAll:ge,deselectAll:q,isSelected:ye,isAllSelected:be,isPartiallySelected:Se,selectionCount:$,hasSelection:ke,selectedItems:Y}=Je(X),[Ne,V]=o.useState(!1),[Z,ee]=o.useState(!1),[m,O]=o.useState(null),[ae,re]=o.useState(!1);function R(){n({id:"",name:"",category:"Electronics",quantity:0,location:"",reorderLevel:0,brand:"",pricePerPiece:0,supplierId:"",maintainStockAt:0,minimumStock:0}),E({})}function v(a){E(t=>{const c={...t};return delete c[a],c})}function te(){try{const a=He.safeParse({name:r.name,category:r.category,quantity:r.quantity,location:r.location,reorderLevel:r.reorderLevel,brand:r.brand,pricePerPiece:r.pricePerPiece,supplierId:r.supplierId,maintainStockAt:r.maintainStockAt,minimumStock:r.minimumStock});if(!a.success){const t={};return a.error&&a.error.errors&&a.error.errors.forEach(c=>{const s=c.path.join(".");t[s]=c.message}),E(t),Object.values(t)[0]||"Validation failed"}return E({}),null}catch(a){return console.error("Validation error:",a),"Validation error occurred"}}async function Ce(){const a=te();if(a){u.error(a);return}try{const t=await Ve({name:r.name,category:r.category,quantity:r.quantity,location:r.location,reorderLevel:r.reorderLevel,brand:r.brand,pricePerPiece:r.pricePerPiece,supplierId:r.supplierId,maintainStockAt:r.maintainStockAt,minimumStock:r.minimumStock});y([t,...S??[]]),k(!1),u.success("Item added successfully"),R()}catch(t){u.error(t?.message||"Failed to add item")}}async function fe(){const a=te();if(a){u.error(a);return}if(!r.id){u.error("Missing item id");return}try{const t=await Oe({id:r.id,name:r.name,category:r.category,quantity:r.quantity,location:r.location,reorderLevel:r.reorderLevel,brand:r.brand,pricePerPiece:r.pricePerPiece,supplierId:r.supplierId,maintainStockAt:r.maintainStockAt,minimumStock:r.minimumStock});y((S??[]).map(c=>c.id===t.id?t:c)),P(null),u.success("Item updated")}catch(t){u.error(t?.message||"Failed to update item")}}async function Pe(a){try{await Re(a),y((S??[]).filter(t=>t.id!==a)),P(null),u.success("Item deleted")}catch(t){u.error(t?.message||"Failed to delete item")}}const Ie=a=>{switch(a){case"In Stock":return"bg-green-500/10 text-green-700";case"Low Stock":return"bg-orange-500/10 text-orange-700";case"Critical":return"bg-red-500/10 text-red-700";default:return"bg-gray-500/10 text-gray-700"}},Le=o.useCallback(async()=>{ee(!0);try{const a=Array.from(D),t=await qe(a);y(c=>c?.filter(s=>!a.includes(s.id))??[]),t.failedCount>0?u.warning(`Deleted ${t.successCount} items. ${t.failedCount} failed.`):u.success(`Successfully deleted ${t.successCount} item${t.successCount!==1?"s":""}`),q()}catch(a){u.error(a?.message||"Failed to delete items")}finally{ee(!1),V(!1)}},[D,y,q]),Ae=o.useCallback(async a=>{if(m){re(!0);try{const t=Array.from(D);let c={};switch(m){case"price":c={pricePerPiece:parseFloat(a)};break;case"location":c={location:a};break;case"reorderLevel":c={reorderLevel:parseInt(a,10)};break;case"supplier":c={supplierId:a};break}const s=await Ee(t,c);y(H=>H&&H.map(z=>t.includes(z.id)?{...z,...c}:z)),s.failedCount>0?u.warning(`Updated ${s.successCount} items. ${s.failedCount} failed.`):u.success(`Successfully updated ${s.successCount} item${s.successCount!==1?"s":""}`),q()}catch(t){u.error(t?.message||"Failed to update items")}finally{re(!1),O(null)}}},[m,D,y,q]),se=()=>{switch(m){case"price":return{type:"number",label:"New Price (₱)",placeholder:"Enter new price",min:0,step:.01,validate:a=>parseFloat(a)<0?"Price must be positive":null};case"location":return{type:"text",label:"New Location",placeholder:"e.g., A-12",validate:a=>a.trim().length===0?"Location is required":null};case"reorderLevel":return{type:"number",label:"New Reorder Level",placeholder:"Enter reorder level",min:0,step:1,validate:a=>parseInt(a,10)<0?"Reorder level must be positive":null};case"supplier":return{type:"select",label:"New Supplier",placeholder:"Select supplier",options:N?.filter(a=>a.status==="Active").map(a=>({value:a.id,label:a.name}))||[]};default:return null}},le=o.useMemo(()=>Y.map(a=>a.name),[Y]);return e.jsx("div",{className:"space-y-6",children:e.jsxs(De,{children:[e.jsx(Be,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(Te,{children:"Inventory Management"}),e.jsx("div",{className:"flex gap-2",children:e.jsxs(_,{open:C,onOpenChange:a=>{k(a),a||R()},children:[e.jsx(ie,{asChild:!0,children:e.jsxs(f,{onClick:()=>{R()},children:[e.jsx(Ke,{className:"h-4 w-4 mr-2"}),"Add Item"]})}),e.jsxs(G,{children:[e.jsxs(Q,{children:[e.jsx(J,{children:"Add New Inventory Item"}),e.jsx(K,{children:"Enter the details for the new inventory item."})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"item-name",children:"Item Name"}),e.jsx(d,{id:"item-name",placeholder:"Enter item name",value:r.name,onChange:a=>{n({...r,name:a.target.value}),v("name")},className:l.name?"border-red-500":""}),l.name&&e.jsx("p",{className:"text-sm text-red-500",children:l.name})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"category",children:"Category"}),e.jsxs(I,{value:r.category,onValueChange:a=>{n({...r,category:a}),v("category")},children:[e.jsx(L,{id:"category",className:l.category?"border-red-500":"",children:e.jsx(A,{placeholder:"Select category"})}),e.jsx(F,{children:de.map(a=>e.jsx(g,{value:a,children:a},a))})]}),l.category&&e.jsx("p",{className:"text-sm text-red-500",children:l.category})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"quantity",children:"Quantity"}),e.jsx(d,{id:"quantity",type:"number",placeholder:"0",value:r.quantity,onChange:a=>{const t=Number(a.target.value);n({...r,quantity:t}),v("quantity")},className:l.quantity?"border-red-500":""}),l.quantity&&e.jsx("p",{className:"text-sm text-red-500",children:l.quantity})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"location",children:"Location"}),e.jsx(d,{id:"location",placeholder:"e.g., A-12",value:r.location,onChange:a=>{n({...r,location:a.target.value}),v("location")},className:l.location?"border-red-500":""}),l.location&&e.jsx("p",{className:"text-sm text-red-500",children:l.location})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"reorder",children:"Reorder Level"}),e.jsx(d,{id:"reorder",type:"number",placeholder:"0",value:r.reorderLevel,onChange:a=>{const t=Number(a.target.value);n({...r,reorderLevel:t}),v("reorderLevel")},className:l.reorderLevel?"border-red-500":""}),l.reorderLevel&&e.jsx("p",{className:"text-sm text-red-500",children:l.reorderLevel})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"brand",children:"Brand"}),e.jsx(d,{id:"brand",placeholder:"Enter brand name",value:r.brand,onChange:a=>{n({...r,brand:a.target.value}),v("brand")},className:l.brand?"border-red-500":""}),l.brand&&e.jsx("p",{className:"text-sm text-red-500",children:l.brand})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"price",children:"Price Per Piece (PHP ₱)"}),e.jsx(d,{id:"price",type:"number",step:"0.01",placeholder:"0.00",value:r.pricePerPiece,onChange:a=>{const t=Number(a.target.value);n({...r,pricePerPiece:t}),v("pricePerPiece")},className:l.pricePerPiece?"border-red-500":""}),l.pricePerPiece&&e.jsx("p",{className:"text-sm text-red-500",children:l.pricePerPiece})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"supplier",children:"Supplier"}),e.jsxs(I,{value:r.supplierId,onValueChange:a=>{n({...r,supplierId:a}),v("supplierId")},children:[e.jsx(L,{id:"supplier",className:l.supplierId?"border-red-500":"",children:e.jsx(A,{placeholder:"Select supplier"})}),e.jsx(F,{children:N?.filter(a=>a.status==="Active").map(a=>e.jsx(g,{value:a.id,children:a.name},a.id))})]}),l.supplierId&&e.jsx("p",{className:"text-sm text-red-500",children:l.supplierId})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"minimumStock",children:"Minimum Stock"}),e.jsx(d,{id:"minimumStock",type:"number",placeholder:"0",value:r.minimumStock,onChange:a=>{const t=Number(a.target.value);n({...r,minimumStock:t}),v("minimumStock")},className:l.minimumStock?"border-red-500":""}),l.minimumStock&&e.jsx("p",{className:"text-sm text-red-500",children:l.minimumStock})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"maintainStock",children:"Maintain Stock At"}),e.jsx(d,{id:"maintainStock",type:"number",placeholder:"0",value:r.maintainStockAt,onChange:a=>{const t=Number(a.target.value);n({...r,maintainStockAt:t}),v("maintainStockAt")},className:l.maintainStockAt?"border-red-500":""}),l.maintainStockAt&&e.jsx("p",{className:"text-sm text-red-500",children:l.maintainStockAt})]}),e.jsx(f,{className:"w-full",onClick:Ce,children:"Add Item"})]})]})]})})]})}),e.jsxs(Ue,{children:[e.jsxs("div",{className:"flex gap-4 mb-6",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(We,{className:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground"}),e.jsx(d,{placeholder:"Search items...",value:j,onChange:a=>p(a.target.value),className:"pl-9"})]}),e.jsxs(I,{value:b,onValueChange:w,children:[e.jsxs(L,{className:"w-[180px]",children:[e.jsx(ia,{className:"h-4 w-4 mr-2"}),e.jsx(A,{placeholder:"Category"})]}),e.jsxs(F,{children:[e.jsx(g,{value:"all",children:"All Categories"}),e.jsx(g,{value:"Electronics",children:"Electronics"}),e.jsx(g,{value:"Furniture",children:"Furniture"}),e.jsx(g,{value:"Clothing",children:"Clothing"}),e.jsx(g,{value:"Food",children:"Food"})]})]})]}),ke&&e.jsx(Xe,{selectionCount:$,onClearSelection:q,isLoading:Z||ae,actions:[{id:"delete",label:"Delete",icon:e.jsx(Ye,{className:"h-4 w-4 mr-1"}),variant:"destructive",onClick:()=>V(!0)}],actionGroups:[{id:"bulk-update",label:"Bulk Update",icon:e.jsx(da,{className:"h-4 w-4 mr-1"}),options:[{value:"price",label:"Update Price"},{value:"location",label:"Update Location"},{value:"reorderLevel",label:"Update Reorder Level"},{value:"supplier",label:"Update Supplier"}],onSelect:a=>O(a)}],className:"mb-4"}),e.jsx(Ze,{open:Ne,onOpenChange:V,itemCount:$,itemType:"item",itemNames:le,onConfirm:Le,isLoading:Z}),m&&se()&&e.jsx(oa,{open:!!m,onOpenChange:a=>!a&&O(null),title:`Update ${m==="price"?"Price":m==="location"?"Location":m==="reorderLevel"?"Reorder Level":"Supplier"}`,description:`Set new ${m==="price"?"price":m==="location"?"location":m==="reorderLevel"?"reorder level":"supplier"} for selected items`,itemCount:$,itemNames:le,field:se(),onConfirm:Ae,isLoading:ae}),B?e.jsx(ea,{rows:8}):M.length===0?e.jsx(aa,{icon:Me,title:"No inventory items found",description:j||b!=="all"?"Try adjusting your search or filter criteria":"Get started by adding your first inventory item",actionLabel:!j&&b==="all"?"Add Item":void 0,onAction:!j&&b==="all"?()=>k(!0):void 0}):e.jsxs("div",{className:"rounded-md border",children:[e.jsxs(ra,{children:[e.jsx(ta,{children:e.jsxs(ce,{children:[e.jsx(h,{className:"w-12",children:e.jsx(ne,{checked:be,ref:a=>{a&&(a.indeterminate=Se)},onCheckedChange:ge,"aria-label":"Select all items"})}),e.jsx(h,{children:"Item ID"}),e.jsx(h,{children:"Name"}),e.jsx(h,{children:"Brand"}),e.jsx(h,{children:"Category"}),e.jsx(h,{children:"Quantity"}),e.jsx(h,{children:"Price"}),e.jsx(h,{children:"Supplier"}),e.jsx(h,{children:"Location"}),e.jsx(h,{children:"Status"}),e.jsx(h,{children:"Actions"})]})}),e.jsx(sa,{children:X.map(a=>{const t=je.get(a.supplierId)??(a.supplierId||"N/A"),c=ye(a.id);return e.jsxs(ce,{className:$e(c&&"bg-muted/50"),children:[e.jsx(x,{children:e.jsx(ne,{checked:c,onCheckedChange:()=>ve(a.id),"aria-label":`Select ${a.name}`})}),e.jsx(x,{children:a.id}),e.jsx(x,{children:a.name}),e.jsx(x,{children:a.brand||"Unknown"}),e.jsx(x,{children:a.category}),e.jsx(x,{children:a.quantity}),e.jsxs(x,{children:["₱",(a.pricePerPiece??0).toFixed(2)]}),e.jsx(x,{children:t}),e.jsx(x,{children:a.location}),e.jsx(x,{children:e.jsx(ze,{variant:"secondary",className:Ie(a.status),children:a.status})}),e.jsx(x,{children:e.jsxs(_,{open:T===a.id,onOpenChange:s=>{P(s?a.id:null),s&&n({id:a.id,name:a.name,category:a.category,quantity:a.quantity,location:a.location,reorderLevel:a.reorderLevel,brand:a.brand||"Unknown",pricePerPiece:a.pricePerPiece??0,supplierId:a.supplierId||"SUP-001",maintainStockAt:a.maintainStockAt??a.reorderLevel*2,minimumStock:a.minimumStock??a.reorderLevel})},children:[e.jsx(ie,{asChild:!0,children:e.jsx(f,{variant:"ghost",size:"sm",children:"Edit"})}),e.jsxs(G,{children:[e.jsxs(Q,{children:[e.jsx(J,{children:"Edit Inventory Item"}),e.jsx(K,{children:"Update fields and save your changes."})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"edit-name",children:"Item Name"}),e.jsx(d,{id:"edit-name",placeholder:"Enter item name",value:r.name,onChange:s=>n({...r,name:s.target.value})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"edit-category",children:"Category"}),e.jsxs(I,{value:r.category,onValueChange:s=>n({...r,category:s}),children:[e.jsx(L,{id:"edit-category",children:e.jsx(A,{placeholder:"Select category"})}),e.jsx(F,{children:de.map(s=>e.jsx(g,{value:s,children:s},s))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"edit-quantity",children:"Quantity"}),e.jsx(d,{id:"edit-quantity",type:"number",placeholder:"0",value:r.quantity,onChange:s=>n({...r,quantity:Number(s.target.value)})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"edit-location",children:"Location"}),e.jsx(d,{id:"edit-location",placeholder:"e.g., A-12",value:r.location,onChange:s=>n({...r,location:s.target.value})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"edit-reorder",children:"Reorder Level"}),e.jsx(d,{id:"edit-reorder",type:"number",placeholder:"0",value:r.reorderLevel,onChange:s=>n({...r,reorderLevel:Number(s.target.value)})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"edit-brand",children:"Brand"}),e.jsx(d,{id:"edit-brand",placeholder:"Enter brand name",value:r.brand,onChange:s=>n({...r,brand:s.target.value})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"edit-price",children:"Price Per Piece (PHP ₱)"}),e.jsx(d,{id:"edit-price",type:"number",step:"0.01",placeholder:"0.00",value:r.pricePerPiece,onChange:s=>n({...r,pricePerPiece:Number(s.target.value)})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"edit-supplier",children:"Supplier"}),e.jsxs(I,{value:r.supplierId,onValueChange:s=>n({...r,supplierId:s}),children:[e.jsx(L,{id:"edit-supplier",children:e.jsx(A,{placeholder:"Select supplier"})}),e.jsx(F,{children:N?.filter(s=>s.status==="Active").map(s=>e.jsx(g,{value:s.id,children:s.name},s.id))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"edit-minimumStock",children:"Minimum Stock"}),e.jsx(d,{id:"edit-minimumStock",type:"number",placeholder:"0",value:r.minimumStock,onChange:s=>n({...r,minimumStock:Number(s.target.value)})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{htmlFor:"edit-maintainStock",children:"Maintain Stock At"}),e.jsx(d,{id:"edit-maintainStock",type:"number",placeholder:"0",value:r.maintainStockAt,onChange:s=>n({...r,maintainStockAt:Number(s.target.value)})})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(f,{className:"flex-1",onClick:fe,children:"Save Changes"}),e.jsx(f,{variant:"destructive",onClick:()=>Pe(a.id),children:"Delete"})]})]})]})]})})]},a.id)})})]}),M.length>0&&e.jsx(la,{currentPage:ue,totalPages:me,onPageChange:pe,itemsPerPage:xe,totalItems:he})]})]})]})})}export{ha as InventoryView};
