import{c1 as I,r,j as e,B as l,S as j,C as m,q as u,a1 as q,I as T,P as z,w as B,az as F,aD as O,x as D}from"./index-BcBovn2s.js";import{I as E}from"./image-C-S0xuIv.js";import{T as H}from"./tag-CjrBASFv.js";import{M}from"./minus-6zrPV5J6.js";import{P as A}from"./plus-BTIOd5Kk.js";function p(c){return new Intl.NumberFormat("en-PH",{style:"currency",currency:"PHP"}).format(c)}const $={Books:"Books & Literature",Clothing:"Fashion & Apparel",Electronics:"Electronics & Gadgets",Food:"Food & Beverages",Furniture:"Home & Furniture",Health:"Health & Wellness",Sports:"Sports & Outdoors",Toys:"Toys & Games",Other:"Other Products"};function W({navigateToView:c}){const{addToCart:N,getCartItem:y,updateQuantity:x,itemCount:h,cartTotal:v}=I(),[f,w]=r.useState([]),[C,b]=r.useState(!0),[n,S]=r.useState(""),[i,g]=r.useState("all");r.useEffect(()=>{async function s(){try{const t=await O();w(t)}catch{D.error("Failed to load products")}finally{b(!1)}}s()},[]);const o=r.useMemo(()=>f.filter(s=>!s.archived),[f]),k=r.useMemo(()=>[...new Set(o.map(t=>t.category))].map(t=>({id:t,name:$[t]||t})).sort((t,a)=>t.name.localeCompare(a.name)),[o]),d=r.useMemo(()=>o.filter(s=>{const t=!n||s.name.toLowerCase().includes(n.toLowerCase())||s.brand.toLowerCase().includes(n.toLowerCase())||s.description?.toLowerCase().includes(n.toLowerCase()),a=i==="all"||s.category===i;return t&&a}),[o,n,i]),P=s=>s.quantity<=0?"Out of Stock":s.quantity<=(s.reorderLevel??10)?"Low Stock":"In Stock";return C?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"text-muted-foreground",children:"Loading products..."})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Products"}),e.jsxs("p",{className:"text-muted-foreground",children:["Browse our complete catalog of ",o.length," products"]})]}),h>0&&e.jsxs(l,{onClick:()=>c("customer-cart"),children:[e.jsx(j,{className:"h-4 w-4 mr-2"}),"View Cart (",h,") - ",p(v)]})]}),e.jsx(m,{children:e.jsx(u,{className:"py-4",children:e.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(q,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(T,{placeholder:"Search products, brands...",value:n,onChange:s=>S(s.target.value),className:"pl-9"})]}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsx(l,{variant:i==="all"?"default":"outline",size:"sm",onClick:()=>g("all"),children:"All"}),k.map(s=>e.jsx(l,{variant:i===s.id?"default":"outline",size:"sm",onClick:()=>g(s.id),children:s.name},s.id))]})]})})}),e.jsxs("div",{className:"text-sm text-muted-foreground",children:["Showing ",d.length," of ",o.length," products"]}),d.length===0?e.jsx(m,{children:e.jsx(u,{className:"py-12",children:e.jsxs("div",{className:"flex flex-col items-center text-center",children:[e.jsx(z,{className:"h-12 w-12 text-muted-foreground/50 mb-4"}),e.jsx("p",{className:"font-medium",children:"No products found"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Try adjusting your search or filters"})]})})}):e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4",children:d.map(s=>{const t=P(s),a=y(s.id),L=!!a;return e.jsxs(m,{className:"group overflow-hidden hover:shadow-md transition-all",children:[e.jsxs("div",{className:"aspect-[4/3] bg-gradient-to-br from-muted/50 to-muted flex items-center justify-center relative overflow-hidden",children:[s.photoUrl?e.jsx("img",{src:s.photoUrl,alt:s.name,className:"w-full h-full object-cover group-hover:scale-105 transition-transform duration-300"}):e.jsxs("div",{className:"flex flex-col items-center text-muted-foreground/50",children:[e.jsx(E,{className:"h-10 w-10 mb-1"}),e.jsx("span",{className:"text-xs",children:"No image"})]}),e.jsx(B,{className:`absolute top-2 right-2 text-xs ${t==="In Stock"?"bg-green-500/90":t==="Low Stock"?"bg-amber-500/90":"bg-red-500/90"}`,children:t})]}),e.jsxs(u,{className:"p-4",children:[e.jsx("h4",{className:"font-semibold line-clamp-1",children:s.name}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsx(H,{className:"h-3 w-3 text-muted-foreground"}),e.jsx("span",{className:"text-xs text-muted-foreground",children:s.brand})]}),e.jsx("p",{className:"text-sm text-muted-foreground line-clamp-2 mt-2 min-h-[2.5rem]",children:s.description||`Quality ${s.brand} product.`}),e.jsx(F,{className:"my-3"}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:`text-lg font-bold ${t==="Out of Stock"?"text-muted-foreground":"text-primary"}`,children:p(s.pricePerPiece)}),t==="Out of Stock"?e.jsx(l,{size:"sm",variant:"outline",disabled:!0,className:"opacity-60",children:"Out of Stock"}):L?e.jsxs("div",{className:"flex items-center gap-1.5 bg-accent rounded-lg p-1",children:[e.jsx(l,{size:"icon",variant:"ghost",className:"h-7 w-7",onClick:()=>x(s.id,a.quantity-1),children:e.jsx(M,{className:"h-3 w-3"})}),e.jsx("span",{className:"w-6 text-center font-semibold text-sm",children:a.quantity}),e.jsx(l,{size:"icon",variant:"ghost",className:"h-7 w-7",onClick:()=>x(s.id,a.quantity+1),disabled:a.quantity>=s.quantity,children:e.jsx(A,{className:"h-3 w-3"})})]}):e.jsxs(l,{size:"sm",onClick:()=>N(s),className:"gap-1",children:[e.jsx(j,{className:"h-4 w-4"}),"Add"]})]})]})]},s.id)})})]})}export{W as ProductsCatalogView};
