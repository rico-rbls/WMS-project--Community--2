import{c as O,f as pe,r as t,E as ve,j as e,C,k as D,aA as B,l as A,p as F,q as o,aB as U,m as q,B as a,a3 as _,Z as V,U as ye,K as fe,I as Ne,D as X,s as $,t as G,v as Y,w as Z,L as J,x as Q,G as k}from"./index-D1rA1wPR.js";import{S as L,a as T,b as I,c as K,d as r,e as we,f as ke,g as E,i as u,h as Se,j as be,k as c,T as Ce}from"./sortable-table-head-BYWXvhVD.js";import{u as De}from"./useTableSort--k3IKrGy.js";/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ae=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["polyline",{points:"16 11 18 13 22 9",key:"1pwet4"}]],Ue=O("user-check",Ae);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Le=[["circle",{cx:"18",cy:"15",r:"3",key:"gjjjvw"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M10 15H6a4 4 0 0 0-4 4v2",key:"1nfge6"}],["path",{d:"m21.7 16.4-.9-.3",key:"12j9ji"}],["path",{d:"m15.2 13.9-.9-.3",key:"1fdjdi"}],["path",{d:"m16.6 18.7.3-.9",key:"heedtr"}],["path",{d:"m19.1 12.2.3-.9",key:"1af3ki"}],["path",{d:"m19.6 18.7-.4-1",key:"1x9vze"}],["path",{d:"m16.8 12.3-.4-1",key:"vqeiwj"}],["path",{d:"m14.3 16.6 1-.4",key:"1qlj63"}],["path",{d:"m20.7 13.8 1-.4",key:"1v5t8k"}]],W=O("user-cog",Le);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Te=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"17",x2:"22",y1:"8",y2:"13",key:"3nzzx3"}],["line",{x1:"22",x2:"17",y1:"8",y2:"13",key:"1swrse"}]],Ie=O("user-x",Te);function Re(){const{user:p,getAllUsers:P,getPendingUsers:Ke,approveUser:ee,rejectUser:se,updateUserRole:te,updateUserStatus:ae,deleteUser:le}=pe(),[x,re]=t.useState([]),[R,ne]=t.useState(""),[v,ce]=t.useState("all"),[l,y]=t.useState(null),[ie,f]=t.useState(!1),[de,N]=t.useState(!1),[n,S]=t.useState({role:"Operator",status:"Active"}),b=ve(R,300);t.useEffect(()=>{const s=()=>{const g=P();re(g.map(d=>({id:d.id,email:d.email,name:d.name,role:d.role,status:d.status,createdAt:d.createdAt,lastLogin:d.lastLogin})))};s();const i=setInterval(s,2e3);return()=>clearInterval(i)},[P]);const oe=t.useMemo(()=>{let s=x;if(b){const i=b.toLowerCase();s=s.filter(g=>g.name.toLowerCase().includes(i)||g.email.toLowerCase().includes(i)||g.id.toLowerCase().includes(i))}return v!=="all"&&(s=s.filter(i=>i.status===v)),s},[x,b,v]),{sortedData:z,sortConfig:h,requestSort:m,getSortDirection:j}=De(oe),w=t.useMemo(()=>x.filter(s=>s.status==="Pending").length,[x]),xe=s=>{y(s),S({role:s.role,status:s.status}),f(!0)},he=s=>{y(s),N(!0)},H=s=>{ee(s),k.success("User approved successfully")},M=s=>{se(s),k.success("User rejected and removed")},me=()=>{l&&(n.role!==l.role&&te(l.id,n.role),n.status!==l.status&&ae(l.id,n.status),k.success("User updated successfully"),f(!1),y(null))},je=()=>{l&&(le(l.id),k.success("User deleted successfully"),N(!1),y(null))},ue=s=>{switch(s){case"Active":return e.jsxs(o,{className:"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200",children:[e.jsx(Ue,{className:"h-3 w-3 mr-1"}),"Active"]});case"Pending":return e.jsxs(o,{className:"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200",children:[e.jsx(U,{className:"h-3 w-3 mr-1"}),"Pending"]});case"Inactive":return e.jsxs(o,{className:"bg-gray-100 text-gray-800 dark:bg-gray-800 dark:text-gray-200",children:[e.jsx(Ie,{className:"h-3 w-3 mr-1"}),"Inactive"]})}},ge=s=>{switch(s){case"Admin":return e.jsxs(o,{variant:"default",children:[e.jsx(B,{className:"h-3 w-3 mr-1"}),"Admin"]});case"Operator":return e.jsxs(o,{variant:"secondary",children:[e.jsx(W,{className:"h-3 w-3 mr-1"}),"Operator"]})}};return!p||p.role!=="Admin"?e.jsx("div",{className:"flex items-center justify-center h-full min-h-[400px]",children:e.jsx(C,{className:"max-w-md w-full mx-4",children:e.jsxs(D,{className:"text-center",children:[e.jsx("div",{className:"mx-auto mb-4 h-12 w-12 rounded-full bg-destructive/10 flex items-center justify-center",children:e.jsx(B,{className:"h-6 w-6 text-destructive"})}),e.jsx(A,{className:"text-destructive",children:"Access Denied"}),e.jsx(F,{children:"You do not have permission to access user management."})]})})}):e.jsxs("div",{className:"space-y-6 px-4 sm:px-0",children:[e.jsxs("div",{className:"flex flex-col gap-4 md:flex-row md:items-center md:justify-between",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold tracking-tight",children:"User Management"}),e.jsx("p",{className:"text-sm sm:text-base text-muted-foreground",children:"Manage user accounts, roles, and permissions"})]}),w>0&&e.jsxs(o,{variant:"destructive",className:"text-sm px-3 py-1.5 gap-1.5 self-start md:self-auto animate-pulse",children:[e.jsx(U,{className:"h-3.5 w-3.5"}),w," pending approval",w!==1?"s":""]})]}),w>0&&e.jsxs(C,{className:"border-yellow-200 bg-yellow-50 dark:border-yellow-800 dark:bg-yellow-950/30",children:[e.jsxs(D,{className:"pb-3",children:[e.jsxs(A,{className:"text-lg flex items-center gap-2",children:[e.jsx(U,{className:"h-5 w-5 text-yellow-600"}),"Pending Approvals"]}),e.jsx(F,{children:"New user registrations awaiting your approval"})]}),e.jsx(q,{children:e.jsx("div",{className:"space-y-3",children:x.filter(s=>s.status==="Pending").map(s=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-white dark:bg-gray-900 rounded-lg border",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:s.name}),e.jsx("p",{className:"text-sm text-muted-foreground",children:s.email}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["Registered: ",new Date(s.createdAt).toLocaleDateString()]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(a,{size:"sm",variant:"outline",className:"text-green-600 hover:bg-green-50",onClick:()=>H(s.id),children:[e.jsx(_,{className:"h-4 w-4 mr-1"})," Approve"]}),e.jsxs(a,{size:"sm",variant:"outline",className:"text-red-600 hover:bg-red-50",onClick:()=>M(s.id),children:[e.jsx(V,{className:"h-4 w-4 mr-1"})," Reject"]})]})]},s.id))})})]}),e.jsxs(C,{children:[e.jsx(D,{children:e.jsxs("div",{className:"flex flex-col gap-4 md:flex-row md:items-center md:justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ye,{className:"h-5 w-5"}),e.jsx(A,{children:"All Users"}),e.jsx(o,{variant:"secondary",children:x.length})]}),e.jsxs("div",{className:"flex flex-col gap-2 md:flex-row md:items-center",children:[e.jsxs("div",{className:"relative",children:[e.jsx(fe,{className:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground"}),e.jsx(Ne,{placeholder:"Search users...",value:R,onChange:s=>ne(s.target.value),className:"pl-9 w-full md:w-64"})]}),e.jsxs(L,{value:v,onValueChange:s=>ce(s),children:[e.jsx(T,{className:"w-full md:w-40",children:e.jsx(I,{placeholder:"Filter by status"})}),e.jsxs(K,{children:[e.jsx(r,{value:"all",children:"All Status"}),e.jsx(r,{value:"Active",children:"Active"}),e.jsx(r,{value:"Pending",children:"Pending"}),e.jsx(r,{value:"Inactive",children:"Inactive"})]})]})]})]})}),e.jsx(q,{children:e.jsx("div",{className:"rounded-md border",children:e.jsxs(we,{children:[e.jsx(ke,{children:e.jsxs(E,{children:[e.jsx(u,{sortKey:"name",currentSortKey:h.key,sortDirection:j("name"),onSort:s=>m(s),children:"Name"}),e.jsx(u,{sortKey:"email",currentSortKey:h.key,sortDirection:j("email"),onSort:s=>m(s),children:"Email"}),e.jsx(u,{sortKey:"role",currentSortKey:h.key,sortDirection:j("role"),onSort:s=>m(s),children:"Role"}),e.jsx(u,{sortKey:"status",currentSortKey:h.key,sortDirection:j("status"),onSort:s=>m(s),children:"Status"}),e.jsx(u,{sortKey:"createdAt",currentSortKey:h.key,sortDirection:j("createdAt"),onSort:s=>m(s),children:"Created"}),e.jsx(u,{sortKey:"lastLogin",currentSortKey:h.key,sortDirection:j("lastLogin"),onSort:s=>m(s),children:"Last Login"}),e.jsx(Se,{children:"Actions"})]})}),e.jsx(be,{children:z.length===0?e.jsx(E,{children:e.jsx(c,{colSpan:7,className:"text-center py-8 text-muted-foreground",children:"No users found"})}):z.map(s=>e.jsxs(E,{children:[e.jsx(c,{className:"font-medium",children:s.name}),e.jsx(c,{children:s.email}),e.jsx(c,{children:ge(s.role)}),e.jsx(c,{children:ue(s.status)}),e.jsx(c,{children:new Date(s.createdAt).toLocaleDateString()}),e.jsx(c,{children:s.lastLogin?new Date(s.lastLogin).toLocaleDateString():"Never"}),e.jsx(c,{children:e.jsxs("div",{className:"flex gap-1",children:[s.status==="Pending"&&e.jsxs(e.Fragment,{children:[e.jsx(a,{size:"sm",variant:"ghost",className:"text-green-600",onClick:()=>H(s.id),title:"Approve",children:e.jsx(_,{className:"h-4 w-4"})}),e.jsx(a,{size:"sm",variant:"ghost",className:"text-red-600",onClick:()=>M(s.id),title:"Reject",children:e.jsx(V,{className:"h-4 w-4"})})]}),e.jsx(a,{size:"sm",variant:"ghost",onClick:()=>xe(s),title:"Edit",disabled:s.id===p?.id,children:e.jsx(W,{className:"h-4 w-4"})}),e.jsx(a,{size:"sm",variant:"ghost",className:"text-red-600",onClick:()=>he(s),title:"Delete",disabled:s.id===p?.id,children:e.jsx(Ce,{className:"h-4 w-4"})})]})})]},s.id))})]})})})]}),e.jsx(X,{open:ie,onOpenChange:f,children:e.jsxs($,{children:[e.jsxs(G,{children:[e.jsx(Y,{children:"Edit User"}),e.jsxs(Z,{children:["Update role and status for ",l?.name]})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(J,{children:"Role"}),e.jsxs(L,{value:n.role,onValueChange:s=>S({...n,role:s}),children:[e.jsx(T,{children:e.jsx(I,{})}),e.jsxs(K,{children:[e.jsx(r,{value:"Admin",children:"Admin - Full access"}),e.jsx(r,{value:"Operator",children:"Operator - Read-only"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(J,{children:"Status"}),e.jsxs(L,{value:n.status,onValueChange:s=>S({...n,status:s}),children:[e.jsx(T,{children:e.jsx(I,{})}),e.jsxs(K,{children:[e.jsx(r,{value:"Active",children:"Active"}),e.jsx(r,{value:"Pending",children:"Pending"}),e.jsx(r,{value:"Inactive",children:"Inactive"})]})]})]})]}),e.jsxs(Q,{children:[e.jsx(a,{variant:"outline",onClick:()=>f(!1),children:"Cancel"}),e.jsx(a,{onClick:me,children:"Save Changes"})]})]})}),e.jsx(X,{open:de,onOpenChange:N,children:e.jsxs($,{children:[e.jsxs(G,{children:[e.jsx(Y,{children:"Delete User"}),e.jsxs(Z,{children:["Are you sure you want to delete ",l?.name,"? This action cannot be undone."]})]}),e.jsxs(Q,{children:[e.jsx(a,{variant:"outline",onClick:()=>N(!1),children:"Cancel"}),e.jsx(a,{variant:"destructive",onClick:je,children:"Delete User"})]})]})})]})}export{Re as UserManagementView};
