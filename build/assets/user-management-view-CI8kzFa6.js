import{c as E,f as ge,r as t,j as e,C as b,l as D,m as U,q as M,s as o,aH as q,n as F,B as a,W as B,X as _,U as pe,I as ve,L as V,t as w,aI as ye}from"./index-BbQSPos2.js";import{u as fe,k as Ne,S as A,e as L,f as T,g as I,h as l,l as ke,m as we,n as K,p as u,o as Se,q as Ce,r as c,T as be,D as X,a as $,b as W,c as Y,d as G,i as J}from"./sortable-table-head-Dcn1n-EY.js";import{u as De}from"./useTableSort-Bkej5r2f.js";/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ue=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["polyline",{points:"16 11 18 13 22 9",key:"1pwet4"}]],Ae=E("user-check",Ue);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Le=[["circle",{cx:"18",cy:"15",r:"3",key:"gjjjvw"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M10 15H6a4 4 0 0 0-4 4v2",key:"1nfge6"}],["path",{d:"m21.7 16.4-.9-.3",key:"12j9ji"}],["path",{d:"m15.2 13.9-.9-.3",key:"1fdjdi"}],["path",{d:"m16.6 18.7.3-.9",key:"heedtr"}],["path",{d:"m19.1 12.2.3-.9",key:"1af3ki"}],["path",{d:"m19.6 18.7-.4-1",key:"1x9vze"}],["path",{d:"m16.8 12.3-.4-1",key:"vqeiwj"}],["path",{d:"m14.3 16.6 1-.4",key:"1qlj63"}],["path",{d:"m20.7 13.8 1-.4",key:"1v5t8k"}]],Q=E("user-cog",Le);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Te=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"17",x2:"22",y1:"8",y2:"13",key:"3nzzx3"}],["line",{x1:"22",x2:"17",y1:"8",y2:"13",key:"1swrse"}]],Ie=E("user-x",Te);function Re(){const{user:p,getAllUsers:O,getPendingUsers:Ke,approveUser:Z,rejectUser:ee,updateUserRole:se,updateUserStatus:te,deleteUser:ae}=ge(),[x,re]=t.useState([]),[P,le]=t.useState(""),[v,ne]=t.useState("all"),[r,y]=t.useState(null),[ce,f]=t.useState(!1),[ie,N]=t.useState(!1),[n,S]=t.useState({role:"Operator",status:"Active"}),C=fe(P,300);t.useEffect(()=>{const s=()=>{const g=O();re(g.map(d=>({id:d.id,email:d.email,name:d.name,role:d.role,status:d.status,createdAt:d.createdAt,lastLogin:d.lastLogin})))};s();const i=setInterval(s,2e3);return()=>clearInterval(i)},[O]);const de=t.useMemo(()=>{let s=x;if(C){const i=C.toLowerCase();s=s.filter(g=>g.name.toLowerCase().includes(i)||g.email.toLowerCase().includes(i)||g.id.toLowerCase().includes(i))}return v!=="all"&&(s=s.filter(i=>i.status===v)),s},[x,C,v]),{sortedData:R,sortConfig:h,requestSort:m,getSortDirection:j}=De(de),k=t.useMemo(()=>x.filter(s=>s.status==="Pending").length,[x]),oe=s=>{y(s),S({role:s.role,status:s.status}),f(!0)},xe=s=>{y(s),N(!0)},z=s=>{Z(s),w.success("User approved successfully")},H=s=>{ee(s),w.success("User rejected and removed")},he=()=>{r&&(n.role!==r.role&&se(r.id,n.role),n.status!==r.status&&te(r.id,n.status),w.success("User updated successfully"),f(!1),y(null))},me=()=>{r&&(ae(r.id),w.success("User deleted successfully"),N(!1),y(null))},je=s=>{switch(s){case"Active":return e.jsxs(o,{className:"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200",children:[e.jsx(Ae,{className:"h-3 w-3 mr-1"}),"Active"]});case"Pending":return e.jsxs(o,{className:"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200",children:[e.jsx(q,{className:"h-3 w-3 mr-1"}),"Pending"]});case"Inactive":return e.jsxs(o,{className:"bg-gray-100 text-gray-800 dark:bg-gray-800 dark:text-gray-200",children:[e.jsx(Ie,{className:"h-3 w-3 mr-1"}),"Inactive"]})}},ue=s=>{switch(s){case"Admin":return e.jsxs(o,{variant:"default",children:[e.jsx(ye,{className:"h-3 w-3 mr-1"}),"Admin"]});case"Operator":return e.jsxs(o,{variant:"secondary",children:[e.jsx(Q,{className:"h-3 w-3 mr-1"}),"Operator"]})}};return!p||p.role!=="Admin"?e.jsx("div",{className:"flex items-center justify-center h-full",children:e.jsx(b,{className:"max-w-md",children:e.jsxs(D,{children:[e.jsx(U,{className:"text-red-600",children:"Access Denied"}),e.jsx(M,{children:"You do not have permission to access user management."})]})})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col gap-4 md:flex-row md:items-center md:justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"User Management"}),e.jsx("p",{className:"text-muted-foreground",children:"Manage user accounts, roles, and permissions"})]}),k>0&&e.jsxs(o,{variant:"destructive",className:"text-sm px-3 py-1",children:[k," pending approval",k!==1?"s":""]})]}),k>0&&e.jsxs(b,{className:"border-yellow-200 bg-yellow-50 dark:border-yellow-800 dark:bg-yellow-950/30",children:[e.jsxs(D,{className:"pb-3",children:[e.jsxs(U,{className:"text-lg flex items-center gap-2",children:[e.jsx(q,{className:"h-5 w-5 text-yellow-600"}),"Pending Approvals"]}),e.jsx(M,{children:"New user registrations awaiting your approval"})]}),e.jsx(F,{children:e.jsx("div",{className:"space-y-3",children:x.filter(s=>s.status==="Pending").map(s=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-white dark:bg-gray-900 rounded-lg border",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:s.name}),e.jsx("p",{className:"text-sm text-muted-foreground",children:s.email}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["Registered: ",new Date(s.createdAt).toLocaleDateString()]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(a,{size:"sm",variant:"outline",className:"text-green-600 hover:bg-green-50",onClick:()=>z(s.id),children:[e.jsx(B,{className:"h-4 w-4 mr-1"})," Approve"]}),e.jsxs(a,{size:"sm",variant:"outline",className:"text-red-600 hover:bg-red-50",onClick:()=>H(s.id),children:[e.jsx(_,{className:"h-4 w-4 mr-1"})," Reject"]})]})]},s.id))})})]}),e.jsxs(b,{children:[e.jsx(D,{children:e.jsxs("div",{className:"flex flex-col gap-4 md:flex-row md:items-center md:justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(pe,{className:"h-5 w-5"}),e.jsx(U,{children:"All Users"}),e.jsx(o,{variant:"secondary",children:x.length})]}),e.jsxs("div",{className:"flex flex-col gap-2 md:flex-row md:items-center",children:[e.jsxs("div",{className:"relative",children:[e.jsx(Ne,{className:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground"}),e.jsx(ve,{placeholder:"Search users...",value:P,onChange:s=>le(s.target.value),className:"pl-9 w-full md:w-64"})]}),e.jsxs(A,{value:v,onValueChange:s=>ne(s),children:[e.jsx(L,{className:"w-full md:w-40",children:e.jsx(T,{placeholder:"Filter by status"})}),e.jsxs(I,{children:[e.jsx(l,{value:"all",children:"All Status"}),e.jsx(l,{value:"Active",children:"Active"}),e.jsx(l,{value:"Pending",children:"Pending"}),e.jsx(l,{value:"Inactive",children:"Inactive"})]})]})]})]})}),e.jsx(F,{children:e.jsx("div",{className:"rounded-md border",children:e.jsxs(ke,{children:[e.jsx(we,{children:e.jsxs(K,{children:[e.jsx(u,{sortKey:"name",currentSortKey:h.key,sortDirection:j("name"),onSort:s=>m(s),children:"Name"}),e.jsx(u,{sortKey:"email",currentSortKey:h.key,sortDirection:j("email"),onSort:s=>m(s),children:"Email"}),e.jsx(u,{sortKey:"role",currentSortKey:h.key,sortDirection:j("role"),onSort:s=>m(s),children:"Role"}),e.jsx(u,{sortKey:"status",currentSortKey:h.key,sortDirection:j("status"),onSort:s=>m(s),children:"Status"}),e.jsx(u,{sortKey:"createdAt",currentSortKey:h.key,sortDirection:j("createdAt"),onSort:s=>m(s),children:"Created"}),e.jsx(u,{sortKey:"lastLogin",currentSortKey:h.key,sortDirection:j("lastLogin"),onSort:s=>m(s),children:"Last Login"}),e.jsx(Se,{children:"Actions"})]})}),e.jsx(Ce,{children:R.length===0?e.jsx(K,{children:e.jsx(c,{colSpan:7,className:"text-center py-8 text-muted-foreground",children:"No users found"})}):R.map(s=>e.jsxs(K,{children:[e.jsx(c,{className:"font-medium",children:s.name}),e.jsx(c,{children:s.email}),e.jsx(c,{children:ue(s.role)}),e.jsx(c,{children:je(s.status)}),e.jsx(c,{children:new Date(s.createdAt).toLocaleDateString()}),e.jsx(c,{children:s.lastLogin?new Date(s.lastLogin).toLocaleDateString():"Never"}),e.jsx(c,{children:e.jsxs("div",{className:"flex gap-1",children:[s.status==="Pending"&&e.jsxs(e.Fragment,{children:[e.jsx(a,{size:"sm",variant:"ghost",className:"text-green-600",onClick:()=>z(s.id),title:"Approve",children:e.jsx(B,{className:"h-4 w-4"})}),e.jsx(a,{size:"sm",variant:"ghost",className:"text-red-600",onClick:()=>H(s.id),title:"Reject",children:e.jsx(_,{className:"h-4 w-4"})})]}),e.jsx(a,{size:"sm",variant:"ghost",onClick:()=>oe(s),title:"Edit",disabled:s.id===p?.id,children:e.jsx(Q,{className:"h-4 w-4"})}),e.jsx(a,{size:"sm",variant:"ghost",className:"text-red-600",onClick:()=>xe(s),title:"Delete",disabled:s.id===p?.id,children:e.jsx(be,{className:"h-4 w-4"})})]})})]},s.id))})]})})})]}),e.jsx(X,{open:ce,onOpenChange:f,children:e.jsxs($,{children:[e.jsxs(W,{children:[e.jsx(Y,{children:"Edit User"}),e.jsxs(G,{children:["Update role and status for ",r?.name]})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(V,{children:"Role"}),e.jsxs(A,{value:n.role,onValueChange:s=>S({...n,role:s}),children:[e.jsx(L,{children:e.jsx(T,{})}),e.jsxs(I,{children:[e.jsx(l,{value:"Admin",children:"Admin - Full access"}),e.jsx(l,{value:"Operator",children:"Operator - Read-only"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(V,{children:"Status"}),e.jsxs(A,{value:n.status,onValueChange:s=>S({...n,status:s}),children:[e.jsx(L,{children:e.jsx(T,{})}),e.jsxs(I,{children:[e.jsx(l,{value:"Active",children:"Active"}),e.jsx(l,{value:"Pending",children:"Pending"}),e.jsx(l,{value:"Inactive",children:"Inactive"})]})]})]})]}),e.jsxs(J,{children:[e.jsx(a,{variant:"outline",onClick:()=>f(!1),children:"Cancel"}),e.jsx(a,{onClick:he,children:"Save Changes"})]})]})}),e.jsx(X,{open:ie,onOpenChange:N,children:e.jsxs($,{children:[e.jsxs(W,{children:[e.jsx(Y,{children:"Delete User"}),e.jsxs(G,{children:["Are you sure you want to delete ",r?.name,"? This action cannot be undone."]})]}),e.jsxs(J,{children:[e.jsx(a,{variant:"outline",onClick:()=>N(!1),children:"Cancel"}),e.jsx(a,{variant:"destructive",onClick:me,children:"Delete User"})]})]})})]})}export{Re as UserManagementView};
