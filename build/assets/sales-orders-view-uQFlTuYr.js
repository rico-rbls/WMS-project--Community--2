import{c as zt,r as d,aA as _t,aB as Ut,j as e,aC as Ht,aD as Kt,aE as as,aF as Xs,aG as Gt,aH as Qt,aI as us,aJ as Wt,d as J,i as Zs,C as I,o as T,p as R,v as Es,q as D,aK as G,w as K,aL as Ms,B as x,a2 as et,I as N,ab as Jt,P as ts,S as ve,x as g,aM as Yt,M as Xt,aN as Ye,aO as Zt,aP as ea,aQ as Vs,aR as sa,s as Pe,T as ta,aS as aa,aT as hs,_ as Xe,aU as zs,aV as ra,D as Me,y as Ve,z as ze,A as _e,E as Ue,L as w,F as Ze,$ as ia,a1 as na,aa as la,aW as ca,aX as js,aY as da,aZ as oa,a_ as _s,a$ as ma,b0 as xa,b1 as ua,b2 as ha,b3 as ja,b4 as pa}from"./index-gxFWpY0o.js";import{h as ps}from"./permissions-DeuZZz56.js";import{u as ga,a as va,T as Na,E as gs,P as Us,F as fa,B as ya,S as ba}from"./select-all-banner-Hc7FJDCu.js";import{T as Ie,e as ke,f as Q,g as v,i as Oe,j as u,S as xe,a as ue,b as he,c as je,d as W,h as oe}from"./sortable-table-head-mJ6RUZKO.js";import{u as wa,D as Ca}from"./printable-receipt-C4eT70ER.js";import{C as bs}from"./circle-check-Cokl5esX.js";import{S as Sa,A as Da}from"./sparkles-DPkGyDzt.js";import{I as Pa}from"./image-BP79ZPno.js";import{T as Ia}from"./tag-L-2Ss10W.js";import{M as Hs}from"./minus-BDaY7JRJ.js";import{P as ie}from"./plus-DAtFw269.js";import{T as ge}from"./trash-2-BcZf1mNC.js";import{A as ka}from"./arrow-left-5yFfygj4.js";import{D as vs,A as He,a as Ks}from"./dollar-sign-mZpFnZC8.js";import{P as Oa}from"./printer-DccCdaPZ.js";import{H as Aa}from"./hash-isCaZyIj.js";import{C as Ns}from"./calendar-f0_2rZVA.js";import{F as Gs}from"./file-text-5Ezyu1C3.js";import{M as fs}from"./map-pin-CEbuK3Kh.js";import{B as Qs}from"./banknote-CKYhOkub.js";import{C as ys}from"./credit-card-Q8oSIWM9.js";import{B as Ws}from"./building-2-CH9UlYr8.js";import{P as Ta}from"./phone-CHiqosuC.js";import{T as Js}from"./trending-up-C5FfjuJa.js";import{C as Ys}from"./circle-alert-yPqsZxDx.js";import"./skeleton-CNLMXCG4.js";/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ra=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]],Fa=zt("history",Ra);var rs="Tabs",[Ba]=Ht(rs,[Xs]),st=Xs(),[La,ws]=Ba(rs),tt=d.forwardRef((n,y)=>{const{__scopeTabs:L,value:m,onValueChange:F,defaultValue:f,orientation:A="horizontal",dir:E,activationMode:_="automatic",...C}=n,P=_t(E),[M,V]=Ut({prop:m,onChange:F,defaultProp:f??"",caller:rs});return e.jsx(La,{scope:L,baseId:Kt(),value:M,onValueChange:V,orientation:A,dir:P,activationMode:_,children:e.jsx(as.div,{dir:P,"data-orientation":A,...C,ref:y})})});tt.displayName=rs;var at="TabsList",rt=d.forwardRef((n,y)=>{const{__scopeTabs:L,loop:m=!0,...F}=n,f=ws(at,L),A=st(L);return e.jsx(Gt,{asChild:!0,...A,orientation:f.orientation,dir:f.dir,loop:m,children:e.jsx(as.div,{role:"tablist","aria-orientation":f.orientation,...F,ref:y})})});rt.displayName=at;var it="TabsTrigger",nt=d.forwardRef((n,y)=>{const{__scopeTabs:L,value:m,disabled:F=!1,...f}=n,A=ws(it,L),E=st(L),_=dt(A.baseId,m),C=ot(A.baseId,m),P=m===A.value;return e.jsx(Qt,{asChild:!0,...E,focusable:!F,active:P,children:e.jsx(as.button,{type:"button",role:"tab","aria-selected":P,"aria-controls":C,"data-state":P?"active":"inactive","data-disabled":F?"":void 0,disabled:F,id:_,...f,ref:y,onMouseDown:us(n.onMouseDown,M=>{!F&&M.button===0&&M.ctrlKey===!1?A.onValueChange(m):M.preventDefault()}),onKeyDown:us(n.onKeyDown,M=>{[" ","Enter"].includes(M.key)&&A.onValueChange(m)}),onFocus:us(n.onFocus,()=>{const M=A.activationMode!=="manual";!P&&!F&&M&&A.onValueChange(m)})})})});nt.displayName=it;var lt="TabsContent",ct=d.forwardRef((n,y)=>{const{__scopeTabs:L,value:m,forceMount:F,children:f,...A}=n,E=ws(lt,L),_=dt(E.baseId,m),C=ot(E.baseId,m),P=m===E.value,M=d.useRef(P);return d.useEffect(()=>{const V=requestAnimationFrame(()=>M.current=!1);return()=>cancelAnimationFrame(V)},[]),e.jsx(Wt,{present:F||P,children:({present:V})=>e.jsx(as.div,{"data-state":P?"active":"inactive","data-orientation":E.orientation,role:"tabpanel","aria-labelledby":_,hidden:!V,id:C,tabIndex:0,...A,ref:y,style:{...n.style,animationDuration:M.current?"0s":void 0},children:V&&f})})});ct.displayName=lt;function dt(n,y){return`${n}-trigger-${y}`}function ot(n,y){return`${n}-content-${y}`}var $a=tt,qa=rt,Ea=nt,Ma=ct;function Va({className:n,...y}){return e.jsx($a,{"data-slot":"tabs",className:J("flex flex-col gap-2",n),...y})}function za({className:n,...y}){return e.jsx(qa,{"data-slot":"tabs-list",className:J("bg-muted text-muted-foreground inline-flex h-9 w-fit items-center justify-center rounded-lg p-1",n),...y})}function es({className:n,...y}){return e.jsx(Ea,{"data-slot":"tabs-trigger",className:J("data-[state=active]:bg-background data-[state=active]:text-foreground focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:outline-ring inline-flex items-center justify-center gap-1.5 rounded-md px-2 py-1 text-sm font-medium whitespace-nowrap transition-[color,box-shadow] focus-visible:ring-[3px] focus-visible:outline-1 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:shadow-sm [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",n),...y})}function ss({className:n,...y}){return e.jsx(Ma,{"data-slot":"tabs-content",className:J("flex-1 outline-none",n),...y})}const pe=n=>`₱${n.toLocaleString("en-PH",{minimumFractionDigits:2})}`,_a={Books:"Books & Literature",Clothing:"Fashion & Apparel",Electronics:"Electronics & Gadgets",Food:"Food & Beverages",Furniture:"Home & Furniture",Health:"Health & Wellness",Sports:"Sports & Outdoors",Toys:"Toys & Games",Other:"Other Products"};function Ua(n){let y="In Stock";return n.quantity<=0?y="Out of Stock":n.quantity<=(n.reorderLevel??10)&&(y="Low Stock"),{id:n.id,name:n.name,description:n.description||`Quality ${n.brand} ${n.name} in the ${n.category} category.`,category:_a[n.category]||n.category,brand:n.brand,price:n.pricePerPiece,availability:y,imageUrl:n.photoUrl,maxQuantity:n.quantity}}function Ha({inventoryData:n,customersData:y,onSubmitOrder:L,onCancel:m}){const{user:F}=Zs(),[f,A]=d.useState([]),[E,_]=d.useState(""),[C,P]=d.useState("all"),[M,V]=d.useState(""),[Ke,Ge]=d.useState(0),[Ae,Te]=d.useState(!1),[X,is]=d.useState(null),Ne=d.useMemo(()=>F?.email?y.find(i=>i.email===F.email):null,[F?.email,y]),re=d.useMemo(()=>n.filter(i=>!i.archived).map(Ua),[n]),Qe=d.useMemo(()=>[...new Set(re.map(h=>h.category))].sort(),[re]),Z=d.useMemo(()=>re.filter(i=>{const h=!E||i.name.toLowerCase().includes(E.toLowerCase())||i.brand.toLowerCase().includes(E.toLowerCase())||i.description.toLowerCase().includes(E.toLowerCase()),k=C==="all"||i.category===C;return h&&k}),[re,E,C]),ne=d.useMemo(()=>f.reduce((i,h)=>i+h.totalPrice,0),[f]),fe=d.useMemo(()=>f.reduce((i,h)=>i+h.quantity,0),[f]),$=i=>{const h=f.findIndex(k=>k.inventoryItemId===i.id);if(h>=0){const k=[...f],U=Math.min(k[h].quantity+1,i.maxQuantity);k[h]={...k[h],quantity:U,totalPrice:U*k[h].unitPrice},A(k)}else A([...f,{inventoryItemId:i.id,itemName:i.name,quantity:1,unitPrice:i.price,totalPrice:i.price,availableStock:i.maxQuantity}]);g.success(`Added ${i.name} to cart`)},me=(i,h)=>{const k=[...f],U=k[i].quantity+h;U<=0?k.splice(i,1):U<=k[i].availableStock&&(k[i]={...k[i],quantity:U,totalPrice:U*k[i].unitPrice}),A(k)},Re=i=>{const h=[...f];h.splice(i,1),A(h)},ye=async()=>{if(f.length===0){g.error("Please add items to your cart");return}Te(!0);try{const i=await L({items:f.map(({availableStock:h,...k})=>k),notes:M,amountPaid:Ke,customerName:Ne?.name||F?.displayName||F?.email||"Customer",customerId:Ne?.id||"",customerCountry:Ne?.country||"",customerCity:Ne?.city||""});is(i),g.success("Order placed successfully!")}catch(i){g.error(i instanceof Error?i.message:"Failed to place order")}finally{Te(!1)}};return X?e.jsx("div",{className:"flex flex-col items-center justify-center py-12 px-4",children:e.jsx("div",{className:"w-full max-w-md",children:e.jsxs(I,{className:"border-green-200 bg-green-50/50",children:[e.jsxs(T,{className:"text-center pb-2",children:[e.jsx("div",{className:"mx-auto w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mb-4",children:e.jsx(bs,{className:"h-10 w-10 text-green-600"})}),e.jsx(R,{className:"text-2xl text-green-800",children:"Order Confirmed!"}),e.jsx(Es,{className:"text-green-700",children:"Thank you for your order"})]}),e.jsxs(D,{className:"space-y-4",children:[e.jsxs("div",{className:"bg-white rounded-lg p-4 space-y-3",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"Order ID"}),e.jsx("span",{className:"font-mono font-semibold",children:X.id})]}),e.jsx(G,{}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"Date"}),e.jsx("span",{children:new Date(X.soDate).toLocaleDateString()})]}),e.jsx(G,{}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"Items"}),e.jsxs("span",{children:[X.items.length," item(s)"]})]}),e.jsx(G,{}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"Total Amount"}),e.jsx("span",{className:"font-semibold text-lg",children:pe(X.totalAmount)})]}),X.amountPaid>0&&e.jsxs(e.Fragment,{children:[e.jsx(G,{}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-muted-foreground",children:"Amount Paid"}),e.jsx("span",{className:"text-green-600",children:pe(X.amountPaid)})]})]}),e.jsx(G,{}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-muted-foreground",children:"Status"}),e.jsx(K,{variant:"secondary",className:"bg-yellow-100 text-yellow-800",children:"Pending"})]})]}),e.jsxs("div",{className:"bg-white rounded-lg p-4",children:[e.jsx("h4",{className:"font-medium mb-2",children:"Order Items"}),e.jsx("div",{className:"space-y-2",children:X.items.map((i,h)=>e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsxs("span",{children:[i.itemName," × ",i.quantity]}),e.jsx("span",{children:pe(i.totalPrice)})]},h))})]})]}),e.jsx(Ms,{children:e.jsx(x,{className:"w-full",onClick:m,children:"Continue Shopping"})})]})})}):e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsx("div",{className:"lg:col-span-2 space-y-4",children:e.jsxs(I,{children:[e.jsx(T,{className:"pb-3",children:e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs(R,{className:"flex items-center gap-2",children:[e.jsx(Sa,{className:"h-5 w-5 text-primary"}),"Shop Products"]}),e.jsxs(Es,{children:[Z.length," product",Z.length!==1?"s":""," available"]})]}),e.jsxs("div",{className:"relative w-64",children:[e.jsx(et,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(N,{placeholder:"Search products, brands...",value:E,onChange:i=>_(i.target.value),className:"pl-9"})]})]}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsx(x,{variant:C==="all"?"default":"outline",size:"sm",className:"text-xs h-7",onClick:()=>P("all"),children:"All Products"}),Qe.map(i=>e.jsx(x,{variant:C===i?"default":"outline",size:"sm",className:"text-xs h-7",onClick:()=>P(i),children:i},i))]})]})}),e.jsx(D,{children:e.jsx(Jt,{className:"h-[450px]",children:Z.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center py-12 text-muted-foreground",children:[e.jsx(ts,{className:"h-12 w-12 mb-4 opacity-50"}),e.jsx("p",{className:"font-medium",children:"No products found"}),e.jsx("p",{className:"text-sm",children:"Try adjusting your search or category filter"})]}):e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:Z.map(i=>{const h=f.find(k=>k.inventoryItemId===i.id);return e.jsxs("div",{className:"group border rounded-xl overflow-hidden hover:border-primary/50 hover:shadow-md transition-all",children:[e.jsxs("div",{className:"aspect-[4/3] bg-gradient-to-br from-muted/50 to-muted flex items-center justify-center relative overflow-hidden",children:[i.imageUrl?e.jsx("img",{src:i.imageUrl,alt:i.name,className:"w-full h-full object-cover group-hover:scale-105 transition-transform duration-300"}):e.jsxs("div",{className:"flex flex-col items-center text-muted-foreground/50",children:[e.jsx(Pa,{className:"h-12 w-12 mb-1"}),e.jsx("span",{className:"text-xs",children:"No image"})]}),e.jsx(K,{variant:i.availability==="Out of Stock"?"destructive":i.availability==="Low Stock"?"secondary":"default",className:`absolute top-2 right-2 text-xs ${i.availability==="In Stock"?"bg-green-500/90":i.availability==="Low Stock"?"bg-amber-500/90 text-white":i.availability==="Out of Stock"?"bg-red-500/90":""}`,children:i.availability})]}),e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"mb-2",children:[e.jsx("div",{className:"flex items-start justify-between gap-2",children:e.jsx("h4",{className:"font-semibold line-clamp-1",children:i.name})}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsx(Ia,{className:"h-3 w-3 text-muted-foreground"}),e.jsx("span",{className:"text-xs text-muted-foreground",children:i.brand})]})]}),e.jsx("p",{className:"text-sm text-muted-foreground line-clamp-2 mb-3 min-h-[2.5rem]",children:i.description}),e.jsx(G,{className:"my-3"}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:`text-xl font-bold ${i.availability==="Out of Stock"?"text-muted-foreground":"text-primary"}`,children:pe(i.price)}),i.availability==="Out of Stock"?e.jsx(x,{size:"sm",variant:"outline",disabled:!0,className:"gap-1 opacity-60",children:"Out of Stock"}):h?e.jsxs("div",{className:"flex items-center gap-1.5 bg-accent rounded-lg p-1",children:[e.jsx(x,{size:"icon",variant:"ghost",className:"h-7 w-7",onClick:()=>me(f.indexOf(h),-1),children:e.jsx(Hs,{className:"h-3 w-3"})}),e.jsx("span",{className:"w-6 text-center font-semibold text-sm",children:h.quantity}),e.jsx(x,{size:"icon",variant:"ghost",className:"h-7 w-7",onClick:()=>me(f.indexOf(h),1),disabled:h.quantity>=i.maxQuantity,children:e.jsx(ie,{className:"h-3 w-3"})})]}):e.jsxs(x,{size:"sm",onClick:()=>$(i),className:"gap-1",children:[e.jsx(ve,{className:"h-4 w-4"}),"Add to Cart"]})]})]})]},i.id)})})})})]})}),e.jsx("div",{className:"space-y-4",children:e.jsxs(I,{className:"sticky top-4",children:[e.jsx(T,{className:"pb-3",children:e.jsxs(R,{className:"flex items-center gap-2",children:[e.jsx(ve,{className:"h-5 w-5"}),"Your Cart",fe>0&&e.jsxs(K,{variant:"secondary",className:"ml-auto",children:[fe," item",fe!==1?"s":""]})]})}),e.jsx(D,{children:f.length===0?e.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[e.jsx(ve,{className:"h-12 w-12 mx-auto mb-3 opacity-30"}),e.jsx("p",{children:"Your cart is empty"}),e.jsx("p",{className:"text-sm",children:"Add products to get started"})]}):e.jsx("div",{className:"space-y-3",children:f.map((i,h)=>e.jsxs("div",{className:"flex items-center gap-3 p-2 rounded-lg bg-accent/30",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"font-medium truncate",children:i.itemName}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[pe(i.unitPrice)," each"]})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(x,{size:"icon",variant:"ghost",className:"h-7 w-7",onClick:()=>me(h,-1),children:e.jsx(Hs,{className:"h-3 w-3"})}),e.jsx("span",{className:"w-6 text-center text-sm",children:i.quantity}),e.jsx(x,{size:"icon",variant:"ghost",className:"h-7 w-7",onClick:()=>me(h,1),disabled:i.quantity>=i.availableStock,children:e.jsx(ie,{className:"h-3 w-3"})})]}),e.jsx("div",{className:"text-right w-20",children:e.jsx("p",{className:"font-medium",children:pe(i.totalPrice)})}),e.jsx(x,{size:"icon",variant:"ghost",className:"h-7 w-7 text-destructive hover:text-destructive",onClick:()=>Re(h),children:e.jsx(ge,{className:"h-3 w-3"})})]},i.inventoryItemId))})}),f.length>0&&e.jsxs(e.Fragment,{children:[e.jsx(G,{}),e.jsxs(D,{className:"pt-4 space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Special Instructions (optional)"}),e.jsx(N,{placeholder:"Any special requests...",value:M,onChange:i=>V(i.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Amount to Pay Now (optional)"}),e.jsx(N,{type:"number",min:"0",step:"0.01",placeholder:"0.00",value:Ke||"",onChange:i=>Ge(parseFloat(i.target.value)||0)})]}),e.jsx(G,{}),e.jsxs("div",{className:"flex justify-between items-center text-lg font-semibold",children:[e.jsx("span",{children:"Total"}),e.jsx("span",{className:"text-primary",children:pe(ne)})]})]}),e.jsxs(Ms,{className:"flex flex-col gap-2",children:[e.jsx(x,{className:"w-full",size:"lg",onClick:ye,disabled:Ae,children:Ae?"Placing Order...":e.jsxs(e.Fragment,{children:["Place Order",e.jsx(Da,{className:"ml-2 h-4 w-4"})]})}),e.jsx(x,{variant:"ghost",className:"w-full",onClick:m,children:"Cancel"})]})]})]})})]})}const Ka=["Unpaid","Partially Paid","Paid","Overdue"],Ga=["Pending","Processing","Shipped","In Transit","Out for Delivery","Delivered","Failed","Returned"],S=n=>new Intl.NumberFormat("en-PH",{style:"currency",currency:"PHP"}).format(n);function fr(){const{user:n}=Zs(),{createNotification:y}=Yt(),L=n?.role||"Viewer",m=L==="Customer",F=m||ps(L,"purchase_orders:create");!m&&ps(L,"purchase_orders:update");const f=!m&&ps(L,"purchase_orders:delete"),A=L==="Owner"||L==="Admin",{printReceipt:E}=wa(),[_,C]=d.useState(null),[P,M]=d.useState([]),[V,Ke]=d.useState([]),[Ge,Ae]=d.useState([]),[Te,X]=d.useState([]),[is,Ne]=d.useState(!0),[re,Qe]=d.useState(""),Z=Xt(re,300),[ne,fe]=d.useState("all"),[$,me]=d.useState(!1),[Re,ye]=d.useState(!1),[i,h]=d.useState(null),[k,U]=d.useState(!1),[H,Cs]=d.useState(null),[Fe,ns]=d.useState("asc"),[r,Be]=d.useState(null),[mt,ls]=d.useState(!1),[xt,be]=d.useState(!1),[cs,we]=d.useState(!1),[Y,Le]=d.useState({paymentMode:"Cash",amountReceived:0,notes:""}),[ee,$e]=d.useState({carrier:"",eta:"",destination:""});d.useEffect(()=>{if(cs&&r){const s=r.deliveryAddress||`${r.customerCity}, ${r.customerCountry}`;$e(t=>({...t,destination:s}))}},[cs,r]);const[l,B]=d.useState({soDate:new Date().toISOString().split("T")[0],customerId:"",customerName:"",customerCountry:"",customerCity:"",invoiceNumber:"",items:[],expectedDeliveryDate:"",notes:"",totalReceived:0,amountPaid:0,shippingStatus:"Pending"}),ds=d.useCallback(async()=>{try{const[s,t,a,o,p]=await Promise.allSettled([Ye(),Zt(),ea(),Vs(),sa()]);s.status==="fulfilled"?C(s.value):(console.error("Failed to load sales orders:",s.reason),C([])),t.status==="fulfilled"?M(t.value):console.error("Failed to load customers:",t.reason),a.status==="fulfilled"?Ke(a.value):console.error("Failed to load inventory:",a.reason),o.status==="fulfilled"?Ae(o.value):console.error("Failed to load shipments:",o.reason),p.status==="fulfilled"?X(p.value):console.error("Failed to load payments:",p.reason),s.status==="rejected"&&g.error("Failed to load orders. Please check your connection.")}catch(s){console.error("Data loading error:",s),g.error("Failed to load data"),C([])}finally{Ne(!1)}},[]);d.useEffect(()=>{ds()},[ds]),d.useEffect(()=>{if(Re&&m&&n?.email&&P.length>0){const s=P.find(t=>t.email===n.email);B(s?t=>({...t,customerId:s.id,customerName:s.name,customerCountry:s.country??"",customerCity:s.city??""}):t=>({...t,customerName:n.displayName||n.email||"Customer"}))}},[Re,m,n?.email,n?.displayName,P]);const se=_??[];d.useEffect(()=>{m&&console.log("[My Orders Debug]",{isCustomer:m,userEmail:n?.email,userRole:L,totalOrders:se.length,ordersCreatedByMe:se.filter(s=>s.createdBy===n?.email).length,allCreatedByValues:se.map(s=>s.createdBy),showArchived:$})},[m,n?.email,L,se,$]);const te=d.useMemo(()=>se.filter(s=>{if(m&&n?.email&&s.createdBy!==n.email)return!1;const t=s.archived===!0;if($!==t)return!1;const a=!Z||s.id.toLowerCase().includes(Z.toLowerCase())||s.customerName.toLowerCase().includes(Z.toLowerCase())||s.items.some(p=>p.itemName.toLowerCase().includes(Z.toLowerCase())),o=ne==="all"||s.receiptStatus===ne;return a&&o}),[se,Z,ne,$,m,n?.email]),Ss=d.useMemo(()=>H?[...te].sort((s,t)=>{const a=s[H],o=t[H];if(a==null&&o==null)return 0;if(a==null)return 1;if(o==null)return-1;if(typeof a=="number"&&typeof o=="number")return Fe==="asc"?a-o:o-a;const p=String(a).toLowerCase(),j=String(o).toLowerCase();return Fe==="asc"?p.localeCompare(j):j.localeCompare(p)}):te,[te,H,Fe]),{currentPage:Ds,totalPages:Ps,paginatedData:os,goToPage:Is,itemsPerPage:ks,totalItems:Os}=ga(Ss,10),{selectedIds:We,isSelected:ut,toggleItem:ht,toggleAll:jt,selectAllPages:pt,deselectAll:qe,isAllSelected:gt,isAllPageSelected:vt,isAllPagesSelected:Nt,isPartiallySelected:ft,selectionCount:ms,hasSelection:yt,totalItemCount:As,pageItemCount:Ts}=va(os,Ss),ae=d.useMemo(()=>{const s=se.filter(q=>!q.archived),t=s.length,a=s.reduce((q,de)=>q+de.totalAmount,0),o=s.reduce((q,de)=>q+de.totalReceived,0),p=s.filter(q=>q.receiptStatus==="Paid").length,j=s.filter(q=>q.receiptStatus==="Unpaid").length,b=s.filter(q=>q.receiptStatus==="Partially Paid").length,z=s.filter(q=>q.receiptStatus==="Overdue").length,c=s.filter(q=>q.shippingStatus==="Delivered").length,O=new Date;O.setDate(O.getDate()-7);const De=s.filter(q=>new Date(q.createdDate)>=O).length;return{totalSOs:t,totalValue:a,totalReceived:o,outstandingBalance:a-o,paidCount:p,unpaidCount:j,partiallyPaidCount:b,overdueCount:z,deliveredCount:c,newThisWeek:De,avgOrderValue:t>0?a/t:0,collectionRate:a>0?Math.round(o/a*100):0}},[se]),le=s=>{const t=s;H===t?Fe==="asc"?ns("desc"):(Cs(null),ns("asc")):(Cs(t),ns("asc"))},ce=s=>H===s?Fe:null,bt=s=>{const t=V.find(a=>a.id===s);return{itemId:t?.id??s,itemType:t?.brand??"-",itemCategory:t?.category??"-",itemSubcategory:t?.subcategory??"-"}},Rs=s=>{Be(s)},wt=()=>{Be(null)};d.useEffect(()=>{if(r&&_){const s=_.find(t=>t.id===r.id);s&&JSON.stringify(s)!==JSON.stringify(r)?Be(s):s||Be(null)}},[_,r]);const Je=s=>{const t={Unpaid:{variant:"outline",className:"border-amber-500 text-amber-600 bg-amber-50 dark:bg-amber-950/30"},"Partially Paid":{variant:"outline",className:"border-yellow-500 text-yellow-600 bg-yellow-50 dark:bg-yellow-950/30"},Paid:{variant:"default",className:"bg-green-600"},Overdue:{variant:"destructive"}},{variant:a,className:o}=t[s];return e.jsxs(K,{variant:a,className:J("gap-1",o),children:[s==="Paid"&&e.jsx(bs,{className:"h-3 w-3"}),s==="Unpaid"&&e.jsx(Xe,{className:"h-3 w-3"}),s==="Partially Paid"&&e.jsx(vs,{className:"h-3 w-3"}),s==="Overdue"&&e.jsx(Ys,{className:"h-3 w-3"}),s]})},Fs=d.useCallback(s=>P.find(t=>t.id===s),[P]),Ct=d.useCallback(s=>_?_.filter(t=>t.customerId===s&&!t.archived):[],[_]),St=d.useCallback(s=>Te.filter(t=>t.soId===s&&!t.archived),[Te]),Dt=d.useCallback(s=>Ge.filter(t=>t.salesOrderId===s&&!t.archived),[Ge]),xs=d.useCallback(s=>V.find(t=>t.id===s),[V]),Pt=d.useCallback(s=>{const t=[];return s.forEach(a=>{const o=xs(a.inventoryItemId);o&&o.quantity<a.quantity&&t.push({itemName:a.itemName,requested:a.quantity,available:o.quantity})}),t},[xs]),It=async()=>{if(!r||Y.amountReceived<=0){g.error("Please enter a valid payment amount");return}const s=Fs(r.customerId);try{await ca({trxDate:new Date().toISOString().split("T")[0],customerId:r.customerId,customerName:r.customerName,country:r.customerCountry,city:r.customerCity,soId:r.id,invoiceNumber:r.invoiceNumber,paymentMode:Y.paymentMode,amountReceived:Y.amountReceived,notes:Y.notes,createdBy:n?.displayName||n?.email||"Unknown"});const t=(r.totalReceived||0)+Y.amountReceived,a=r.totalAmount-t,o=a<=0?"Paid":a<r.totalAmount?"Partially Paid":"Unpaid";await js({id:r.id,totalReceived:t,receiptStatus:o}),s&&await da({id:s.id,payments:(s.payments||0)+Y.amountReceived}),g.success(`Payment of ${S(Y.amountReceived)} recorded successfully`),be(!1),Le({paymentMode:"Cash",amountReceived:0,notes:""}),ds()}catch{g.error("Failed to record payment")}},kt=async()=>{if(!r||!ee.carrier){g.error("Please fill in shipment details");return}const s=ee.destination||r.deliveryAddress||`${r.customerCity}, ${r.customerCountry}`;console.log("[Shipment] Creating shipment:",{salesOrderId:r.id,destination:s,carrier:ee.carrier,eta:ee.eta});try{const t=await oa({salesOrderId:r.id,destination:s,carrier:ee.carrier,status:"Pending",eta:ee.eta});console.log("[Shipment] Shipment created successfully:",t),await js({id:r.id,shippingStatus:"Processing"}),console.log("[Shipment] Sales order shipping status updated to Processing"),g.success("Shipment created successfully"),we(!1),$e({carrier:"",eta:"",destination:""});const a=await Vs();Ae(a);const o=await Ye();C(o)}catch(t){console.error("[Shipment] Failed to create shipment:",t),g.error(t instanceof Error?t.message:"Failed to create shipment")}},Ee=()=>{const s=m&&n?.displayName?n.displayName:"";B({soDate:new Date().toISOString().split("T")[0],customerId:"",customerName:s,customerCountry:"",customerCity:"",invoiceNumber:"",items:[],expectedDeliveryDate:"",notes:"",totalReceived:0,amountPaid:0,shippingStatus:"Pending"})},Bs=()=>{B(s=>({...s,items:[...s.items,{inventoryItemId:"",itemName:"",quantity:1,unitPrice:0,totalPrice:0}]}))},Ls=s=>{B(t=>({...t,items:t.items.filter((a,o)=>o!==s)}))},Ce=(s,t,a)=>{B(o=>{const p=[...o.items];if(t==="inventoryItemId"){const j=V.find(b=>b.id===a);j&&(p[s]={...p[s],inventoryItemId:j.id,itemName:j.name,unitPrice:j.pricePerPiece,totalPrice:p[s].quantity*j.pricePerPiece})}else if(t==="quantity"){const j=Number(a)||0;p[s]={...p[s],quantity:j,totalPrice:j*p[s].unitPrice}}else if(t==="unitPrice"){const j=Number(a)||0;p[s]={...p[s],unitPrice:j,totalPrice:p[s].quantity*j}}return{...o,items:p}})},$s=s=>{const t=P.find(a=>a.id===s);B(a=>({...a,customerId:s,customerName:t?.name??"",customerCountry:t?.country??"",customerCity:t?.city??""}))},Ot=async()=>{const s=!m&&!l.expectedDeliveryDate;if(!l.customerId||l.items.length===0||s){g.error("Please fill in all required fields");return}try{const t=await _s({soDate:l.soDate,customerId:l.customerId,customerName:l.customerName,customerCountry:l.customerCountry,customerCity:l.customerCity,invoiceNumber:l.invoiceNumber,items:l.items.map(a=>({...a,quantityShipped:0})),expectedDeliveryDate:l.expectedDeliveryDate||void 0,notes:l.notes,createdBy:n?.email??n?.id??"unknown",totalReceived:m?0:l.totalReceived,amountPaid:l.amountPaid});if(C(a=>[t,...a??[]]),g.success(`Sales Order ${t.id} created successfully`),m&&n?.email){const a=l.items.reduce((o,p)=>o+p.totalPrice,0);await y({type:"new_sales_order",title:"New Sales Order Created",message:`${n.name||n.email} created order ${t.id} for ${l.customerName} - ${S(a)}`,salesOrderId:t.id,customerName:l.customerName,createdBy:n.email,targetRoles:["Owner","Admin"]})}ye(!1),Ee()}catch(t){g.error(t instanceof Error?t.message:"Failed to create sales order")}},At=async s=>{const t=await _s({soDate:new Date().toISOString().split("T")[0],customerId:s.customerId,customerName:s.customerName,customerCountry:s.customerCountry,customerCity:s.customerCity,invoiceNumber:"",items:s.items.map(a=>({...a,quantityShipped:0})),expectedDeliveryDate:void 0,notes:s.notes,createdBy:n?.email??n?.id??"unknown",totalReceived:0,amountPaid:s.amountPaid});if(C(a=>[t,...a??[]]),n?.email){const a=s.items.reduce((o,p)=>o+p.totalPrice,0);await y({type:"new_sales_order",title:"New Customer Order",message:`${n.displayName||n.email} placed order ${t.id} - ${S(a)}`,salesOrderId:t.id,customerName:s.customerName,createdBy:n.email,targetRoles:["Owner","Admin"]})}return t},Tt=async s=>{const t=!m&&!l.expectedDeliveryDate;if(!l.customerId||l.items.length===0||t){g.error("Please fill in all required fields");return}try{const a=se.find(j=>j.id===s),o=new Map(a?.items?.map(j=>[j.inventoryItemId,j.quantityShipped??0])??[]),p=await js({id:s,soDate:l.soDate,customerId:l.customerId,customerName:l.customerName,customerCountry:l.customerCountry,customerCity:l.customerCity,invoiceNumber:l.invoiceNumber,items:l.items.map(j=>({...j,quantityShipped:o.get(j.inventoryItemId)??0})),expectedDeliveryDate:m?a?.expectedDeliveryDate:l.expectedDeliveryDate,notes:l.notes,totalReceived:m?a?.totalReceived:l.totalReceived,amountPaid:l.amountPaid,shippingStatus:m?a?.shippingStatus:l.shippingStatus});C(j=>j?.map(b=>b.id===s?p:b)??[]),g.success(`Sales Order ${s} updated successfully`),h(null),Ee()}catch(a){g.error(a instanceof Error?a.message:"Failed to update sales order")}},Rt=async s=>{try{await ha(s),C(t=>t?.filter(a=>a.id!==s)??[]),g.success(`Sales Order ${s} deleted`),h(null)}catch(t){g.error(t instanceof Error?t.message:"Failed to delete sales order")}},Ft=async s=>{try{await ua(s),C(t=>t?.map(a=>a.id===s?{...a,archived:!0}:a)??[]),g.success(`Sales Order ${s} archived`)}catch(t){g.error(t instanceof Error?t.message:"Failed to archive sales order")}},Bt=async s=>{try{await xa(s),C(t=>t?.map(a=>a.id===s?{...a,archived:!1}:a)??[]),g.success(`Sales Order ${s} restored`)}catch(t){g.error(t instanceof Error?t.message:"Failed to restore sales order")}},Lt=async()=>{try{const s=await pa(Array.from(We));s.success?g.success(`${s.successCount} sales orders archived`):g.warning(`${s.successCount} archived, ${s.failedCount} failed`);const t=await Ye();C(t),qe(),U(!1)}catch{g.error("Failed to archive sales orders")}},$t=async()=>{try{const s=await ma(Array.from(We));s.success?g.success(`${s.successCount} sales orders restored`):g.warning(`${s.successCount} restored, ${s.failedCount} failed`);const t=await Ye();C(t),qe()}catch{g.error("Failed to restore sales orders")}},qs=async()=>{try{const s=await ja(Array.from(We));s.success?g.success(`${s.successCount} sales orders permanently deleted`):g.warning(`${s.successCount} deleted, ${s.failedCount} failed`),C(t=>t?.filter(a=>!We.has(a.id))??[]),qe(),U(!1)}catch{g.error("Failed to permanently delete sales orders")}},qt=s=>{B({soDate:s.soDate??s.createdDate,customerId:s.customerId,customerName:s.customerName,customerCountry:s.customerCountry??"",customerCity:s.customerCity??"",invoiceNumber:s.invoiceNumber??"",items:(s.items??[]).map(t=>({inventoryItemId:t.inventoryItemId,itemName:t.itemName,quantity:t.quantity,unitPrice:t.unitPrice,totalPrice:t.totalPrice})),expectedDeliveryDate:s.expectedDeliveryDate??"",notes:s.notes??"",totalReceived:s.totalReceived??0,amountPaid:s.amountPaid??0,shippingStatus:s.shippingStatus??"Pending"}),h(s.id)},Et=()=>{const s=["Date","SO ID","Customer ID","Customer Name","Invoice #","Country","City","Items","Total Amount","Total Received","SO Balance","Receipt Status","Shipping Status","Expected Delivery","Notes"],t=te.map(b=>[b.soDate??b.createdDate,b.id,b.customerId,b.customerName,b.invoiceNumber??"",b.customerCountry??"",b.customerCity??"",(b.items??[]).map(z=>`${z.itemName} (${z.quantity})`).join("; "),(b.totalAmount??0).toFixed(2),(b.totalReceived??0).toFixed(2),(b.soBalance??b.totalAmount??0).toFixed(2),b.receiptStatus,b.shippingStatus??"Pending",b.expectedDeliveryDate??"",b.notes??""]),a=[s,...t].map(b=>b.map(z=>`"${z}"`).join(",")).join(`
`),o=new Blob([a],{type:"text/csv"}),p=URL.createObjectURL(o),j=document.createElement("a");j.href=p,j.download=`sales-orders-${new Date().toISOString().split("T")[0]}.csv`,j.click(),URL.revokeObjectURL(p),g.success("Sales orders exported to CSV")},Mt=()=>{Qe(""),fe("all"),me(!1)},Se=d.useMemo(()=>l.items.reduce((s,t)=>s+t.totalPrice,0),[l.items]),Vt=s=>{const t={type:"sales-order",documentNumber:s.id,documentDate:s.soDate??s.createdDate,partyType:"Customer",partyName:s.customerName,partyCity:s.customerCity,partyCountry:s.customerCountry,referenceNumber:s.invoiceNumber,referenceLabel:"Invoice No.",items:s.items?.map(a=>({description:a.itemName,quantity:a.quantity,unitPrice:a.unitPrice,total:a.totalPrice}))||[],totalAmount:s.totalAmount??0,amountPaid:s.totalReceived??0,balance:s.soBalance??s.totalAmount-s.totalReceived??0,status:`${s.receiptStatus} / ${s.shippingStatus}`,expectedDeliveryDate:s.expectedDeliveryDate,notes:s.notes,createdBy:s.createdBy};E(t)};if(is)return e.jsx("div",{className:"p-6",children:e.jsx(Na,{rows:8})});if(r){const s=new Date(r.soDate||r.createdDate||new Date),t=c=>{switch(c){case"Delivered":return"bg-green-600";case"Shipped":case"In Transit":case"Out for Delivery":return"bg-blue-600";case"Failed":case"Returned":return"bg-red-600";default:return"bg-amber-600"}},a=Fs(r.customerId),o=Ct(r.customerId),p=St(r.id),j=Dt(r.id),b=Pt(r.items);p.reduce((c,O)=>c+O.amountReceived,0);const z=r.totalAmount-(r.totalReceived||0);return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs(x,{variant:"outline",size:"sm",onClick:wt,children:[e.jsx(ka,{className:"h-4 w-4 mr-1"}),"Back"]}),e.jsxs("div",{children:[e.jsxs("h2",{className:"text-xl font-semibold",children:["Order Details - ",r.id]}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[r.customerName," • Created by ",r.createdBy]})]})]}),e.jsxs("div",{className:"flex gap-2 flex-wrap print:hidden",children:[!m&&z>0&&e.jsxs(x,{size:"sm",variant:"outline",onClick:()=>be(!0),children:[e.jsx(vs,{className:"h-4 w-4 mr-1"}),"Record Payment"]}),!m&&r.shippingStatus==="Pending"&&j.length===0&&e.jsxs(x,{size:"sm",variant:"outline",onClick:()=>we(!0),children:[e.jsx(Pe,{className:"h-4 w-4 mr-1"}),"Create Shipment"]}),e.jsxs(x,{variant:"outline",size:"sm",onClick:()=>Vt(r),children:[e.jsx(Oa,{className:"h-4 w-4 mr-2"}),"Print"]})]})]}),b.length>0&&!m&&e.jsx(I,{className:"border-amber-300 bg-amber-50 dark:bg-amber-950/30",children:e.jsx(D,{className:"p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(ta,{className:"h-5 w-5 text-amber-600 shrink-0 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-amber-800 dark:text-amber-200",children:"Low Stock Warning"}),e.jsx("ul",{className:"text-sm text-amber-700 dark:text-amber-300 mt-1 space-y-1",children:b.map((c,O)=>e.jsxs("li",{children:[c.itemName,": Requested ",c.requested,", Available ",c.available]},O))})]})]})})}),e.jsxs(I,{className:"print:shadow-none print:border-none",id:"order-receipt",children:[e.jsx(T,{className:"pb-2",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(aa,{className:"h-5 w-5 text-primary"}),e.jsx(R,{className:"text-lg",children:"Sales Order Receipt"})]})}),e.jsxs(D,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Aa,{className:"h-4 w-4 text-muted-foreground shrink-0"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-muted-foreground text-xs",children:"Order ID"}),e.jsx("p",{className:"font-mono font-medium text-xs sm:text-sm",children:r.id})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ns,{className:"h-4 w-4 text-muted-foreground shrink-0"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-muted-foreground text-xs",children:"Date & Time"}),e.jsxs("p",{className:"font-medium text-xs sm:text-sm",children:[s.toLocaleDateString()," ",s.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(hs,{className:"h-4 w-4 text-muted-foreground shrink-0"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-muted-foreground text-xs",children:"Customer"}),e.jsx("p",{className:"font-medium text-xs sm:text-sm",children:r.customerName})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Gs,{className:"h-4 w-4 text-muted-foreground shrink-0"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-muted-foreground text-xs",children:"Invoice #"}),e.jsx("p",{className:"font-medium text-xs sm:text-sm",children:r.invoiceNumber||"N/A"})]})]})]}),(r.customerCity||r.customerCountry)&&e.jsxs("div",{className:"flex items-start gap-2 bg-muted/50 rounded-lg p-3",children:[e.jsx(fs,{className:"h-4 w-4 text-muted-foreground mt-0.5 shrink-0"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Customer Location"}),e.jsx("p",{className:"text-sm",children:[r.customerCity,r.customerCountry].filter(Boolean).join(", ")})]})]}),r.deliveryAddress&&e.jsxs("div",{className:"flex items-start gap-2 bg-blue-50 dark:bg-blue-950/30 border border-blue-200 dark:border-blue-800 rounded-lg p-3",children:[e.jsx(Pe,{className:"h-4 w-4 text-blue-600 mt-0.5 shrink-0"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Delivery Address"}),e.jsx("p",{className:"text-sm",children:r.deliveryAddress})]})]}),e.jsx(G,{}),e.jsxs("div",{children:[e.jsxs("h4",{className:"font-medium mb-3 flex items-center gap-2",children:[e.jsx(ts,{className:"h-4 w-4"}),"Items Ordered (",r.items?.length||0,")"]}),!r.items||r.items.length===0?e.jsx(gs,{icon:ve,title:"No line items",description:"This sales order has no line items"}):e.jsx("div",{className:"space-y-2 bg-muted/30 rounded-lg p-3",children:r.items.map((c,O)=>e.jsxs("div",{className:"flex justify-between items-start text-sm",children:[e.jsxs("div",{className:"flex-1 min-w-0 pr-2",children:[e.jsx("p",{className:"font-medium line-clamp-1",children:c.itemName}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[S(c.unitPrice)," × ",c.quantity]})]}),e.jsx("p",{className:"font-medium shrink-0",children:S(c.totalPrice)})]},O))})]}),e.jsx(G,{}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"Subtotal"}),e.jsx("span",{children:S(r.totalAmount??0)})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"Shipping"}),e.jsx("span",{className:"text-green-600",children:"Free"})]}),e.jsx(G,{}),e.jsxs("div",{className:"flex justify-between font-semibold text-lg",children:[e.jsx("span",{children:"Total"}),e.jsx("span",{className:"text-primary",children:S(r.totalAmount??0)})]}),(r.amountPaid??0)>0&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"Amount Paid"}),e.jsx("span",{className:"text-green-600",children:S(r.amountPaid??0)})]}),e.jsxs("div",{className:"flex justify-between text-sm font-medium",children:[e.jsx("span",{className:"text-muted-foreground",children:"Balance Due"}),e.jsx("span",{className:"text-amber-600",children:S((r.totalAmount??0)-(r.amountPaid??0))})]})]})]}),e.jsx(G,{}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-amber-50 dark:bg-amber-950/30 border border-amber-200 dark:border-amber-800 rounded-lg p-3",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(Qs,{className:"h-4 w-4 text-amber-600"}),e.jsx("span",{className:"font-medium text-sm",children:"Payment"})]}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsxs(K,{variant:"secondary",className:"gap-1",children:[e.jsx(Qs,{className:"h-3 w-3"}),"Cash on Delivery"]}),Je(r.receiptStatus)]})]}),e.jsxs("div",{className:"bg-blue-50 dark:bg-blue-950/30 border border-blue-200 dark:border-blue-800 rounded-lg p-3",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(Pe,{className:"h-4 w-4 text-blue-600"}),e.jsx("span",{className:"font-medium text-sm",children:"Shipping"})]}),e.jsxs(K,{className:`gap-1 ${t(r.shippingStatus||"Pending")}`,children:[r.shippingStatus==="Delivered"?e.jsx(bs,{className:"h-3 w-3"}):e.jsx(Xe,{className:"h-3 w-3"}),r.shippingStatus??"Pending"]})]})]}),r.notes&&e.jsxs("div",{className:"text-sm bg-muted/50 rounded-lg p-3",children:[e.jsx("p",{className:"text-muted-foreground mb-1 font-medium",children:"Order Notes:"}),e.jsx("p",{className:"italic",children:r.notes})]}),r.expectedDeliveryDate&&e.jsxs("div",{className:"text-sm text-muted-foreground flex items-center gap-2",children:[e.jsx(Ns,{className:"h-4 w-4"}),"Expected Delivery: ",new Date(r.expectedDeliveryDate).toLocaleDateString()]})]})]}),!m&&e.jsxs(Va,{defaultValue:"items",className:"print:hidden",children:[e.jsxs(za,{className:"grid w-full grid-cols-4 h-auto",children:[e.jsxs(es,{value:"items",className:"text-xs sm:text-sm py-2",children:[e.jsx(ts,{className:"h-4 w-4 mr-1 hidden sm:inline"}),"Items"]}),e.jsxs(es,{value:"customer",className:"text-xs sm:text-sm py-2",children:[e.jsx(hs,{className:"h-4 w-4 mr-1 hidden sm:inline"}),"Customer"]}),e.jsxs(es,{value:"payments",className:"text-xs sm:text-sm py-2",children:[e.jsx(ys,{className:"h-4 w-4 mr-1 hidden sm:inline"}),"Payments"]}),e.jsxs(es,{value:"shipments",className:"text-xs sm:text-sm py-2",children:[e.jsx(Pe,{className:"h-4 w-4 mr-1 hidden sm:inline"}),"Shipments"]})]}),e.jsx(ss,{value:"items",className:"mt-4",children:e.jsxs(I,{children:[e.jsx(T,{className:"pb-3",children:e.jsxs(R,{className:"text-base flex items-center gap-2",children:[e.jsx(ts,{className:"h-4 w-4"}),"Line Items & Inventory"]})}),e.jsx(D,{children:r.items&&r.items.length>0&&e.jsx("div",{className:"border rounded-lg overflow-x-auto",children:e.jsxs(Ie,{children:[e.jsx(ke,{children:e.jsxs(Q,{children:[e.jsx(v,{children:"Item"}),e.jsx(v,{children:"Category"}),e.jsx(v,{className:"text-right",children:"Qty"}),e.jsx(v,{className:"text-right",children:"Stock"}),e.jsx(v,{className:"text-right",children:"Unit Price"}),e.jsx(v,{className:"text-right",children:"Total"})]})}),e.jsx(Oe,{children:r.items.map((c,O)=>{const De=xs(c.inventoryItemId),q=bt(c.inventoryItemId),de=De?De.quantity>=c.quantity?"ok":De.quantity>0?"low":"out":"unknown";return e.jsxs(Q,{children:[e.jsx(u,{children:e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:c.itemName}),e.jsx("p",{className:"text-xs text-muted-foreground font-mono",children:q.itemId})]})}),e.jsx(u,{className:"text-muted-foreground",children:q.itemCategory}),e.jsx(u,{className:"text-right",children:c.quantity}),e.jsx(u,{className:"text-right",children:e.jsx(K,{variant:de==="ok"?"default":de==="low"?"secondary":"destructive",className:de==="ok"?"bg-green-600":de==="low"?"bg-amber-500":"",children:De?.quantity??"N/A"})}),e.jsx(u,{className:"text-right",children:S(c.unitPrice)}),e.jsx(u,{className:"text-right font-medium",children:S(c.totalPrice)})]},O)})})]})})})]})}),e.jsx(ss,{value:"customer",className:"mt-4",children:e.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[e.jsxs(I,{children:[e.jsx(T,{className:"pb-3",children:e.jsxs(R,{className:"text-base flex items-center gap-2",children:[e.jsx(Ws,{className:"h-4 w-4"}),"Customer Profile"]})}),e.jsx(D,{className:"space-y-3",children:a?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"h-12 w-12 rounded-full bg-primary/10 flex items-center justify-center",children:e.jsx(hs,{className:"h-6 w-6 text-primary"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold",children:a.name}),e.jsx(K,{variant:a.status==="Active"?"default":"secondary",className:a.status==="Active"?"bg-green-600":"",children:a.status})]})]}),e.jsx(G,{}),e.jsxs("div",{className:"grid gap-2 text-sm",children:[a.contact&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(zs,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{children:a.contact})]}),a.email&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ra,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{children:a.email})]}),a.phone&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ta,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{children:a.phone})]}),(a.city||a.country)&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(fs,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("span",{children:[a.city,a.country].filter(Boolean).join(", ")})]}),a.address&&e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(Ws,{className:"h-4 w-4 text-muted-foreground mt-0.5"}),e.jsx("span",{children:a.address})]})]}),e.jsx(G,{}),e.jsxs("div",{className:"grid grid-cols-3 gap-2 text-center",children:[e.jsxs("div",{className:"p-2 bg-muted/50 rounded",children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Total Purchases"}),e.jsx("p",{className:"font-semibold text-sm",children:S(a.purchases||0)})]}),e.jsxs("div",{className:"p-2 bg-muted/50 rounded",children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Payments"}),e.jsx("p",{className:"font-semibold text-sm text-green-600",children:S(a.payments||0)})]}),e.jsxs("div",{className:"p-2 bg-muted/50 rounded",children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Balance"}),e.jsx("p",{className:J("font-semibold text-sm",(a.balance||0)>0?"text-amber-600":"text-green-600"),children:S(a.balance||0)})]})]})]}):e.jsx("p",{className:"text-muted-foreground text-sm",children:"Customer not found"})})]}),e.jsxs(I,{children:[e.jsx(T,{className:"pb-3",children:e.jsxs(R,{className:"text-base flex items-center gap-2",children:[e.jsx(Fa,{className:"h-4 w-4"}),"Order History (",o.length,")"]})}),e.jsx(D,{children:o.length>0?e.jsxs("div",{className:"space-y-2 max-h-[300px] overflow-y-auto",children:[o.slice(0,10).map(c=>e.jsx("div",{className:J("p-2 rounded border text-sm cursor-pointer hover:bg-muted/50",c.id===r.id&&"bg-primary/10 border-primary"),onClick:()=>c.id!==r.id&&Be(c),children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:c.id}),e.jsx("p",{className:"text-xs text-muted-foreground",children:new Date(c.soDate||c.createdDate).toLocaleDateString()})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"font-medium",children:S(c.totalAmount)}),Je(c.receiptStatus)]})]})},c.id)),o.length>10&&e.jsxs("p",{className:"text-xs text-muted-foreground text-center",children:["+",o.length-10," more orders"]})]}):e.jsx("p",{className:"text-muted-foreground text-sm",children:"No order history"})})]})]})}),e.jsx(ss,{value:"payments",className:"mt-4",children:e.jsxs(I,{children:[e.jsx(T,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(R,{className:"text-base flex items-center gap-2",children:[e.jsx(ys,{className:"h-4 w-4"}),"Payment History"]}),z>0&&e.jsxs(x,{size:"sm",onClick:()=>be(!0),children:[e.jsx(ie,{className:"h-4 w-4 mr-1"}),"Record Payment"]})]})}),e.jsxs(D,{children:[e.jsxs("div",{className:"grid grid-cols-3 gap-3 mb-4",children:[e.jsxs("div",{className:"p-3 bg-muted/50 rounded-lg text-center",children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Order Total"}),e.jsx("p",{className:"font-bold text-lg",children:S(r.totalAmount)})]}),e.jsxs("div",{className:"p-3 bg-green-50 dark:bg-green-950/30 rounded-lg text-center",children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Total Paid"}),e.jsx("p",{className:"font-bold text-lg text-green-600",children:S(r.totalReceived||0)})]}),e.jsxs("div",{className:J("p-3 rounded-lg text-center",z>0?"bg-amber-50 dark:bg-amber-950/30":"bg-green-50 dark:bg-green-950/30"),children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Balance Due"}),e.jsx("p",{className:J("font-bold text-lg",z>0?"text-amber-600":"text-green-600"),children:S(z)})]})]}),p.length>0?e.jsx("div",{className:"border rounded-lg overflow-x-auto",children:e.jsxs(Ie,{children:[e.jsx(ke,{children:e.jsxs(Q,{children:[e.jsx(v,{children:"Date"}),e.jsx(v,{children:"Transaction ID"}),e.jsx(v,{children:"Method"}),e.jsx(v,{className:"text-right",children:"Amount"})]})}),e.jsx(Oe,{children:p.map(c=>e.jsxs(Q,{children:[e.jsx(u,{children:new Date(c.trxDate).toLocaleDateString()}),e.jsx(u,{className:"font-mono text-sm",children:c.id}),e.jsx(u,{children:e.jsx(K,{variant:"outline",children:c.paymentMode})}),e.jsx(u,{className:"text-right font-medium text-green-600",children:S(c.amountReceived)})]},c.id))})]})}):e.jsxs("div",{className:"text-center py-6 text-muted-foreground",children:[e.jsx(ys,{className:"h-8 w-8 mx-auto mb-2 opacity-50"}),e.jsx("p",{children:"No payments recorded yet"}),z>0&&e.jsx(x,{variant:"outline",size:"sm",className:"mt-2",onClick:()=>be(!0),children:"Record First Payment"})]})]})]})}),e.jsx(ss,{value:"shipments",className:"mt-4",children:e.jsxs(I,{children:[e.jsx(T,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(R,{className:"text-base flex items-center gap-2",children:[e.jsx(Pe,{className:"h-4 w-4"}),"Shipment Tracking"]}),j.length===0&&e.jsxs(x,{size:"sm",onClick:()=>we(!0),children:[e.jsx(ie,{className:"h-4 w-4 mr-1"}),"Create Shipment"]})]})}),e.jsxs(D,{children:[(r.deliveryAddress||r.customerCity)&&e.jsx("div",{className:"mb-4 p-3 bg-blue-50 dark:bg-blue-950/30 rounded-lg",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(fs,{className:"h-4 w-4 text-blue-600 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Delivery Address"}),e.jsx("p",{className:"text-sm",children:r.deliveryAddress||`${r.customerCity}, ${r.customerCountry}`})]})]})}),j.length>0?e.jsx("div",{className:"space-y-3",children:j.map(c=>e.jsxs("div",{className:"p-3 border rounded-lg",children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:c.id}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Carrier: ",c.carrier]})]}),e.jsx(K,{className:t(c.status),children:c.status})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Destination"}),e.jsx("p",{children:c.destination})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"ETA"}),e.jsx("p",{children:c.eta?new Date(c.eta).toLocaleDateString():"TBD"})]})]})]},c.id))}):e.jsxs("div",{className:"text-center py-6 text-muted-foreground",children:[e.jsx(Pe,{className:"h-8 w-8 mx-auto mb-2 opacity-50"}),e.jsx("p",{children:"No shipments created yet"}),e.jsx(x,{variant:"outline",size:"sm",className:"mt-2",onClick:()=>we(!0),children:"Create Shipment"})]})]})]})})]}),!m&&e.jsx(I,{className:"print:hidden",children:e.jsx(D,{className:"py-3",children:e.jsxs("div",{className:"flex flex-wrap gap-4 text-xs text-muted-foreground",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(zs,{className:"h-3 w-3"}),"Created by: ",r.createdBy]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Ns,{className:"h-3 w-3"}),"Created: ",new Date(r.createdDate).toLocaleString()]})]})})}),e.jsx(Me,{open:xt,onOpenChange:be,children:e.jsxs(Ve,{className:"sm:max-w-md",children:[e.jsxs(ze,{children:[e.jsx(_e,{children:"Record Payment"}),e.jsxs(Ue,{children:["Record a payment for order ",r.id,". Balance due: ",S(z)]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(w,{children:"Payment Method"}),e.jsxs(xe,{value:Y.paymentMode,onValueChange:c=>Le(O=>({...O,paymentMode:c})),children:[e.jsx(ue,{children:e.jsx(he,{})}),e.jsxs(je,{children:[e.jsx(W,{value:"Cash",children:"Cash"}),e.jsx(W,{value:"Bank Transfer",children:"Bank Transfer"}),e.jsx(W,{value:"Credit Card",children:"Credit Card"}),e.jsx(W,{value:"Check",children:"Check"}),e.jsx(W,{value:"Online Payment",children:"Online Payment"})]})]})]}),e.jsxs("div",{children:[e.jsx(w,{children:"Amount Received"}),e.jsx(N,{type:"number",min:"0",step:"0.01",max:z,value:Y.amountReceived||"",onChange:c=>Le(O=>({...O,amountReceived:parseFloat(c.target.value)||0})),placeholder:"0.00"}),e.jsx("div",{className:"flex gap-2 mt-2",children:e.jsx(x,{type:"button",variant:"outline",size:"sm",onClick:()=>Le(c=>({...c,amountReceived:z})),children:"Full Amount"})})]}),e.jsxs("div",{children:[e.jsx(w,{children:"Notes (Optional)"}),e.jsx(N,{value:Y.notes,onChange:c=>Le(O=>({...O,notes:c.target.value})),placeholder:"Payment notes..."})]})]}),e.jsxs(Ze,{children:[e.jsx(x,{variant:"outline",onClick:()=>be(!1),children:"Cancel"}),e.jsx(x,{onClick:It,disabled:Y.amountReceived<=0,children:"Record Payment"})]})]})}),e.jsx(Me,{open:cs,onOpenChange:we,children:e.jsxs(Ve,{className:"sm:max-w-md",children:[e.jsxs(ze,{children:[e.jsx(_e,{children:"Create Shipment"}),e.jsxs(Ue,{children:["Create a shipment for order ",r.id]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(w,{children:"Carrier"}),e.jsx(N,{value:ee.carrier,onChange:c=>$e(O=>({...O,carrier:c.target.value})),placeholder:"e.g., FedEx, UPS, LBC"})]}),e.jsxs("div",{children:[e.jsx(w,{children:"Destination"}),e.jsx(N,{value:ee.destination,onChange:c=>$e(O=>({...O,destination:c.target.value})),placeholder:r.deliveryAddress||`${r.customerCity}, ${r.customerCountry}`})]}),e.jsxs("div",{children:[e.jsx(w,{children:"Estimated Arrival (Optional)"}),e.jsx(N,{type:"date",value:ee.eta,onChange:c=>$e(O=>({...O,eta:c.target.value}))})]})]}),e.jsxs(Ze,{children:[e.jsx(x,{variant:"outline",onClick:()=>we(!1),children:"Cancel"}),e.jsx(x,{onClick:kt,disabled:!ee.carrier,children:"Create Shipment"})]})]})})]})}return m&&mt?e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Place New Order"}),e.jsx("p",{className:"text-muted-foreground",children:"Browse products and add them to your cart"})]})}),e.jsx(Ha,{inventoryData:V,customersData:P,onSubmitOrder:At,onCancel:()=>ls(!1)})]}):m?e.jsxs("div",{className:"space-y-4 sm:space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold tracking-tight",children:"My Orders"}),e.jsx("p",{className:"text-sm sm:text-base text-muted-foreground",children:"View and track your orders"})]}),e.jsxs(x,{onClick:()=>ls(!0),className:"w-full sm:w-auto",children:[e.jsx(ie,{className:"h-4 w-4 mr-2"}),"Place New Order"]})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-3",children:[e.jsxs(I,{children:[e.jsxs(T,{className:"flex flex-row items-center justify-between pb-2",children:[e.jsx(R,{className:"text-sm font-medium text-muted-foreground",children:"Total Orders"}),e.jsx(ve,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsx(D,{children:e.jsx("div",{className:"text-2xl font-bold",children:te.length})})]}),e.jsxs(I,{children:[e.jsxs(T,{className:"flex flex-row items-center justify-between pb-2",children:[e.jsx(R,{className:"text-sm font-medium text-muted-foreground",children:"Pending"}),e.jsx(Xe,{className:"h-4 w-4 text-amber-600"})]}),e.jsx(D,{children:e.jsx("div",{className:"text-2xl font-bold text-amber-600",children:te.filter(s=>s.shippingStatus==="Pending"||s.shippingStatus==="Processing").length})})]}),e.jsxs(I,{children:[e.jsxs(T,{className:"flex flex-row items-center justify-between pb-2",children:[e.jsx(R,{className:"text-sm font-medium text-muted-foreground",children:"Delivered"}),e.jsx(Js,{className:"h-4 w-4 text-green-600"})]}),e.jsx(D,{children:e.jsx("div",{className:"text-2xl font-bold text-green-600",children:te.filter(s=>s.shippingStatus==="Delivered").length})})]})]}),e.jsxs(I,{children:[e.jsx(T,{children:e.jsx(R,{children:"Order History"})}),e.jsxs(D,{children:[te.length===0?e.jsx(gs,{icon:ve,title:"No orders yet",description:"Place your first order to get started",action:e.jsxs(x,{onClick:()=>ls(!0),children:[e.jsx(ie,{className:"h-4 w-4 mr-2"}),"Place New Order"]})}):e.jsx("div",{className:"border rounded-lg overflow-hidden overflow-x-auto",children:e.jsxs(Ie,{children:[e.jsx(ke,{children:e.jsxs(Q,{children:[e.jsx(v,{className:"whitespace-nowrap",children:"Order ID"}),e.jsx(v,{className:"whitespace-nowrap",children:"Date"}),e.jsx(v,{className:"whitespace-nowrap",children:"Items"}),e.jsx(v,{className:"text-right whitespace-nowrap",children:"Total"}),e.jsx(v,{className:"text-right whitespace-nowrap hidden sm:table-cell",children:"Paid"}),e.jsx(v,{className:"whitespace-nowrap",children:"Payment"}),e.jsx(v,{className:"whitespace-nowrap",children:"Shipping"})]})}),e.jsx(Oe,{children:os.map(s=>e.jsxs(Q,{className:"cursor-pointer hover:bg-muted/50",onClick:()=>Rs(s),children:[e.jsx(u,{className:"font-medium font-mono text-xs sm:text-sm whitespace-nowrap",children:s.id}),e.jsx(u,{className:"whitespace-nowrap text-xs sm:text-sm",children:s.soDate??s.createdDate}),e.jsx(u,{className:"whitespace-nowrap",children:e.jsxs("span",{className:"text-muted-foreground text-xs sm:text-sm",children:[s.items.length," item",s.items.length!==1?"s":""]})}),e.jsx(u,{className:"text-right font-medium whitespace-nowrap text-xs sm:text-sm",children:S(s.totalAmount)}),e.jsx(u,{className:"text-right text-green-600 hidden sm:table-cell",children:S(s.amountPaid??0)}),e.jsx(u,{children:e.jsx(K,{variant:s.receiptStatus==="Paid"?"default":s.receiptStatus==="Partially Paid"?"secondary":s.receiptStatus==="Overdue"?"destructive":"outline",className:s.receiptStatus==="Paid"?"bg-green-600":s.receiptStatus==="Partially Paid"?"bg-amber-500":s.receiptStatus==="Overdue"?"bg-red-600":"",children:s.receiptStatus??"Unpaid"})}),e.jsx(u,{children:e.jsx(K,{variant:s.shippingStatus==="Delivered"?"default":s.shippingStatus==="Shipped"||s.shippingStatus==="In Transit"||s.shippingStatus==="Out for Delivery"?"secondary":s.shippingStatus==="Failed"||s.shippingStatus==="Returned"?"destructive":"outline",className:s.shippingStatus==="Delivered"?"bg-green-600":s.shippingStatus==="Out for Delivery"?"bg-blue-600":s.shippingStatus==="In Transit"?"bg-blue-500":s.shippingStatus==="Shipped"?"bg-cyan-600":s.shippingStatus==="Processing"?"bg-amber-500":"",children:s.shippingStatus??"Pending"})})]},s.id))})]})}),te.length>0&&e.jsx("div",{className:"mt-4",children:e.jsx(Us,{totalItems:Os,itemsPerPage:ks,currentPage:Ds,totalPages:Ps,onPageChange:Is})})]})]})]}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Sales Orders"}),e.jsx("p",{className:"text-muted-foreground",children:"Create and manage customer orders, track payments, and monitor delivery status"})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:[e.jsxs(I,{className:"relative overflow-hidden",children:[e.jsxs(T,{className:"flex flex-row items-center justify-between pb-2",children:[e.jsx(R,{className:"text-sm font-medium text-muted-foreground",children:"Total SOs"}),e.jsx(Gs,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(D,{children:[e.jsx("div",{className:"text-2xl font-bold",children:ae.totalSOs}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:[ae.newThisWeek," new this week"]})]})]}),e.jsxs(I,{className:"relative overflow-hidden",children:[e.jsxs(T,{className:"flex flex-row items-center justify-between pb-2",children:[e.jsx(R,{className:"text-sm font-medium text-muted-foreground",children:"Total Value"}),e.jsx(vs,{className:"h-4 w-4 text-emerald-600"})]}),e.jsxs(D,{children:[e.jsx("div",{className:"text-2xl font-bold text-emerald-600",children:S(ae.totalValue)}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:["Avg: ",S(ae.avgOrderValue)," per SO"]})]})]}),e.jsxs(I,{className:"relative overflow-hidden",children:[e.jsxs(T,{className:"flex flex-row items-center justify-between pb-2",children:[e.jsx(R,{className:"text-sm font-medium text-muted-foreground",children:"Outstanding"}),e.jsx(Xe,{className:"h-4 w-4 text-amber-600"})]}),e.jsxs(D,{children:[e.jsx("div",{className:"text-2xl font-bold text-amber-600",children:S(ae.outstandingBalance)}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:[ae.unpaidCount," unpaid, ",ae.overdueCount," overdue"]})]})]}),e.jsxs(I,{className:"relative overflow-hidden",children:[e.jsxs(T,{className:"flex flex-row items-center justify-between pb-2",children:[e.jsx(R,{className:"text-sm font-medium text-muted-foreground",children:"Collection Rate"}),e.jsx(Js,{className:"h-4 w-4 text-blue-600"})]}),e.jsxs(D,{children:[e.jsxs("div",{className:"text-2xl font-bold text-blue-600",children:[ae.collectionRate,"%"]}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:[ae.paidCount," paid of ",ae.totalSOs," total"]})]})]})]}),e.jsxs(I,{children:[e.jsxs(T,{className:"flex flex-row items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(R,{children:"Sales Orders"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Manage customer sales orders"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(x,{variant:"outline",size:"sm",onClick:Et,children:[e.jsx(Ca,{className:"h-4 w-4 mr-1"}),"Export CSV"]}),F&&e.jsxs(Me,{open:Re,onOpenChange:ye,children:[e.jsx(ia,{asChild:!0,children:e.jsxs(x,{size:"sm",children:[e.jsx(ie,{className:"h-4 w-4 mr-1"}),"Create SO"]})}),e.jsxs(Ve,{className:"max-w-4xl max-h-[90vh] overflow-y-auto",children:[e.jsxs(ze,{children:[e.jsx(_e,{children:"Create Sales Order"}),e.jsx(Ue,{children:"Create a new sales order for a customer"})]}),e.jsxs("div",{className:"space-y-6 py-4",children:[e.jsxs(I,{children:[e.jsx(T,{className:"pb-3",children:e.jsx(R,{className:"text-base",children:"Sales Order Information"})}),e.jsxs(D,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(w,{children:"SO Date *"}),e.jsx(N,{type:"date",value:l.soDate,onChange:s=>B(t=>({...t,soDate:s.target.value}))})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(w,{children:"Customer *"}),m?e.jsx(N,{value:n?.displayName||n?.email||"Customer",disabled:!0,className:"bg-muted"}):e.jsxs(xe,{value:l.customerId,onValueChange:$s,children:[e.jsx(ue,{children:e.jsx(he,{placeholder:"Select customer"})}),e.jsx(je,{children:P.filter(s=>s.status==="Active").map(s=>e.jsx(W,{value:s.id,children:s.name},s.id))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(w,{children:"Customer ID"}),e.jsx(N,{value:l.customerId,disabled:!0,className:"bg-muted"})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(w,{children:"Country"}),e.jsx(N,{value:l.customerCountry,disabled:!0,className:"bg-muted"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(w,{children:"City"}),e.jsx(N,{value:l.customerCity,disabled:!0,className:"bg-muted"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(w,{children:"Invoice #"}),e.jsx(N,{value:l.invoiceNumber,onChange:s=>B(t=>({...t,invoiceNumber:s.target.value})),placeholder:"INV-2025-0001"})]})]}),!m&&e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(w,{children:"Expected Delivery Date *"}),e.jsx(N,{type:"date",value:l.expectedDeliveryDate,onChange:s=>B(t=>({...t,expectedDeliveryDate:s.target.value}))})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(w,{children:"Total Received (₱)"}),e.jsx(N,{type:"number",min:"0",step:"0.01",value:l.totalReceived,onChange:s=>B(t=>({...t,totalReceived:parseFloat(s.target.value)||0}))})]})]}),e.jsx("div",{className:"grid grid-cols-2 gap-4",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx(w,{children:"Amount Paid (₱)"}),e.jsx(N,{type:"number",min:"0",step:"0.01",value:l.amountPaid,onChange:s=>B(t=>({...t,amountPaid:parseFloat(s.target.value)||0})),placeholder:"Enter amount paid"})]})}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(w,{children:"Notes"}),e.jsx(N,{value:l.notes,onChange:s=>B(t=>({...t,notes:s.target.value})),placeholder:"Additional notes..."})]})]})]}),e.jsxs(I,{children:[e.jsxs(T,{className:"pb-3 flex flex-row items-center justify-between",children:[e.jsx(R,{className:"text-base",children:"Line Items"}),e.jsxs(x,{size:"sm",variant:"outline",onClick:Bs,children:[e.jsx(ie,{className:"h-4 w-4 mr-1"}),"Add Item"]})]}),e.jsxs(D,{children:[l.items.length===0?e.jsx("p",{className:"text-sm text-muted-foreground text-center py-4",children:'No items added. Click "Add Item" to add line items.'}):e.jsxs(Ie,{children:[e.jsx(ke,{children:e.jsxs(Q,{children:[e.jsx(v,{children:"Item"}),e.jsx(v,{className:"w-24",children:"Qty"}),e.jsx(v,{className:"w-32",children:"Unit Price"}),e.jsx(v,{className:"w-32 text-right",children:"Total"}),e.jsx(v,{className:"w-12"})]})}),e.jsx(Oe,{children:l.items.map((s,t)=>e.jsxs(Q,{children:[e.jsx(u,{children:e.jsxs(xe,{value:s.inventoryItemId,onValueChange:a=>Ce(t,"inventoryItemId",a),children:[e.jsx(ue,{children:e.jsx(he,{placeholder:"Select item"})}),e.jsx(je,{children:V.map(a=>e.jsx(W,{value:a.id,children:a.name},a.id))})]})}),e.jsx(u,{children:e.jsx(N,{type:"number",min:"1",value:s.quantity,onChange:a=>Ce(t,"quantity",a.target.value)})}),e.jsx(u,{children:e.jsx(N,{type:"number",min:"0",step:"0.01",value:s.unitPrice,onChange:a=>Ce(t,"unitPrice",a.target.value)})}),e.jsxs(u,{className:"text-right font-medium",children:["₱",s.totalPrice.toLocaleString(void 0,{minimumFractionDigits:2})]}),e.jsx(u,{children:e.jsx(x,{size:"sm",variant:"ghost",onClick:()=>Ls(t),children:e.jsx(ge,{className:"h-4 w-4 text-destructive"})})})]},t))})]}),e.jsxs("div",{className:"mt-4 pt-4 border-t flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"Grand Total:"}),e.jsxs("span",{className:"ml-2 text-xl font-bold",children:["₱",Se.toLocaleString(void 0,{minimumFractionDigits:2})]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"SO Balance:"}),e.jsxs("span",{className:J("ml-2 text-xl font-bold",Se-l.totalReceived>0?"text-orange-600":"text-green-600"),children:["₱",(Se-l.totalReceived).toLocaleString(void 0,{minimumFractionDigits:2})]})]})]})]})]}),e.jsxs(Ze,{children:[e.jsx(x,{variant:"outline",onClick:()=>{ye(!1),Ee()},children:"Cancel"}),e.jsx(x,{onClick:Ot,children:"Create Sales Order"})]})]})]})]})]})]}),e.jsxs(D,{className:"space-y-4",children:[e.jsxs("div",{className:"flex gap-4 items-center",children:[e.jsxs("div",{className:"relative flex-1 max-w-sm",children:[e.jsx(et,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(N,{placeholder:"Search SO ID, customer, or items...",value:re,onChange:s=>Qe(s.target.value),className:"pl-10"})]}),e.jsxs(xe,{value:ne,onValueChange:fe,children:[e.jsxs(ue,{className:"w-48",children:[e.jsx(fa,{className:"h-4 w-4 mr-2"}),e.jsx(he,{placeholder:"Filter by status"})]}),e.jsxs(je,{children:[e.jsx(W,{value:"all",children:"All Statuses"}),Ka.map(s=>e.jsx(W,{value:s,children:s},s))]})]}),e.jsxs(x,{variant:$?"default":"outline",size:"sm",onClick:()=>me(!$),className:$?"bg-orange-500 hover:bg-orange-600 text-white":"",children:[e.jsx(He,{className:"h-4 w-4 mr-1"}),$?"Viewing Archived":"View Archived"]}),(re||ne!=="all"||$)&&e.jsxs(x,{variant:"ghost",size:"sm",onClick:Mt,className:"text-muted-foreground",children:[e.jsx(na,{className:"h-4 w-4 mr-1"}),"Clear Filters"]})]}),yt&&f&&e.jsx(ya,{selectionCount:ms,onClearSelection:qe,actions:$?[{id:"restore",label:"Restore",icon:e.jsx(Ks,{className:"h-4 w-4 mr-1"}),variant:"outline",onClick:$t},...A?[{id:"permanent-delete",label:"Permanently Delete",icon:e.jsx(ge,{className:"h-4 w-4 mr-1"}),variant:"destructive",onClick:()=>U(!0)}]:[]]:[{id:"archive",label:"Archive",icon:e.jsx(He,{className:"h-4 w-4 mr-1"}),variant:"outline",onClick:()=>U(!0)}]}),te.length===0?e.jsx(gs,{icon:$?He:ve,title:$?"No archived sales orders":"No sales orders found",description:$?"Archived sales orders will appear here":re||ne!=="all"?"Try adjusting your search or filters":"Create your first sales order to get started",actionLabel:!$&&F?"Create SO":void 0,onAction:!$&&F?()=>ye(!0):void 0}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"border rounded-lg overflow-hidden",children:[e.jsx(ba,{pageItemCount:Ts,totalItemCount:As,isAllPagesSelected:Nt,show:vt&&As>Ts,onSelectAllPages:pt,onClearSelection:qe,itemLabel:"orders"}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(Ie,{children:[e.jsx(ke,{children:e.jsxs(Q,{children:[f&&e.jsx(v,{className:"w-12",children:e.jsx("input",{type:"checkbox",checked:gt,ref:s=>{s&&(s.indeterminate=ft)},onChange:()=>jt(),className:"h-4 w-4"})}),e.jsx(oe,{sortKey:"soDate",currentSortKey:H,sortDirection:ce("soDate"),onSort:le,children:"Date"}),e.jsx(oe,{sortKey:"id",currentSortKey:H,sortDirection:ce("id"),onSort:le,children:"SO ID"}),e.jsx(v,{children:"Customer ID"}),e.jsx(oe,{sortKey:"customerName",currentSortKey:H,sortDirection:ce("customerName"),onSort:le,children:"Customer Name"}),e.jsx(v,{children:"Invoice #"}),e.jsx(v,{children:"Country"}),e.jsx(v,{children:"City"}),e.jsx(oe,{sortKey:"totalAmount",currentSortKey:H,sortDirection:ce("totalAmount"),onSort:le,className:"text-right",children:"Total Amount"}),e.jsx(oe,{sortKey:"totalReceived",currentSortKey:H,sortDirection:ce("totalReceived"),onSort:le,className:"text-right",children:"Total Received"}),e.jsx(oe,{sortKey:"soBalance",currentSortKey:H,sortDirection:ce("soBalance"),onSort:le,className:"text-right",children:"SO Balance"}),e.jsx(oe,{sortKey:"receiptStatus",currentSortKey:H,sortDirection:ce("receiptStatus"),onSort:le,children:"Receipt Status"}),e.jsx(oe,{sortKey:"shippingStatus",currentSortKey:H,sortDirection:ce("shippingStatus"),onSort:le,children:"Shipping"}),e.jsx(v,{children:"Actions"})]})}),e.jsx(Oe,{children:os.map(s=>e.jsxs(Q,{className:"cursor-pointer hover:bg-muted/50",onClick:()=>qt(s),children:[f&&e.jsx(u,{onClick:t=>t.stopPropagation(),children:e.jsx("input",{type:"checkbox",checked:ut(s.id),onChange:()=>ht(s.id),className:"h-4 w-4"})}),e.jsx(u,{className:"whitespace-nowrap",children:s.soDate??s.createdDate}),e.jsx(u,{className:"font-medium",children:s.id}),e.jsx(u,{className:"text-muted-foreground",children:s.customerId}),e.jsx(u,{children:s.customerName}),e.jsx(u,{className:"text-muted-foreground",children:s.invoiceNumber||"-"}),e.jsx(u,{children:s.customerCountry||"-"}),e.jsx(u,{children:s.customerCity||"-"}),e.jsxs(u,{className:"text-right font-medium",children:["₱",(s.totalAmount??0).toLocaleString(void 0,{minimumFractionDigits:2})]}),e.jsxs(u,{className:"text-right",children:["₱",(s.totalReceived??0).toLocaleString(void 0,{minimumFractionDigits:2})]}),e.jsx(u,{className:"text-right font-medium",children:e.jsxs("span",{className:J((s.soBalance??s.totalAmount??0)>0?"text-orange-600":"text-green-600"),children:["₱",(s.soBalance??s.totalAmount??0).toLocaleString(void 0,{minimumFractionDigits:2})]})}),e.jsx(u,{children:Je(s.receiptStatus)}),e.jsx(u,{children:e.jsx(K,{variant:s.shippingStatus==="Delivered"?"default":s.shippingStatus==="In Transit"||s.shippingStatus==="Shipped"?"secondary":s.shippingStatus==="Failed"||s.shippingStatus==="Returned"?"destructive":"outline",children:s.shippingStatus??"Pending"})}),e.jsx(u,{onClick:t=>t.stopPropagation(),children:e.jsxs("div",{className:"flex gap-1",children:[e.jsx(x,{size:"sm",variant:"outline",onClick:()=>Rs(s),title:"View Details",children:e.jsx(la,{className:"h-4 w-4"})}),$?e.jsx(x,{size:"sm",variant:"outline",onClick:()=>Bt(s.id),title:"Restore",children:e.jsx(Ks,{className:"h-4 w-4"})}):e.jsx(x,{size:"sm",variant:"ghost",className:"text-destructive",onClick:()=>Ft(s.id),title:"Archive",children:e.jsx(He,{className:"h-4 w-4"})})]})})]},s.id))})]})})]}),e.jsx(Us,{currentPage:Ds,totalPages:Ps,itemsPerPage:ks,onPageChange:Is,totalItems:Os})]}),i&&e.jsx(Me,{open:!!i,onOpenChange:s=>{s||(h(null),Ee())},children:e.jsxs(Ve,{className:"max-w-4xl max-h-[90vh] overflow-y-auto",children:[e.jsxs(ze,{children:[e.jsxs(_e,{children:["Edit Sales Order - ",i]}),e.jsx(Ue,{children:"Update sales order details"})]}),e.jsx("div",{className:"space-y-6 py-4",children:(()=>{const s=se.find(t=>t.id===i);return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"Receipt Status:"}),s&&Je(s.receiptStatus),e.jsx("span",{className:"text-sm text-muted-foreground ml-4",children:"Shipping:"}),e.jsx(K,{variant:s?.shippingStatus==="Delivered"?"default":s?.shippingStatus==="In Transit"||s?.shippingStatus==="Shipped"?"secondary":s?.shippingStatus==="Failed"||s?.shippingStatus==="Returned"?"destructive":"outline",children:s?.shippingStatus??"Pending"})]}),e.jsxs(I,{children:[e.jsx(T,{className:"pb-3",children:e.jsx(R,{className:"text-base",children:"Sales Order Information"})}),e.jsxs(D,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(w,{children:"SO Date"}),e.jsx(N,{type:"date",value:l.soDate,onChange:t=>B(a=>({...a,soDate:t.target.value})),disabled:m,className:m?"bg-muted":""})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(w,{children:"Customer"}),m?e.jsx(N,{value:l.customerName||n?.displayName||n?.email||"Customer",disabled:!0,className:"bg-muted"}):e.jsxs(xe,{value:l.customerId,onValueChange:$s,children:[e.jsx(ue,{children:e.jsx(he,{placeholder:"Select customer"})}),e.jsx(je,{children:P.map(t=>e.jsx(W,{value:t.id,children:t.name},t.id))})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(w,{children:"Customer ID"}),e.jsx(N,{value:l.customerId,disabled:!0,className:"bg-muted"})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(w,{children:"Country"}),e.jsx(N,{value:l.customerCountry,disabled:!0,className:"bg-muted"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(w,{children:"City"}),e.jsx(N,{value:l.customerCity,disabled:!0,className:"bg-muted"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(w,{children:"Invoice #"}),e.jsx(N,{value:l.invoiceNumber,onChange:t=>B(a=>({...a,invoiceNumber:t.target.value})),disabled:m,className:m?"bg-muted":""})]})]}),!m&&e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(w,{children:"Expected Delivery Date"}),e.jsx(N,{type:"date",value:l.expectedDeliveryDate,onChange:t=>B(a=>({...a,expectedDeliveryDate:t.target.value}))})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(w,{children:"Total Received (₱)"}),e.jsx(N,{type:"number",min:"0",step:"0.01",value:l.totalReceived,onChange:t=>B(a=>({...a,totalReceived:parseFloat(t.target.value)||0}))})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(w,{children:"Shipping Status"}),e.jsxs(xe,{value:l.shippingStatus,onValueChange:t=>B(a=>({...a,shippingStatus:t})),children:[e.jsx(ue,{children:e.jsx(he,{})}),e.jsx(je,{children:Ga.map(t=>e.jsx(W,{value:t,children:t},t))})]})]})]}),e.jsx("div",{className:"grid grid-cols-2 gap-4",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx(w,{children:"Amount Paid (₱)"}),e.jsx(N,{type:"number",min:"0",step:"0.01",value:l.amountPaid,onChange:t=>B(a=>({...a,amountPaid:parseFloat(t.target.value)||0})),placeholder:"Enter amount paid"})]})}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(w,{children:"Notes"}),e.jsx(N,{value:l.notes,onChange:t=>B(a=>({...a,notes:t.target.value})),placeholder:"Optional notes..."})]})]})]}),e.jsxs(I,{children:[e.jsxs(T,{className:"pb-3 flex flex-row items-center justify-between",children:[e.jsx(R,{className:"text-base",children:"Line Items"}),e.jsxs(x,{size:"sm",variant:"outline",onClick:Bs,children:[e.jsx(ie,{className:"h-4 w-4 mr-1"}),"Add Item"]})]}),e.jsxs(D,{children:[l.items.length===0?e.jsx("p",{className:"text-sm text-muted-foreground text-center py-4",children:"No items added."}):e.jsxs(Ie,{children:[e.jsx(ke,{children:e.jsxs(Q,{children:[e.jsx(v,{children:"Item"}),e.jsx(v,{className:"w-24",children:"Qty"}),e.jsx(v,{className:"w-32",children:"Unit Price"}),e.jsx(v,{className:"w-32 text-right",children:"Total"}),e.jsx(v,{className:"w-12"})]})}),e.jsx(Oe,{children:l.items.map((t,a)=>e.jsxs(Q,{children:[e.jsx(u,{children:e.jsxs(xe,{value:t.inventoryItemId,onValueChange:o=>Ce(a,"inventoryItemId",o),children:[e.jsx(ue,{children:e.jsx(he,{placeholder:"Select item"})}),e.jsx(je,{children:V.map(o=>e.jsx(W,{value:o.id,children:o.name},o.id))})]})}),e.jsx(u,{children:e.jsx(N,{type:"number",min:"1",value:t.quantity,onChange:o=>Ce(a,"quantity",o.target.value)})}),e.jsx(u,{children:e.jsx(N,{type:"number",min:"0",step:"0.01",value:t.unitPrice,onChange:o=>Ce(a,"unitPrice",o.target.value)})}),e.jsxs(u,{className:"text-right font-medium",children:["₱",t.totalPrice.toLocaleString(void 0,{minimumFractionDigits:2})]}),e.jsx(u,{children:e.jsx(x,{size:"sm",variant:"ghost",onClick:()=>Ls(a),children:e.jsx(ge,{className:"h-4 w-4 text-destructive"})})})]},a))})]}),e.jsxs("div",{className:"mt-4 pt-4 border-t flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"Grand Total:"}),e.jsxs("span",{className:"ml-2 text-xl font-bold",children:["₱",Se.toLocaleString(void 0,{minimumFractionDigits:2})]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-sm text-muted-foreground",children:"SO Balance:"}),e.jsxs("span",{className:J("ml-2 text-xl font-bold",Se-l.totalReceived>0?"text-orange-600":"text-green-600"),children:["₱",(Se-l.totalReceived).toLocaleString(void 0,{minimumFractionDigits:2})]})]})]})]})]}),e.jsxs(Ze,{className:"gap-2",children:[f&&e.jsxs(x,{variant:"destructive",onClick:()=>Rt(i),children:[e.jsx(ge,{className:"h-4 w-4 mr-1"}),"Delete"]}),e.jsx(x,{variant:"outline",onClick:()=>{h(null),Ee()},children:"Cancel"}),e.jsx(x,{onClick:()=>Tt(i),children:"Save Changes"})]})]})})()})]})})]})]}),e.jsx(Me,{open:k,onOpenChange:U,children:e.jsxs(Ve,{className:"max-w-md",children:[e.jsxs(ze,{children:[e.jsxs(_e,{className:"flex items-center gap-2",children:[e.jsx(Ys,{className:"h-5 w-5 text-destructive"}),"Delete ",ms," Sales Order",ms!==1?"s":""]}),e.jsx(Ue,{children:$?"These sales orders are already archived. This action will permanently remove them from the system.":"Choose how you want to delete the selected sales orders:"})]}),$?e.jsxs("div",{className:"space-y-4 pt-2",children:[e.jsx("div",{className:"p-3 border border-destructive/50 rounded-md bg-destructive/10",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(ge,{className:"h-4 w-4 mt-0.5 text-destructive"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-destructive",children:"Permanent Deletion"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"This cannot be undone. All data will be permanently removed."})]})]})}),e.jsxs("div",{className:"flex gap-2 justify-end",children:[e.jsx(x,{variant:"outline",onClick:()=>U(!1),children:"Cancel"}),e.jsx(x,{variant:"destructive",onClick:qs,children:"Permanently Delete All"})]})]}):e.jsxs("div",{className:"space-y-4 pt-2",children:[e.jsx("div",{className:"p-3 border rounded-md hover:bg-muted/50 transition-colors",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(He,{className:"h-4 w-4 mt-0.5 text-muted-foreground"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-medium",children:"Archive"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Move to archive. Sales orders can be restored later."})]}),e.jsx(x,{variant:"secondary",size:"sm",onClick:Lt,children:"Archive"})]})}),A&&e.jsx("div",{className:"p-3 border border-destructive/50 rounded-md bg-destructive/10",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(ge,{className:"h-4 w-4 mt-0.5 text-destructive"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-medium text-destructive",children:"Delete Permanently"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Cannot be undone. Data will be permanently removed."})]}),e.jsx(x,{variant:"destructive",size:"sm",onClick:qs,children:"Delete"})]})}),e.jsx("div",{className:"flex justify-end",children:e.jsx(x,{variant:"outline",onClick:()=>U(!1),children:"Cancel"})})]})]})})]})}export{fr as SalesOrdersView};
