import{q as Se,w as Ne,r as n,Y as we,ae as be,t as i,af as ke,j as e,C as S,i as N,k as w,l as b,B as f,L as d,I as c,ag as Ae,z as De,c as J,p as Q,h as Fe,U as Te,A as W,ah as Ee,ai as Be,aj as Pe}from"./index-BjBZPTIE.js";import{u as Ie,j as Le,k as Oe,D as X,l as Z,P as Ue,a as ee,b as se,c as ae,d as te,m as $e,B as Me,T as qe,n as ze,o as He,E as Ke,p as Re,q as Ge,r as le,s as m,t as _e,v as p,w as Ve}from"./bulk-delete-dialog-QpcyU4QX.js";import{S as Ye,F as Je}from"./save-search-dialog-sodEcau2.js";/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qe=[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]],We=Se("phone",Qe);function ss({initialOpenDialog:P,onDialogOpened:I}){const{isFavorite:L,getFavoritesByType:O}=Ne(),[x,U]=n.useState(""),[h,$]=n.useState(!1),[M,g]=n.useState(null),[ne,q]=n.useState(!0),[y,v]=n.useState(!1),[k,A]=n.useState(null),[a,r]=n.useState({id:"",name:"",contact:"",email:"",phone:"",category:"",status:"Active"}),D=Ie(x,300);n.useEffect(()=>{(async()=>{q(!0);const s=await we();g(s),q(!1)})()},[]),n.useEffect(()=>{P&&!y&&(v(!0),I?.())},[P,I,y]);const z=n.useMemo(()=>M??[],[M]),F=n.useMemo(()=>z.filter(s=>{if(h&&!L("suppliers",s.id))return!1;if(D){const l=D.toLowerCase();if(!(s.name.toLowerCase().includes(l)||s.id.toLowerCase().includes(l)||s.category.toLowerCase().includes(l)))return!1}return!0}),[z,D,h,L]),ie=n.useCallback(s=>{s.searchTerm&&U(s.searchTerm),s.filters.favoritesOnly==="true"&&$(!0)},[]),re=n.useMemo(()=>{const s={};return h&&(s.favoritesOnly="true"),s},[h]),{currentPage:H,totalPages:ce,paginatedData:K,goToPage:de,totalItems:oe,itemsPerPage:ue}=Le(F,25),{selectedIds:C,selectedItems:R,selectionCount:G,isAllSelected:he,isPartiallySelected:me,hasSelection:T,toggleItem:pe,toggleAll:E,deselectAll:o,isSelected:xe}=Oe(K),[_,V]=n.useState(!1),[ge,Y]=n.useState(!1),[je,B]=n.useState(!1);n.useEffect(()=>{o()},[H,o]),n.useEffect(()=>{const s=l=>{(l.metaKey||l.ctrlKey)&&l.key==="a"&&!y&&!k&&(l.preventDefault(),E()),l.key==="Escape"&&T&&o()};return window.addEventListener("keydown",s),()=>window.removeEventListener("keydown",s)},[E,o,T,y,k]);const fe=s=>s==="Active"?"bg-green-500/10 text-green-700":"bg-gray-500/10 text-gray-700",ye=n.useCallback(async()=>{V(!0);try{const s=Array.from(C),l=await be(s);g(t=>t?.filter(u=>!s.includes(u.id))??[]),l.failedCount>0?i.warning(`Deleted ${l.successCount} suppliers. ${l.failedCount} failed.`):i.success(`Successfully deleted ${l.successCount} supplier${l.successCount!==1?"s":""}`),o()}catch(s){i.error(s?.message||"Failed to delete suppliers")}finally{V(!1),B(!1)}},[C,o]),ve=n.useCallback(async s=>{Y(!0);try{const l=Array.from(C),t=await ke(l,s);g(u=>u&&u.map(j=>l.includes(j.id)?{...j,status:s}:j)),t.failedCount>0?i.warning(`Updated ${t.successCount} suppliers. ${t.failedCount} failed.`):i.success(`Successfully updated ${t.successCount} supplier${t.successCount!==1?"s":""}`),o()}catch(l){i.error(l?.message||"Failed to update suppliers")}finally{Y(!1)}},[C,o]),Ce=n.useMemo(()=>R.map(s=>s.name),[R]);return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid gap-4 md:grid-cols-3",children:[e.jsxs(S,{children:[e.jsx(N,{className:"pb-2",children:e.jsx(w,{className:"text-sm text-muted-foreground",children:"Total Suppliers"})}),e.jsx(b,{children:e.jsx("div",{className:"text-2xl",children:"48"})})]}),e.jsxs(S,{children:[e.jsx(N,{className:"pb-2",children:e.jsx(w,{className:"text-sm text-muted-foreground",children:"Active"})}),e.jsx(b,{children:e.jsx("div",{className:"text-2xl",children:"42"})})]}),e.jsxs(S,{children:[e.jsx(N,{className:"pb-2",children:e.jsx(w,{className:"text-sm text-muted-foreground",children:"Categories"})}),e.jsx(b,{children:e.jsx("div",{className:"text-2xl",children:"8"})})]})]}),e.jsxs(S,{children:[e.jsx(N,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(w,{children:"Supplier Management"}),e.jsx("div",{className:"flex gap-2",children:e.jsxs(X,{open:y,onOpenChange:s=>{v(s),s||r({id:"",name:"",contact:"",email:"",phone:"",category:"",status:"Active"})},children:[e.jsx(Z,{asChild:!0,children:e.jsxs(f,{onClick:()=>r({id:"",name:"",contact:"",email:"",phone:"",category:"",status:"Active"}),children:[e.jsx(Ue,{className:"h-4 w-4 mr-2"}),"Add Supplier"]})}),e.jsxs(ee,{children:[e.jsxs(se,{children:[e.jsx(ae,{children:"Add New Supplier"}),e.jsx(te,{children:"Enter the details for the new supplier."})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{htmlFor:"supplier-name",children:"Company Name"}),e.jsx(c,{id:"supplier-name",placeholder:"Enter company name",value:a.name,onChange:s=>r({...a,name:s.target.value})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{htmlFor:"contact-name",children:"Contact Person"}),e.jsx(c,{id:"contact-name",placeholder:"Enter contact name",value:a.contact,onChange:s=>r({...a,contact:s.target.value})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{htmlFor:"email",children:"Email"}),e.jsx(c,{id:"email",type:"email",placeholder:"email@example.com",value:a.email,onChange:s=>r({...a,email:s.target.value})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{htmlFor:"phone",children:"Phone"}),e.jsx(c,{id:"phone",placeholder:"+1 (555) 000-0000",value:a.phone,onChange:s=>r({...a,phone:s.target.value})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{htmlFor:"category",children:"Category"}),e.jsx(c,{id:"category",placeholder:"e.g., Electronics",value:a.category,onChange:s=>r({...a,category:s.target.value})})]}),e.jsx(f,{className:"w-full",onClick:async()=>{if(!a.name.trim()||!a.contact.trim()||!a.email.trim()||!a.phone.trim()||!a.category.trim()){i.error("Please fill all required fields");return}try{const s=await Ae({name:a.name,contact:a.contact,email:a.email,phone:a.phone,category:a.category,status:a.status});g(l=>[s,...l??[]]),v(!1),i.success("Supplier added successfully"),r({id:"",name:"",contact:"",email:"",phone:"",category:"",status:"Active"})}catch(s){i.error(s?.message||"Failed to add supplier")}},children:"Add Supplier"})]})]})]})})]})}),e.jsxs(b,{children:[e.jsxs("div",{className:"mb-6 space-y-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx($e,{className:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground"}),e.jsx(c,{placeholder:"Search suppliers...",value:x,onChange:s=>U(s.target.value),className:"pl-9"})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-4",children:[e.jsxs(f,{variant:h?"default":"outline",size:"sm",onClick:()=>$(!h),className:"gap-1",children:[e.jsx(De,{className:J("h-4 w-4",h&&"fill-current")}),"Favorites",O("suppliers").length>0&&e.jsx(Q,{variant:"secondary",className:"ml-1 h-5 px-1.5",children:O("suppliers").length})]}),e.jsx(Ye,{entityType:"suppliers",currentSearchTerm:x,currentFilters:re,onApplySearch:ie})]})]}),T&&e.jsx(Me,{selectionCount:G,onClearSelection:o,isLoading:_||ge,actions:[{id:"delete",label:"Delete",icon:e.jsx(qe,{className:"h-4 w-4 mr-1"}),variant:"destructive",onClick:()=>B(!0)}],actionGroups:[{id:"status-update",label:"Update Status",icon:e.jsx(Fe,{className:"h-4 w-4 mr-1"}),options:[{value:"Active",label:"Active"},{value:"Inactive",label:"Inactive"}],onSelect:s=>ve(s)}],className:"mb-4"}),e.jsx(ze,{open:je,onOpenChange:B,itemCount:G,itemType:"supplier",itemNames:Ce,onConfirm:ye,isLoading:_}),ne?e.jsx(He,{rows:8}):F.length===0?e.jsx(Ke,{icon:Te,title:"No suppliers found",description:x?"Try adjusting your search criteria":"Get started by adding your first supplier",actionLabel:x?void 0:"Add Supplier",onAction:x?void 0:()=>v(!0)}):e.jsxs("div",{className:"rounded-md border",children:[e.jsxs(Re,{children:[e.jsx(Ge,{children:e.jsxs(le,{children:[e.jsx(m,{className:"w-12",children:e.jsx(W,{checked:he,ref:s=>{s&&(s.indeterminate=me)},onCheckedChange:E,"aria-label":"Select all suppliers"})}),e.jsx(m,{children:"Supplier ID"}),e.jsx(m,{children:"Company Name"}),e.jsx(m,{children:"Contact"}),e.jsx(m,{children:"Category"}),e.jsx(m,{children:"Status"}),e.jsx(m,{children:"Actions"})]})}),e.jsx(_e,{children:K.map(s=>{const l=xe(s.id);return e.jsxs(le,{className:J(l&&"bg-muted/50"),children:[e.jsx(p,{children:e.jsx(W,{checked:l,onCheckedChange:()=>pe(s.id),"aria-label":`Select supplier ${s.name}`})}),e.jsx(p,{children:s.id}),e.jsx(p,{children:s.name}),e.jsx(p,{children:e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center gap-1 text-sm",children:[e.jsx(Ee,{className:"h-3 w-3 text-muted-foreground"}),e.jsx("span",{className:"text-xs text-muted-foreground",children:s.email})]}),e.jsxs("div",{className:"flex items-center gap-1 text-sm",children:[e.jsx(We,{className:"h-3 w-3 text-muted-foreground"}),e.jsx("span",{className:"text-xs text-muted-foreground",children:s.phone})]})]})}),e.jsx(p,{children:s.category}),e.jsx(p,{children:e.jsx(Q,{variant:"secondary",className:fe(s.status),children:s.status})}),e.jsx(p,{children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Je,{entityType:"suppliers",entityId:s.id,entityName:s.name}),e.jsxs(X,{open:k===s.id,onOpenChange:t=>{A(t?s.id:null),t&&r({...s})},children:[e.jsx(Z,{asChild:!0,children:e.jsx(f,{variant:"ghost",size:"sm",children:"Edit"})}),e.jsxs(ee,{children:[e.jsxs(se,{children:[e.jsx(ae,{children:"Edit Supplier"}),e.jsx(te,{children:"Update fields and save your changes."})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{htmlFor:"edit-name",children:"Company Name"}),e.jsx(c,{id:"edit-name",value:a.name,onChange:t=>r({...a,name:t.target.value})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{htmlFor:"edit-contact",children:"Contact Person"}),e.jsx(c,{id:"edit-contact",value:a.contact,onChange:t=>r({...a,contact:t.target.value})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{htmlFor:"edit-email",children:"Email"}),e.jsx(c,{id:"edit-email",value:a.email,onChange:t=>r({...a,email:t.target.value})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{htmlFor:"edit-phone",children:"Phone"}),e.jsx(c,{id:"edit-phone",value:a.phone,onChange:t=>r({...a,phone:t.target.value})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{htmlFor:"edit-category",children:"Category"}),e.jsx(c,{id:"edit-category",value:a.category,onChange:t=>r({...a,category:t.target.value})})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(f,{className:"flex-1",onClick:async()=>{if(!a.id){i.error("Missing supplier id");return}if(!a.name.trim()||!a.contact.trim()||!a.email.trim()||!a.phone.trim()||!a.category.trim()){i.error("Please fill all required fields");return}try{const t=await Be({id:a.id,name:a.name,contact:a.contact,email:a.email,phone:a.phone,category:a.category,status:a.status});g(u=>(u??[]).map(j=>j.id===t.id?t:j)),A(null),i.success("Supplier updated")}catch(t){i.error(t?.message||"Failed to update supplier")}},children:"Save Changes"}),e.jsx(f,{variant:"destructive",onClick:async()=>{try{await Pe(s.id),g(t=>(t??[]).filter(u=>u.id!==s.id)),A(null),i.success("Supplier deleted")}catch(t){i.error(t?.message||"Failed to delete supplier")}},children:"Delete"})]})]})]})]})]})})]},s.id)})})]}),F.length>0&&e.jsx(Ve,{currentPage:H,totalPages:ce,onPageChange:de,itemsPerPage:ue,totalItems:oe})]})]})]})]})}export{ss as SuppliersView};
