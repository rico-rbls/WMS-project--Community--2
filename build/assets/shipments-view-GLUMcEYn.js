import{j as e,L as u,B as p,a1 as ie,I as y,J as Ts,i as Is,r as i,M as ks,aQ as Fs,aN as Os,b5 as fe,x as c,b6 as Ps,C as D,o as z,p as G,P as As,q as T,s as Ve,d as K,w as F,v as Es,D as ve,$ as He,y as Se,z as Ne,A as ye,E as be,F as qe,a2 as Bs,n as Ls,a9 as ze,aZ as $s,b7 as Ks}from"./index-gxFWpY0o.js";import{S as J,a as W,b as Y,c as _,d as M,T as Ms,e as Rs,f as Ge,g as Je,h as R,i as Us,j as I}from"./sortable-table-head-mJ6RUZKO.js";import{u as Vs,a as Hs,F as qs,B as zs,T as Gs,E as Js,S as Ws,P as Ys}from"./select-all-banner-Hc7FJDCu.js";import{C as Ye}from"./calendar-f0_2rZVA.js";import{S as _s,F as Qs}from"./favorite-button-BwajIXlx.js";import{u as Xs}from"./useTableSort-CBJoEzmR.js";import{c as Zs}from"./permissions-DeuZZz56.js";import{E as we}from"./editable-cell-COLs5UBQ.js";import{C as et}from"./circle-check-big--feQzDv5.js";import{T as st}from"./trending-up-C5FfjuJa.js";import{P as tt}from"./plus-DAtFw269.js";import{T as Ce}from"./trash-2-BcZf1mNC.js";import{C as at}from"./circle-alert-yPqsZxDx.js";import{M as rt}from"./map-pin-CEbuK3Kh.js";import"./skeleton-CNLMXCG4.js";import"./circle-check-Cokl5esX.js";function lt({fromDate:U,toDate:V,onFromDateChange:Q,onToDateChange:X,onClear:b,label:v="Date Range",className:O=""}){const w=U||V;return e.jsxs("div",{className:`space-y-2 ${O}`,children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ye,{className:"h-4 w-4 text-muted-foreground"}),e.jsx(u,{className:"text-sm font-medium",children:v}),w&&e.jsxs(p,{variant:"ghost",size:"sm",onClick:b,className:"h-6 px-2 text-xs",children:[e.jsx(ie,{className:"h-3 w-3 mr-1"}),"Clear"]})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-2",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(u,{htmlFor:"from-date",className:"text-xs text-muted-foreground",children:"From"}),e.jsx(y,{id:"from-date",type:"date",value:U,onChange:P=>Q(P.target.value),className:"w-full"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(u,{htmlFor:"to-date",className:"text-xs text-muted-foreground",children:"To"}),e.jsx(y,{id:"to-date",type:"date",value:V,onChange:P=>X(P.target.value),className:"w-full"})]})]})]})}const De=["Pending","In Transit","Delivered"],We=["FedEx","UPS","DHL","USPS","LBC Express","J&T Express","Ninja Van","Grab Express"];function bt({initialOpenDialog:U,onDialogOpened:V}){const{isFavorite:Q,getFavoritesByType:X}=Ts(),{user:b}=Is(),v=b?Zs(b.role):!1,O=b?.role==="Customer",[w,P]=i.useState(""),[d,A]=i.useState("all"),[h,ne]=i.useState(""),[x,de]=i.useState(""),[E,Te]=i.useState(!1),[Ie,C]=i.useState(null),[ke,_e]=i.useState([]),[Qe,Fe]=i.useState(!0),[H,q]=i.useState(!1),[ce,Z]=i.useState(null),[r,j]=i.useState({id:"",salesOrderId:"",destination:"",carrier:"",status:"Pending",eta:""}),oe=ks(w,300),Oe=i.useMemo(()=>!O||!b?.email?new Set:new Set(ke.filter(s=>s.createdBy===b.email).map(s=>s.id)),[O,b?.email,ke]);i.useEffect(()=>{(async()=>{Fe(!0);const[s,t]=await Promise.all([Fs(),Os()]);C(s),_e(t),Fe(!1)})()},[]),i.useEffect(()=>{U&&!H&&(q(!0),V?.())},[U,V,H]);const g=i.useMemo(()=>Ie??[],[Ie]),m=i.useMemo(()=>{const s=g.length,t=g.filter(l=>l.status==="Pending").length,a=g.filter(l=>l.status==="In Transit").length,o=g.filter(l=>l.status==="Delivered").length,N=t+a,f=new Date,le=new Date(f.getTime()-10080*60*1e3);new Date(f.getTime()-720*60*60*1e3);const ps=new Date(f.getTime()+10080*60*1e3),fs=g.filter(l=>{if(l.status!=="Delivered")return!1;try{const n=new Date(l.eta);return n>=le&&n<=f}catch{return!1}}).length,vs=g.filter(l=>{if(l.status==="Delivered")return!1;try{const n=new Date(l.eta);return n>=f&&n<=ps}catch{return!1}}).length,pe=g.filter(l=>l.status==="Delivered"),Ss=pe.length,Ns=pe.length>0?Math.round(Ss/pe.length*100):0,ys=s>0?Math.round(o/s*100):0,bs=g.reduce((l,n)=>(l[n.carrier]=(l[n.carrier]||0)+1,l),{}),ws=Object.entries(bs).sort((l,n)=>n[1]-l[1]).slice(0,5).map(([l,n])=>({name:l,count:n})),Cs=g.reduce((l,n)=>(l[n.destination]=(l[n.destination]||0)+1,l),{}),Ds=Object.entries(Cs).sort((l,n)=>n[1]-l[1]).slice(0,5).map(([l,n])=>({name:l,count:n}));return{totalShipments:s,pendingShipments:t,inTransitShipments:a,deliveredShipments:o,activeShipments:N,recentDeliveries7Days:fs,upcomingDeliveries:vs,onTimeRate:Ns,fulfillmentRate:ys,topCarriers:ws,topDestinations:Ds,avgTransitDays:3}},[g]),me=i.useMemo(()=>g.filter(s=>{if(O&&!Oe.has(s.salesOrderId)||E&&!Q("shipments",s.id)||d!=="all"&&s.status!==d)return!1;if(oe){const t=oe.toLowerCase();if(!(s.id.toLowerCase().includes(t)||s.salesOrderId.toLowerCase().includes(t)||s.destination.toLowerCase().includes(t)||s.carrier.toLowerCase().includes(t)))return!1}if(h||x)try{const t=new Date(s.eta);if(h){const a=new Date(h);if(t<a)return!1}if(x){const a=new Date(x);if(a.setHours(23,59,59,999),t>a)return!1}}catch{return!1}return!0}),[g,oe,d,h,x,E,Q,O,Oe]),{sortedData:Pe,sortConfig:B,requestSort:L,getSortDirection:$}=Xs(me),{currentPage:Ae,totalPages:Xe,paginatedData:Ee,goToPage:Ze,totalItems:es,itemsPerPage:ss}=Vs(Pe,25),{selectedIds:ee,selectedItems:Be,selectionCount:ue,isAllSelected:ts,isAllPageSelected:as,isAllPagesSelected:rs,isPartiallySelected:ls,hasSelection:he,toggleItem:is,toggleAll:xe,selectAllPages:ns,deselectAll:S,isSelected:ds,totalItemCount:Le,pageItemCount:$e}=Hs(Ee,Pe),[se,Ke]=i.useState(!1),[cs,Me]=i.useState(!1),[os,te]=i.useState(!1);i.useEffect(()=>{S()},[Ae,S]),i.useEffect(()=>{const s=t=>{(t.metaKey||t.ctrlKey)&&t.key==="a"&&!H&&!ce&&(t.preventDefault(),xe()),t.key==="Escape"&&he&&S()};return window.addEventListener("keydown",s),()=>window.removeEventListener("keydown",s)},[xe,S,he,H,ce]);function je(){j({id:"",salesOrderId:"",destination:"",carrier:"",status:"Pending",eta:new Date(Date.now()+10080*60*1e3).toISOString().split("T")[0]})}function Re(){ne(""),de("")}function ms(){P(""),A("all"),ne(""),de(""),Te(!1)}function Ue(){return r.salesOrderId.trim()?r.destination.trim()?r.carrier.trim()?r.eta.trim()?null:"ETA is required":"Carrier is required":"Destination is required":"Sales Order ID is required"}async function us(){const s=Ue();if(s){c.error(s);return}try{const t=await $s({salesOrderId:r.salesOrderId,destination:r.destination,carrier:r.carrier,status:r.status,eta:r.eta});C(a=>[t,...a??[]]),q(!1),je(),c.success("Shipment created successfully")}catch(t){c.error(t?.message||"Failed to create shipment")}}async function hs(){const s=Ue();if(s){c.error(s);return}if(!r.id){c.error("Missing shipment id");return}try{const t=await fe({id:r.id,salesOrderId:r.salesOrderId,destination:r.destination,carrier:r.carrier,status:r.status,eta:r.eta});C(a=>(a??[]).map(o=>o.id===t.id?t:o)),Z(null),c.success("Shipment updated successfully")}catch(t){c.error(t?.message||"Failed to update shipment")}}async function xs(s){try{await Ks(s),C(t=>(t??[]).filter(a=>a.id!==s)),Z(null),c.success("Shipment deleted successfully")}catch(t){c.error(t?.message||"Failed to delete shipment")}}const ge=i.useCallback(async(s,t,a)=>{try{const o={[t]:a},N=await fe({id:s,...o});C(f=>(f??[]).map(le=>le.id===s?N:le)),c.success(`${t.charAt(0).toUpperCase()+t.slice(1)} updated`)}catch(o){throw c.error(o?.message||"Failed to update"),o}},[C]),ae=s=>{switch(s){case"Delivered":return"bg-emerald-500/15 text-emerald-700 dark:text-emerald-400 border-emerald-200";case"In Transit":return"bg-blue-500/15 text-blue-700 dark:text-blue-400 border-blue-200";case"Pending":return"bg-slate-500/15 text-slate-700 dark:text-slate-400 border-slate-200";default:return"bg-slate-500/15 text-slate-700 dark:text-slate-400 border-slate-200"}},k=s=>{switch(s){case"Delivered":return"âœ“";case"In Transit":return"ðŸšš";case"Pending":return"â—‹";default:return"â—‹"}},js=i.useCallback(async()=>{Ke(!0);try{const s=Array.from(ee),t=await Ps(s);C(a=>a?.filter(o=>!s.includes(o.id))??[]),t.failedCount>0?c.warning(`Deleted ${t.successCount} shipments. ${t.failedCount} failed.`):c.success(`Successfully deleted ${t.successCount} shipment${t.successCount!==1?"s":""}`),S()}catch(s){c.error(s?.message||"Failed to delete shipments")}finally{Ke(!1),te(!1)}},[ee,S]),gs=i.useCallback(async s=>{Me(!0);try{const t=Array.from(ee);let a=0,o=0;for(const N of t)try{await fe({id:N,status:s}),a++}catch{o++}C(N=>N&&N.map(f=>t.includes(f.id)?{...f,status:s}:f)),o>0?c.warning(`Updated ${a} shipments. ${o} failed.`):c.success(`Successfully updated ${a} shipment${a!==1?"s":""}`),S()}catch(t){c.error(t?.message||"Failed to update shipments")}finally{Me(!1)}},[ee,S]),re=i.useMemo(()=>Be.map(s=>`${s.id} â†’ ${s.destination}`),[Be]);return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Shipments"}),e.jsx("p",{className:"text-muted-foreground",children:"Track shipment status, carrier information, and delivery timelines"})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:[e.jsxs(D,{className:"relative overflow-hidden",children:[e.jsxs(z,{className:"flex flex-row items-center justify-between pb-2",children:[e.jsx(G,{className:"text-sm font-medium text-muted-foreground",children:"Total Shipments"}),e.jsx(As,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(T,{children:[e.jsx("div",{className:"text-2xl font-bold",children:m.totalShipments}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:[m.upcomingDeliveries," arriving this week"]})]})]}),e.jsxs(D,{className:"relative overflow-hidden",children:[e.jsxs(z,{className:"flex flex-row items-center justify-between pb-2",children:[e.jsx(G,{className:"text-sm font-medium text-muted-foreground",children:"Active Shipments"}),e.jsx(Ve,{className:"h-4 w-4 text-blue-600"})]}),e.jsxs(T,{children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:m.activeShipments}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:[m.pendingShipments," pending, ",m.inTransitShipments," in transit"]})]})]}),e.jsxs(D,{className:"relative overflow-hidden",children:[e.jsxs(z,{className:"flex flex-row items-center justify-between pb-2",children:[e.jsx(G,{className:"text-sm font-medium text-muted-foreground",children:"Delivered"}),e.jsx(et,{className:"h-4 w-4 text-emerald-600"})]}),e.jsxs(T,{children:[e.jsx("div",{className:"text-2xl font-bold text-emerald-600",children:m.deliveredShipments}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:[m.recentDeliveries7Days," in last 7 days"]})]})]}),e.jsxs(D,{className:"relative overflow-hidden",children:[e.jsxs(z,{className:"flex flex-row items-center justify-between pb-2",children:[e.jsx(G,{className:"text-sm font-medium text-muted-foreground",children:"Fulfillment Rate"}),e.jsx(st,{className:"h-4 w-4 text-purple-600"})]}),e.jsxs(T,{children:[e.jsxs("div",{className:"text-2xl font-bold text-purple-600",children:[m.fulfillmentRate,"%"]}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:[m.deliveredShipments," of ",m.totalShipments," fulfilled"]})]})]})]}),e.jsxs("div",{className:"grid gap-3 grid-cols-1 sm:grid-cols-3",children:[e.jsx(D,{className:K("cursor-pointer transition-all hover:shadow-md border-l-4",d==="Pending"?"ring-2 ring-primary":"","border-l-slate-400"),onClick:()=>A(d==="Pending"?"all":"Pending"),children:e.jsx(T,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-medium text-muted-foreground uppercase tracking-wide",children:"Pending"}),e.jsx("p",{className:"text-xl font-bold mt-1",children:m.pendingShipments})]}),e.jsx(F,{variant:"outline",className:ae("Pending"),children:k("Pending")})]})})}),e.jsx(D,{className:K("cursor-pointer transition-all hover:shadow-md border-l-4",d==="In Transit"?"ring-2 ring-primary":"","border-l-blue-400"),onClick:()=>A(d==="In Transit"?"all":"In Transit"),children:e.jsx(T,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-medium text-muted-foreground uppercase tracking-wide",children:"In Transit"}),e.jsx("p",{className:"text-xl font-bold mt-1",children:m.inTransitShipments})]}),e.jsx(F,{variant:"outline",className:ae("In Transit"),children:k("In Transit")})]})})}),e.jsx(D,{className:K("cursor-pointer transition-all hover:shadow-md border-l-4",d==="Delivered"?"ring-2 ring-primary":"","border-l-emerald-400"),onClick:()=>A(d==="Delivered"?"all":"Delivered"),children:e.jsx(T,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-medium text-muted-foreground uppercase tracking-wide",children:"Delivered"}),e.jsx("p",{className:"text-xl font-bold mt-1",children:m.deliveredShipments})]}),e.jsx(F,{variant:"outline",className:ae("Delivered"),children:k("Delivered")})]})})})]}),e.jsxs(D,{children:[e.jsx(z,{className:"pb-4",children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx(G,{className:"text-xl",children:"Shipment Tracking"}),e.jsx(Es,{className:"mt-1",children:"Track and manage all shipments and deliveries"})]}),e.jsx("div",{className:"flex gap-2",children:e.jsxs(ve,{open:H,onOpenChange:s=>{q(s),s||je()},children:[e.jsx(He,{asChild:!0,children:e.jsxs(p,{onClick:()=>je(),disabled:!v,title:v?void 0:"You don't have permission to add shipments",children:[e.jsx(tt,{className:"h-4 w-4 mr-2"}),"Add Shipment"]})}),e.jsxs(Se,{className:"sm:max-w-[500px]",children:[e.jsxs(Ne,{children:[e.jsx(ye,{children:"Create New Shipment"}),e.jsx(be,{children:"Enter the details for the new shipment."})]}),e.jsxs("div",{className:"grid gap-4 py-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(u,{htmlFor:"salesOrderId",children:"Sales Order ID *"}),e.jsx(y,{id:"salesOrderId",placeholder:"SO-001",value:r.salesOrderId,onChange:s=>j({...r,salesOrderId:s.target.value})})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(u,{htmlFor:"status",children:"Status"}),e.jsxs(J,{value:r.status,onValueChange:s=>j({...r,status:s}),children:[e.jsx(W,{children:e.jsx(Y,{placeholder:"Select status"})}),e.jsx(_,{children:De.map(s=>e.jsx(M,{value:s,children:e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx("span",{children:k(s)}),s]})},s))})]})]})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(u,{htmlFor:"destination",children:"Destination *"}),e.jsx(y,{id:"destination",placeholder:"City, Province/State",value:r.destination,onChange:s=>j({...r,destination:s.target.value})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(u,{htmlFor:"carrier",children:"Carrier *"}),e.jsxs(J,{value:r.carrier,onValueChange:s=>j({...r,carrier:s}),children:[e.jsx(W,{children:e.jsx(Y,{placeholder:"Select carrier"})}),e.jsx(_,{children:We.map(s=>e.jsx(M,{value:s,children:s},s))})]})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(u,{htmlFor:"eta",children:"ETA *"}),e.jsx(y,{id:"eta",type:"date",value:r.eta,onChange:s=>j({...r,eta:s.target.value})})]})]})]}),e.jsxs(qe,{children:[e.jsx(p,{variant:"outline",onClick:()=>q(!1),children:"Cancel"}),e.jsx(p,{onClick:us,children:"Create Shipment"})]})]})]})})]})}),e.jsxs(T,{children:[e.jsxs("div",{className:"mb-6 space-y-4",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(Bs,{className:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground"}),e.jsx(y,{placeholder:"Search by ID, order ID, destination, or carrier...",value:w,onChange:s=>P(s.target.value),className:"pl-9"})]}),e.jsxs(J,{value:d,onValueChange:A,children:[e.jsxs(W,{className:"w-full sm:w-[180px]",children:[e.jsx(qs,{className:"h-4 w-4 mr-2"}),e.jsx(Y,{placeholder:"Filter by status"})]}),e.jsxs(_,{children:[e.jsx(M,{value:"all",children:"All Statuses"}),De.map(s=>e.jsx(M,{value:s,children:e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx("span",{children:k(s)}),s]})},s))]})]})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-4",children:[e.jsx(lt,{fromDate:h,toDate:x,onFromDateChange:ne,onToDateChange:de,onClear:Re,label:"Filter by ETA Date"}),e.jsxs(p,{variant:E?"default":"outline",size:"sm",onClick:()=>Te(!E),className:"gap-1",children:[e.jsx(_s,{className:K("h-4 w-4",E&&"fill-current")}),"Favorites",X("shipments").length>0&&e.jsx(F,{variant:"secondary",className:"ml-1 h-5 px-1.5",children:X("shipments").length})]}),(w||d!=="all"||h||x||E)&&e.jsxs(p,{variant:"ghost",size:"sm",onClick:ms,className:"text-muted-foreground hover:text-foreground",children:[e.jsx(ie,{className:"h-4 w-4 mr-1"}),"Clear All"]})]}),(d!=="all"||h||x)&&e.jsxs("div",{className:"flex flex-wrap gap-2",children:[d!=="all"&&e.jsxs(F,{variant:"secondary",className:"gap-1",children:["Status: ",d,e.jsx("button",{onClick:()=>A("all"),className:"ml-1 hover:bg-secondary-foreground/20 rounded-full p-0.5",children:e.jsx(ie,{className:"h-3 w-3"})})]}),(h||x)&&e.jsxs(F,{variant:"secondary",className:"gap-1",children:["ETA: ",h||"..."," to ",x||"...",e.jsx("button",{onClick:Re,className:"ml-1 hover:bg-secondary-foreground/20 rounded-full p-0.5",children:e.jsx(ie,{className:"h-3 w-3"})})]})]})]}),he&&v&&e.jsx(zs,{selectionCount:ue,onClearSelection:S,isLoading:se||cs,actions:[{id:"delete",label:"Delete",icon:e.jsx(Ce,{className:"h-4 w-4 mr-1"}),variant:"destructive",onClick:()=>te(!0)}],actionGroups:[{id:"status-update",label:"Update Status",icon:e.jsx(Ls,{className:"h-4 w-4 mr-1"}),options:[{value:"Pending",label:"Pending"},{value:"Processing",label:"Processing"},{value:"In Transit",label:"In Transit"},{value:"Delivered",label:"Delivered"}],onSelect:s=>gs(s)}],className:"mb-4"}),e.jsx(ve,{open:os,onOpenChange:te,children:e.jsxs(Se,{className:"max-w-md",children:[e.jsxs(Ne,{children:[e.jsxs(ye,{className:"flex items-center gap-2",children:[e.jsx(at,{className:"h-5 w-5 text-destructive"}),"Delete ",ue," Shipment",ue!==1?"s":""]}),e.jsx(be,{children:"Are you sure you want to delete the selected shipments?"})]}),re.length>0&&e.jsx("div",{className:"max-h-32 overflow-y-auto border rounded-md p-2 bg-muted/50",children:e.jsxs("ul",{className:"text-sm space-y-1",children:[re.slice(0,10).map((s,t)=>e.jsxs("li",{className:"truncate",children:["â€¢ ",s]},t)),re.length>10&&e.jsxs("li",{className:"text-muted-foreground",children:["...and ",re.length-10," more"]})]})}),e.jsxs("div",{className:"space-y-4 pt-2",children:[e.jsx("div",{className:"p-3 border border-destructive/50 rounded-md bg-destructive/10",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(Ce,{className:"h-4 w-4 mt-0.5 text-destructive"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-destructive",children:"Delete Shipments"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"This action cannot be undone. Selected shipments will be permanently removed."})]})]})}),e.jsxs("div",{className:"flex gap-2 justify-end",children:[e.jsx(p,{variant:"outline",onClick:()=>te(!1),disabled:se,children:"Cancel"}),e.jsx(p,{variant:"destructive",onClick:js,disabled:se,children:se?"Deleting...":"Delete All"})]})]})]})}),Qe?e.jsx(Gs,{rows:8}):me.length===0?e.jsx(Js,{icon:Ve,title:"No shipments found",description:w||d!=="all"||h||x?"Try adjusting your search or filters":"Get started by creating your first shipment",actionLabel:w||d!=="all"||h||x?void 0:"Create Shipment",onAction:w||d!=="all"||h||x?void 0:()=>q(!0)}):e.jsxs("div",{className:"rounded-md border overflow-hidden",children:[e.jsx(Ws,{pageItemCount:$e,totalItemCount:Le,isAllPagesSelected:rs,show:as&&Le>$e,onSelectAllPages:ns,onClearSelection:S,itemLabel:"shipments"}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(Ms,{children:[e.jsx(Rs,{children:e.jsxs(Ge,{children:[e.jsx(Je,{className:"w-12",children:e.jsx(ze,{checked:ts,ref:s=>{s&&(s.indeterminate=ls)},onCheckedChange:xe,"aria-label":"Select all shipments"})}),e.jsx(R,{sortKey:"id",currentSortKey:B.key,sortDirection:$("id"),onSort:s=>L(s),children:"Shipment ID"}),e.jsx(R,{sortKey:"salesOrderId",currentSortKey:B.key,sortDirection:$("salesOrderId"),onSort:s=>L(s),children:"Sales Order ID"}),e.jsx(R,{sortKey:"destination",currentSortKey:B.key,sortDirection:$("destination"),onSort:s=>L(s),children:"Destination"}),e.jsx(R,{sortKey:"carrier",currentSortKey:B.key,sortDirection:$("carrier"),onSort:s=>L(s),children:"Carrier"}),e.jsx(R,{sortKey:"status",currentSortKey:B.key,sortDirection:$("status"),onSort:s=>L(s),children:"Status"}),e.jsx(R,{sortKey:"eta",currentSortKey:B.key,sortDirection:$("eta"),onSort:s=>L(s),children:"ETA"}),e.jsx(Je,{children:"Actions"})]})}),e.jsx(Us,{children:Ee.map(s=>{const t=ds(s.id);return e.jsxs(Ge,{className:K("transition-colors hover:bg-muted/50",t&&"bg-primary/5 hover:bg-primary/10"),children:[e.jsx(I,{children:e.jsx(ze,{checked:t,onCheckedChange:()=>is(s.id),"aria-label":`Select shipment ${s.id}`})}),e.jsx(I,{children:e.jsx("span",{className:"font-mono text-sm font-medium",children:s.id})}),e.jsx(I,{children:e.jsx(we,{value:s.salesOrderId,type:"text",onSave:a=>ge(s.id,"salesOrderId",a),disabled:!v})}),e.jsx(I,{children:e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx(rt,{className:"h-3.5 w-3.5 text-muted-foreground"}),e.jsx(we,{value:s.destination,type:"text",onSave:a=>ge(s.id,"destination",a),disabled:!v})]})}),e.jsx(I,{children:e.jsx(we,{value:s.carrier,type:"text",onSave:a=>ge(s.id,"carrier",a),disabled:!v})}),e.jsx(I,{children:e.jsxs(F,{variant:"outline",className:K("font-medium",ae(s.status)),children:[e.jsx("span",{className:"mr-1",children:k(s.status)}),s.status]})}),e.jsx(I,{children:e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx(Ye,{className:"h-3.5 w-3.5 text-muted-foreground"}),e.jsx("span",{className:"text-sm",children:new Date(s.eta).toLocaleDateString()})]})}),e.jsx(I,{children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Qs,{entityType:"shipments",entityId:s.id,entityName:`${s.id} - ${s.destination}`}),e.jsxs(ve,{open:ce===s.id,onOpenChange:a=>{Z(a?s.id:null),a&&j({...s})},children:[e.jsx(He,{asChild:!0,children:e.jsx(p,{variant:"ghost",size:"sm",disabled:!v,title:v?void 0:"You don't have permission to edit shipments",children:"View / Edit"})}),e.jsxs(Se,{className:"sm:max-w-[500px]",children:[e.jsxs(Ne,{children:[e.jsx(ye,{children:"Edit Shipment"}),e.jsxs(be,{children:["Shipment ID: ",s.id]})]}),e.jsxs("div",{className:"grid gap-4 py-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(u,{htmlFor:"edit-salesOrderId",children:"Sales Order ID *"}),e.jsx(y,{id:"edit-salesOrderId",value:r.salesOrderId,onChange:a=>j({...r,salesOrderId:a.target.value})})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(u,{htmlFor:"edit-status",children:"Status"}),e.jsxs(J,{value:r.status,onValueChange:a=>j({...r,status:a}),children:[e.jsx(W,{children:e.jsx(Y,{placeholder:"Select status"})}),e.jsx(_,{children:De.map(a=>e.jsx(M,{value:a,children:e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx("span",{children:k(a)}),a]})},a))})]})]})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(u,{htmlFor:"edit-destination",children:"Destination *"}),e.jsx(y,{id:"edit-destination",value:r.destination,onChange:a=>j({...r,destination:a.target.value})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(u,{htmlFor:"edit-carrier",children:"Carrier *"}),e.jsxs(J,{value:r.carrier,onValueChange:a=>j({...r,carrier:a}),children:[e.jsx(W,{children:e.jsx(Y,{placeholder:"Select carrier"})}),e.jsx(_,{children:We.map(a=>e.jsx(M,{value:a,children:a},a))})]})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(u,{htmlFor:"edit-eta",children:"ETA *"}),e.jsx(y,{id:"edit-eta",type:"date",value:r.eta,onChange:a=>j({...r,eta:a.target.value})})]})]})]}),e.jsxs(qe,{className:"flex-col sm:flex-row gap-2",children:[e.jsxs(p,{variant:"destructive",onClick:()=>xs(s.id),className:"sm:mr-auto",children:[e.jsx(Ce,{className:"h-4 w-4 mr-2"}),"Delete"]}),e.jsx(p,{variant:"outline",onClick:()=>Z(null),children:"Cancel"}),e.jsx(p,{onClick:hs,children:"Save Changes"})]})]})]})]})})]},s.id)})})]})}),me.length>0&&e.jsx(Ys,{currentPage:Ae,totalPages:Xe,onPageChange:Ze,itemsPerPage:ss,totalItems:es})]})]})]})]})}export{bt as ShipmentsView};
