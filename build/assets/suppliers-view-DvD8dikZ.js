import{F as As,i as Ps,r as i,G as Ds,ad as Is,l as Fs,ae as Ts,az as Re,J as n,aA as Bs,aB as Os,aC as Es,aD as $s,aE as Ls,j as e,C as P,m as W,n as Y,U as ge,o as D,S as Me,P as He,d as _,t as E,s as Us,D as je,X as ze,B as p,v as fe,w as ve,x as ye,y as Ne,L as f,I as S,z as Se,a2 as Vs,Z as Ks,Y as Rs,a9 as Ms,_ as qe,aF as Ge,aG as Hs,aH as zs,aI as qs}from"./index-COID8RjX.js";import{S as X,a as J,b as Z,c as Q,d as $,T as We,e as Gs,f as Ws,g as Ye,h as _e,i as ee,j as Ys,k as I}from"./sortable-table-head-Vj5DDxGm.js";import{u as _s,a as Xs,P as Js,F as Zs,B as Qs,b as et,T as st,E as tt,d as Ce,c as at}from"./editable-cell-0UhmvLJy.js";import{S as rt,F as lt}from"./save-search-dialog-Cj_ww80b.js";import{u as it}from"./useTableSort-1uE1wM5w.js";import{c as nt,i as ct}from"./permissions-BqDqHH54.js";import{C as Xe}from"./circle-check-big-gQwReXB2.js";import{S as dt}from"./star-BZEUoxcL.js";import{A as se,a as Je}from"./archive-DMuyAZB9.js";import{P as Ze}from"./phone-DlCI8i08.js";import{B as Qe,H as ot,T as ut,S as mt}from"./tag-Cs3ZTGM7.js";import{T as ht}from"./skeleton-DKjVMZ39.js";const be=["Active","Inactive"],we=["Electronics","Furniture","Clothing","Food","Other"];function kt({initialOpenDialog:ke,onDialogOpened:Ae,initialSupplierId:te,onSupplierDialogOpened:Pe}){const{isFavorite:De,getFavoritesByType:Ie}=As(),{user:ae}=Ps(),N=ae?nt(ae.role):!1,Fe=ae?ct(ae.role):!1,[w,re]=i.useState(""),[j,L]=i.useState("all"),[C,le]=i.useState(!1),[d,Te]=i.useState(!1),[U,g]=i.useState(null),[V,es]=i.useState([]),[ie,ss]=i.useState([]),[ts,Be]=i.useState(!0),[K,R]=i.useState(!1),[ne,F]=i.useState(null),[ce,M]=i.useState(null),[r,m]=i.useState({id:"",name:"",contact:"",email:"",phone:"",category:"",status:"Active"}),de=Ds(w,300);i.useEffect(()=>{(async()=>{Be(!0);const[s,t,a]=await Promise.all([Is(),Fs(),Ts()]);g(s),es(t),ss(a),Be(!1)})()},[]),i.useEffect(()=>{ke&&!K&&(R(!0),Ae?.())},[ke,Ae,K]),i.useEffect(()=>{te&&U&&U.find(t=>t.id===te)&&(M(te),Pe?.())},[te,U,Pe]);const v=i.useMemo(()=>U??[],[U]),h=i.useMemo(()=>{const s=v.length,t=v.filter(c=>c.status==="Active").length,a=v.filter(c=>c.status==="Inactive").length,l=new Set(v.map(c=>c.category)).size,o=V.length,O=V.reduce((c,u)=>(c[u.supplierId]=(c[u.supplierId]||0)+1,c),{});let G=null;if(Object.keys(O).length>0){const c=Object.entries(O).sort((A,pe)=>pe[1]-A[1])[0],u=v.find(A=>A.id===c[0]);u&&(G={id:u.id,name:u.name,count:c[1]})}const Ve=V.reduce((c,u)=>(c[u.supplierId]=(c[u.supplierId]||0)+u.totalAmount,c),{});let Ke=null;if(Object.keys(Ve).length>0){const c=Object.entries(Ve).sort((A,pe)=>pe[1]-A[1])[0],u=v.find(A=>A.id===c[0]);u&&(Ke={id:u.id,name:u.name,value:c[1]})}const ws=ie.reduce((c,u)=>(u.supplierId&&(c[u.supplierId]=(c[u.supplierId]||0)+1),c),{}),ks=Object.keys(ws).length;return{totalSuppliers:s,activeSuppliers:t,inactiveSuppliers:a,uniqueCategories:l,totalPurchaseOrders:o,topSupplierByPO:G,topSupplierByValue:Ke,suppliersWithProducts:ks}},[v,V,ie]),oe=i.useMemo(()=>v.filter(s=>{if(s.archived!==d||C&&!De("suppliers",s.id)||j!=="all"&&s.status!==j)return!1;if(de){const t=de.toLowerCase();if(!(s.name.toLowerCase().includes(t)||s.id.toLowerCase().includes(t)||s.category.toLowerCase().includes(t)||s.contact.toLowerCase().includes(t)||s.email.toLowerCase().includes(t)))return!1}return!0}),[v,de,j,C,De,d]),as=i.useCallback(s=>{s.searchTerm&&re(s.searchTerm),s.filters.status&&L(s.filters.status),s.filters.favoritesOnly==="true"&&le(!0)},[]),rs=i.useMemo(()=>{const s={};return j!=="all"&&(s.status=j),C&&(s.favoritesOnly="true"),s},[j,C]);function ls(){re(""),L("all"),le(!1),Te(!1)}async function is(s){try{const t=await qs(s);g(a=>(a??[]).map(l=>l.id===s?t:l)),F(null),n.success("Supplier archived successfully")}catch(t){n.error(t?.message||"Failed to archive supplier")}}async function ns(s){try{const t=await Hs(s);g(a=>(a??[]).map(l=>l.id===s?t:l)),F(null),n.success("Supplier restored successfully")}catch(t){n.error(t?.message||"Failed to restore supplier")}}async function cs(s){try{await zs(s),g(t=>(t??[]).filter(a=>a.id!==s)),F(null),n.success("Supplier permanently deleted")}catch(t){n.error(t?.message||"Failed to permanently delete supplier")}}const T=s=>{switch(s){case"Active":return"✓";case"Inactive":return"○";default:return"○"}},ue=s=>{switch(s){case"Active":return"bg-emerald-500/15 text-emerald-700 dark:text-emerald-400 border-emerald-200";case"Inactive":return"bg-slate-500/15 text-slate-700 dark:text-slate-400 border-slate-200";default:return"bg-slate-500/15 text-slate-700 dark:text-slate-400 border-slate-200"}},{sortedData:ds,sortConfig:H,requestSort:z,getSortDirection:q}=it(oe),{currentPage:Oe,totalPages:os,paginatedData:Ee,goToPage:us,totalItems:ms,itemsPerPage:hs}=_s(ds,25),{selectedIds:y,selectedItems:$e,selectionCount:B,isAllSelected:xs,isPartiallySelected:ps,hasSelection:me,toggleItem:gs,toggleAll:he,deselectAll:x,isSelected:js}=Xs(Ee),[Le,b]=i.useState(!1),[fs,Ue]=i.useState(!1),[vs,k]=i.useState(!1);i.useEffect(()=>{x()},[Oe,x]),i.useEffect(()=>{const s=t=>{(t.metaKey||t.ctrlKey)&&t.key==="a"&&!K&&!ne&&(t.preventDefault(),he()),t.key==="Escape"&&me&&x()};return window.addEventListener("keydown",s),()=>window.removeEventListener("keydown",s)},[he,x,me,K,ne]);const xe=i.useCallback(async(s,t,a)=>{try{const l={[t]:a},o=await Re({id:s,...l});g(O=>(O??[]).map(G=>G.id===s?o:G)),n.success(`${t.charAt(0).toUpperCase()+t.slice(1)} updated`)}catch(l){throw n.error(l?.message||"Failed to update"),l}},[g]);i.useCallback(async()=>{b(!0);try{const s=Array.from(y),t=await Bs(s);g(a=>a?.filter(l=>!s.includes(l.id))??[]),t.failedCount>0?n.warning(`Deleted ${t.successCount} suppliers. ${t.failedCount} failed.`):n.success(`Successfully deleted ${t.successCount} supplier${t.successCount!==1?"s":""}`),x()}catch(s){n.error(s?.message||"Failed to delete suppliers")}finally{b(!1),k(!1)}},[y,x]);const ys=i.useCallback(async()=>{b(!0);try{const s=Array.from(y),t=await Os(s);g(a=>a&&a.map(l=>s.includes(l.id)?{...l,archived:!0,archivedAt:new Date().toISOString()}:l)),t.failedCount>0?n.warning(`Archived ${t.successCount} suppliers. ${t.failedCount} failed.`):n.success(`Successfully archived ${t.successCount} supplier${t.successCount!==1?"s":""}`),x()}catch(s){n.error(s?.message||"Failed to archive suppliers")}finally{b(!1),k(!1)}},[y,x]),Ns=i.useCallback(async()=>{b(!0);try{const s=Array.from(y),t=await Es(s);g(a=>a&&a.map(l=>s.includes(l.id)?{...l,archived:!1,archivedAt:void 0}:l)),t.failedCount>0?n.warning(`Restored ${t.successCount} suppliers. ${t.failedCount} failed.`):n.success(`Successfully restored ${t.successCount} supplier${t.successCount!==1?"s":""}`),x()}catch(s){n.error(s?.message||"Failed to restore suppliers")}finally{b(!1),k(!1)}},[y,x]),Ss=i.useCallback(async()=>{b(!0);try{const s=Array.from(y),t=await $s(s);g(a=>a?.filter(l=>!s.includes(l.id))??[]),t.failedCount>0?n.warning(`Permanently deleted ${t.successCount} suppliers. ${t.failedCount} failed.`):n.success(`Permanently deleted ${t.successCount} supplier${t.successCount!==1?"s":""}`),x()}catch(s){n.error(s?.message||"Failed to permanently delete suppliers")}finally{b(!1),k(!1)}},[y,x]),Cs=i.useCallback(async s=>{Ue(!0);try{const t=Array.from(y),a=await Ls(t,s);g(l=>l&&l.map(o=>t.includes(o.id)?{...o,status:s}:o)),a.failedCount>0?n.warning(`Updated ${a.successCount} suppliers. ${a.failedCount} failed.`):n.success(`Successfully updated ${a.successCount} supplier${a.successCount!==1?"s":""}`),x()}catch(t){n.error(t?.message||"Failed to update suppliers")}finally{Ue(!1)}},[y,x]),bs=i.useMemo(()=>$e.map(s=>s.name),[$e]);return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:[e.jsxs(P,{className:"relative overflow-hidden",children:[e.jsxs(W,{className:"flex flex-row items-center justify-between pb-2",children:[e.jsx(Y,{className:"text-sm font-medium text-muted-foreground",children:"Total Suppliers"}),e.jsx(ge,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(D,{children:[e.jsx("div",{className:"text-2xl font-bold",children:h.totalSuppliers}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:[h.activeSuppliers," active, ",h.inactiveSuppliers," inactive"]})]})]}),e.jsxs(P,{className:"relative overflow-hidden",children:[e.jsxs(W,{className:"flex flex-row items-center justify-between pb-2",children:[e.jsx(Y,{className:"text-sm font-medium text-muted-foreground",children:"Active Suppliers"}),e.jsx(Xe,{className:"h-4 w-4 text-emerald-600"})]}),e.jsxs(D,{children:[e.jsx("div",{className:"text-2xl font-bold text-emerald-600",children:h.activeSuppliers}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:h.totalSuppliers>0?`${Math.round(h.activeSuppliers/h.totalSuppliers*100)}% of total`:"No suppliers yet"})]})]}),e.jsxs(P,{className:"relative overflow-hidden",children:[e.jsxs(W,{className:"flex flex-row items-center justify-between pb-2",children:[e.jsx(Y,{className:"text-sm font-medium text-muted-foreground",children:"Total Purchase Orders"}),e.jsx(Me,{className:"h-4 w-4 text-blue-600"})]}),e.jsxs(D,{children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:h.totalPurchaseOrders}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:h.topSupplierByPO?`Top: ${h.topSupplierByPO.name} (${h.topSupplierByPO.count})`:"No orders yet"})]})]}),e.jsxs(P,{className:"relative overflow-hidden",children:[e.jsxs(W,{className:"flex flex-row items-center justify-between pb-2",children:[e.jsx(Y,{className:"text-sm font-medium text-muted-foreground",children:"Categories"}),e.jsx(He,{className:"h-4 w-4 text-purple-600"})]}),e.jsxs(D,{children:[e.jsx("div",{className:"text-2xl font-bold text-purple-600",children:h.uniqueCategories}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:[h.suppliersWithProducts," suppliers with products"]})]})]})]}),e.jsxs("div",{className:"grid gap-3 grid-cols-1 sm:grid-cols-2",children:[e.jsx(P,{className:_("cursor-pointer transition-all hover:shadow-md border-l-4",j==="Active"?"ring-2 ring-primary":"","border-l-emerald-400"),onClick:()=>L(j==="Active"?"all":"Active"),children:e.jsx(D,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-medium text-muted-foreground uppercase tracking-wide",children:"Active"}),e.jsx("p",{className:"text-xl font-bold mt-1",children:h.activeSuppliers})]}),e.jsx(E,{variant:"outline",className:ue("Active"),children:T("Active")})]})})}),e.jsx(P,{className:_("cursor-pointer transition-all hover:shadow-md border-l-4",j==="Inactive"?"ring-2 ring-primary":"","border-l-slate-400"),onClick:()=>L(j==="Inactive"?"all":"Inactive"),children:e.jsx(D,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-medium text-muted-foreground uppercase tracking-wide",children:"Inactive"}),e.jsx("p",{className:"text-xl font-bold mt-1",children:h.inactiveSuppliers})]}),e.jsx(E,{variant:"outline",className:ue("Inactive"),children:T("Inactive")})]})})})]}),e.jsxs(P,{children:[e.jsx(W,{className:"pb-4",children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx(Y,{className:"text-xl",children:"Supplier Management"}),e.jsx(Us,{className:"mt-1",children:"Manage your supplier relationships and contacts"})]}),e.jsx("div",{className:"flex gap-2",children:e.jsxs(je,{open:K,onOpenChange:s=>{R(s),s||m({id:"",name:"",contact:"",email:"",phone:"",category:"",status:"Active"})},children:[e.jsx(ze,{asChild:!0,children:e.jsxs(p,{onClick:()=>m({id:"",name:"",contact:"",email:"",phone:"",category:"",status:"Active"}),disabled:!N,title:N?void 0:"You don't have permission to add suppliers",children:[e.jsx(Js,{className:"h-4 w-4 mr-2"}),"Add Supplier"]})}),e.jsxs(fe,{className:"sm:max-w-[500px]",children:[e.jsxs(ve,{children:[e.jsx(ye,{children:"Create New Supplier"}),e.jsx(Ne,{children:"Enter the details for the new supplier."})]}),e.jsxs("div",{className:"grid gap-4 py-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(f,{htmlFor:"supplier-name",children:"Company Name *"}),e.jsx(S,{id:"supplier-name",placeholder:"Enter company name",value:r.name,onChange:s=>m({...r,name:s.target.value})})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(f,{htmlFor:"supplier-status",children:"Status"}),e.jsxs(X,{value:r.status,onValueChange:s=>m({...r,status:s}),children:[e.jsx(J,{children:e.jsx(Z,{placeholder:"Select status"})}),e.jsx(Q,{children:be.map(s=>e.jsx($,{value:s,children:e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx("span",{children:T(s)}),s]})},s))})]})]})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(f,{htmlFor:"contact-name",children:"Contact Person *"}),e.jsx(S,{id:"contact-name",placeholder:"Enter contact name",value:r.contact,onChange:s=>m({...r,contact:s.target.value})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(f,{htmlFor:"email",children:"Email *"}),e.jsx(S,{id:"email",type:"email",placeholder:"email@example.com",value:r.email,onChange:s=>m({...r,email:s.target.value})})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(f,{htmlFor:"phone",children:"Phone *"}),e.jsx(S,{id:"phone",placeholder:"+1 (555) 000-0000",value:r.phone,onChange:s=>m({...r,phone:s.target.value})})]})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(f,{htmlFor:"category",children:"Category *"}),e.jsxs(X,{value:r.category,onValueChange:s=>m({...r,category:s}),children:[e.jsx(J,{children:e.jsx(Z,{placeholder:"Select category"})}),e.jsx(Q,{children:we.map(s=>e.jsx($,{value:s,children:s},s))})]})]})]}),e.jsxs(Se,{children:[e.jsx(p,{variant:"outline",onClick:()=>R(!1),children:"Cancel"}),e.jsx(p,{onClick:async()=>{if(!r.name.trim()||!r.contact.trim()||!r.email.trim()||!r.phone.trim()||!r.category.trim()){n.error("Please fill all required fields");return}try{const s=await Vs({name:r.name,contact:r.contact,email:r.email,phone:r.phone,category:r.category,status:r.status});g(t=>[s,...t??[]]),R(!1),n.success("Supplier added successfully"),m({id:"",name:"",contact:"",email:"",phone:"",category:"",status:"Active"})}catch(s){n.error(s?.message||"Failed to add supplier")}},children:"Create Supplier"})]})]})]})})]})}),e.jsxs(D,{children:[e.jsxs("div",{className:"mb-6 space-y-4",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(Ks,{className:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground"}),e.jsx(S,{placeholder:"Search suppliers by name, contact, email...",value:w,onChange:s=>re(s.target.value),className:"pl-9"})]}),e.jsxs(X,{value:j,onValueChange:L,children:[e.jsxs(J,{className:"w-full sm:w-[180px]",children:[e.jsx(Zs,{className:"h-4 w-4 mr-2"}),e.jsx(Z,{placeholder:"Filter by status"})]}),e.jsxs(Q,{children:[e.jsx($,{value:"all",children:"All Statuses"}),be.map(s=>e.jsx($,{value:s,children:e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx("span",{children:T(s)}),s]})},s))]})]})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-4",children:[e.jsxs(p,{variant:C?"default":"outline",size:"sm",onClick:()=>le(!C),className:"gap-1",children:[e.jsx(dt,{className:_("h-4 w-4",C&&"fill-current")}),"Favorites",Ie("suppliers").length>0&&e.jsx(E,{variant:"secondary",className:"ml-1 h-5 px-1.5",children:Ie("suppliers").length})]}),e.jsx(rt,{entityType:"suppliers",currentSearchTerm:w,currentFilters:rs,onApplySearch:as}),e.jsxs(p,{variant:d?"default":"outline",size:"sm",onClick:()=>Te(!d),className:d?"bg-orange-500 hover:bg-orange-600 text-white":"",children:[e.jsx(se,{className:"h-4 w-4 mr-1"}),d?"Viewing Archived":"View Archived"]}),(w||j!=="all"||C||d)&&e.jsxs(p,{variant:"ghost",size:"sm",onClick:ls,className:"gap-1 text-muted-foreground hover:text-foreground",children:[e.jsx(Rs,{className:"h-4 w-4"}),"Clear All Filters"]})]})]}),me&&N&&e.jsx(Qs,{selectionCount:B,onClearSelection:x,isLoading:Le||fs,actions:d?[{id:"restore",label:"Restore",icon:e.jsx(Je,{className:"h-4 w-4 mr-1"}),variant:"outline",onClick:Ns},...Fe?[{id:"permanent-delete",label:"Permanently Delete",icon:e.jsx(We,{className:"h-4 w-4 mr-1"}),variant:"destructive",onClick:()=>k(!0)}]:[]]:[{id:"archive",label:"Archive",icon:e.jsx(se,{className:"h-4 w-4 mr-1"}),variant:"outline",onClick:()=>k(!0)}],actionGroups:d?[]:[{id:"status-update",label:"Update Status",icon:e.jsx(Ms,{className:"h-4 w-4 mr-1"}),options:[{value:"Active",label:"Active"},{value:"Inactive",label:"Inactive"}],onSelect:s=>Cs(s)}],className:"mb-4"}),e.jsx(et,{open:vs,onOpenChange:k,itemCount:B,itemType:"supplier",itemNames:bs,onConfirm:d?Ss:ys,isLoading:Le,title:d?"Permanently Delete Suppliers":"Archive Suppliers",description:d?`Are you sure you want to permanently delete ${B} supplier${B!==1?"s":""}? This action cannot be undone.`:`Are you sure you want to archive ${B} supplier${B!==1?"s":""}? Archived suppliers can be restored later.`,confirmLabel:d?"Permanently Delete":"Archive"}),ts?e.jsx(st,{rows:8}):oe.length===0?e.jsx(tt,{icon:d?se:ge,title:d?"No archived suppliers":"No suppliers found",description:d?"Archived suppliers will appear here":w?"Try adjusting your search criteria":"Get started by adding your first supplier",actionLabel:!d&&!w?"Add Supplier":void 0,onAction:!d&&!w?()=>R(!0):void 0}):e.jsxs("div",{className:"rounded-md border",children:[e.jsxs(Gs,{children:[e.jsx(Ws,{children:e.jsxs(Ye,{children:[e.jsx(_e,{className:"w-12",children:e.jsx(qe,{checked:xs,ref:s=>{s&&(s.indeterminate=ps)},onCheckedChange:he,"aria-label":"Select all suppliers"})}),e.jsx(ee,{sortKey:"id",currentSortKey:H.key,sortDirection:q("id"),onSort:s=>z(s),children:"Supplier ID"}),e.jsx(ee,{sortKey:"name",currentSortKey:H.key,sortDirection:q("name"),onSort:s=>z(s),children:"Company Name"}),e.jsx(ee,{sortKey:"contact",currentSortKey:H.key,sortDirection:q("contact"),onSort:s=>z(s),children:"Contact"}),e.jsx(ee,{sortKey:"category",currentSortKey:H.key,sortDirection:q("category"),onSort:s=>z(s),children:"Category"}),e.jsx(ee,{sortKey:"status",currentSortKey:H.key,sortDirection:q("status"),onSort:s=>z(s),children:"Status"}),e.jsx(_e,{children:"Actions"})]})}),e.jsx(Ys,{children:Ee.map(s=>{const t=js(s.id);return e.jsxs(Ye,{className:_("hover:bg-muted/50 transition-colors",t&&"bg-muted/50"),children:[e.jsx(I,{children:e.jsx(qe,{checked:t,onCheckedChange:()=>gs(s.id),"aria-label":`Select supplier ${s.name}`})}),e.jsx(I,{className:"font-mono text-sm",children:s.id}),e.jsx(I,{children:e.jsx("button",{className:"text-left font-medium text-primary hover:underline cursor-pointer bg-transparent border-none p-0",onClick:()=>M(s.id),children:s.name})}),e.jsx(I,{children:e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center gap-1 text-sm",children:[e.jsx(Ge,{className:"h-3 w-3 text-muted-foreground"}),e.jsx(Ce,{value:s.email,type:"text",onSave:a=>xe(s.id,"email",a),disabled:!N,className:"text-xs text-muted-foreground"})]}),e.jsxs("div",{className:"flex items-center gap-1 text-sm",children:[e.jsx(Ze,{className:"h-3 w-3 text-muted-foreground"}),e.jsx(Ce,{value:s.phone,type:"text",onSave:a=>xe(s.id,"phone",a),disabled:!N,className:"text-xs text-muted-foreground"})]})]})}),e.jsx(I,{children:e.jsx(Ce,{value:s.category,type:"select",options:we.map(a=>({value:a,label:a})),onSave:a=>xe(s.id,"category",a),disabled:!N})}),e.jsx(I,{children:e.jsxs(E,{variant:"outline",className:_("gap-1",ue(s.status)),children:[e.jsx("span",{children:T(s.status)}),s.status]})}),e.jsx(I,{children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(lt,{entityType:"suppliers",entityId:s.id,entityName:s.name}),e.jsxs(je,{open:ne===s.id,onOpenChange:a=>{F(a?s.id:null),a&&m({...s})},children:[e.jsx(ze,{asChild:!0,children:e.jsx(p,{variant:"ghost",size:"sm",disabled:!N,title:N?void 0:"You don't have permission to edit suppliers",children:"Edit"})}),e.jsxs(fe,{className:"sm:max-w-[500px]",children:[e.jsxs(ve,{children:[e.jsx(ye,{children:"Edit Supplier"}),e.jsxs(Ne,{children:["Supplier ID: ",s.id]})]}),e.jsxs("div",{className:"grid gap-4 py-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(f,{htmlFor:"edit-name",children:"Company Name *"}),e.jsx(S,{id:"edit-name",value:r.name,onChange:a=>m({...r,name:a.target.value})})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(f,{htmlFor:"edit-status",children:"Status"}),e.jsxs(X,{value:r.status,onValueChange:a=>m({...r,status:a}),children:[e.jsx(J,{children:e.jsx(Z,{placeholder:"Select status"})}),e.jsx(Q,{children:be.map(a=>e.jsx($,{value:a,children:e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx("span",{children:T(a)}),a]})},a))})]})]})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(f,{htmlFor:"edit-contact",children:"Contact Person *"}),e.jsx(S,{id:"edit-contact",value:r.contact,onChange:a=>m({...r,contact:a.target.value})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(f,{htmlFor:"edit-email",children:"Email *"}),e.jsx(S,{id:"edit-email",type:"email",value:r.email,onChange:a=>m({...r,email:a.target.value})})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(f,{htmlFor:"edit-phone",children:"Phone *"}),e.jsx(S,{id:"edit-phone",value:r.phone,onChange:a=>m({...r,phone:a.target.value})})]})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(f,{htmlFor:"edit-category",children:"Category *"}),e.jsxs(X,{value:r.category,onValueChange:a=>m({...r,category:a}),children:[e.jsx(J,{children:e.jsx(Z,{placeholder:"Select category"})}),e.jsx(Q,{children:we.map(a=>e.jsx($,{value:a,children:a},a))})]})]})]}),e.jsxs(Se,{className:"flex-col-reverse sm:flex-row sm:justify-between sm:space-x-2",children:[s.archived?e.jsxs(e.Fragment,{children:[e.jsxs(p,{variant:"outline",onClick:()=>ns(s.id),children:[e.jsx(Je,{className:"h-4 w-4 mr-2"}),"Restore"]}),Fe&&e.jsxs(p,{variant:"destructive",onClick:()=>cs(s.id),children:[e.jsx(We,{className:"h-4 w-4 mr-2"}),"Permanently Delete"]})]}):e.jsxs(p,{variant:"outline",onClick:()=>is(s.id),className:"text-orange-600 border-orange-300 hover:bg-orange-50",children:[e.jsx(se,{className:"h-4 w-4 mr-2"}),"Archive"]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(p,{variant:"outline",onClick:()=>F(null),children:"Cancel"}),!s.archived&&e.jsx(p,{onClick:async()=>{if(!r.id){n.error("Missing supplier id");return}if(!r.name.trim()||!r.contact.trim()||!r.email.trim()||!r.phone.trim()||!r.category.trim()){n.error("Please fill all required fields");return}try{const a=await Re({id:r.id,name:r.name,contact:r.contact,email:r.email,phone:r.phone,category:r.category,status:r.status});g(l=>(l??[]).map(o=>o.id===a.id?a:o)),F(null),n.success("Supplier updated")}catch(a){n.error(a?.message||"Failed to update supplier")}},children:"Save Changes"})]})]})]})]})]})})]},s.id)})})]}),oe.length>0&&e.jsx(at,{currentPage:Oe,totalPages:os,onPageChange:us,itemsPerPage:hs,totalItems:ms})]})]})]}),e.jsx(je,{open:ce!==null,onOpenChange:s=>!s&&M(null),children:e.jsx(fe,{className:"sm:max-w-[600px]",children:ce&&(()=>{const s=v.find(o=>o.id===ce);if(!s)return null;const t=V.filter(o=>o.supplierId===s.id),a=t.reduce((o,O)=>o+O.totalAmount,0),l=ie.filter(o=>o.supplierId===s.id);return e.jsxs(e.Fragment,{children:[e.jsxs(ve,{children:[e.jsxs(ye,{className:"flex items-center gap-2",children:[e.jsx(Qe,{className:"h-5 w-5 text-primary"}),"Supplier Details"]}),e.jsx(Ne,{children:"View supplier information and statistics"})]}),e.jsxs("div",{className:"space-y-6 py-4",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx("h4",{className:"text-sm font-semibold text-muted-foreground uppercase tracking-wide",children:"Basic Information"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center gap-2 text-xs text-muted-foreground",children:[e.jsx(ot,{className:"h-3 w-3"}),"Supplier ID"]}),e.jsx("p",{className:"font-mono text-sm",children:s.id})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center gap-2 text-xs text-muted-foreground",children:[e.jsx(Qe,{className:"h-3 w-3"}),"Name"]}),e.jsx("p",{className:"font-medium",children:s.name})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center gap-2 text-xs text-muted-foreground",children:[e.jsx(ut,{className:"h-3 w-3"}),"Category"]}),e.jsx(E,{variant:"outline",children:s.category})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center gap-2 text-xs text-muted-foreground",children:[e.jsx(Xe,{className:"h-3 w-3"}),"Status"]}),e.jsx(E,{variant:s.status==="Active"?"default":"secondary",children:s.status})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h4",{className:"text-sm font-semibold text-muted-foreground uppercase tracking-wide",children:"Contact Information"}),e.jsxs("div",{className:"grid grid-cols-1 gap-3",children:[e.jsxs("div",{className:"flex items-center gap-3 p-3 rounded-lg bg-muted/30",children:[e.jsx(ge,{className:"h-4 w-4 text-muted-foreground"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Contact Person"}),e.jsx("p",{className:"font-medium",children:s.contact})]})]}),e.jsxs("div",{className:"flex items-center gap-3 p-3 rounded-lg bg-muted/30",children:[e.jsx(Ge,{className:"h-4 w-4 text-muted-foreground"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Email"}),e.jsx("p",{className:"font-medium",children:s.email})]})]}),e.jsxs("div",{className:"flex items-center gap-3 p-3 rounded-lg bg-muted/30",children:[e.jsx(Ze,{className:"h-4 w-4 text-muted-foreground"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Phone"}),e.jsx("p",{className:"font-medium",children:s.phone})]})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h4",{className:"text-sm font-semibold text-muted-foreground uppercase tracking-wide",children:"Statistics"}),e.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[e.jsxs("div",{className:"p-3 rounded-lg bg-blue-50 dark:bg-blue-950/30 text-center",children:[e.jsx(Me,{className:"h-4 w-4 mx-auto mb-1 text-blue-600"}),e.jsx("p",{className:"text-lg font-bold text-blue-600",children:t.length}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Purchase Orders"})]}),e.jsxs("div",{className:"p-3 rounded-lg bg-green-50 dark:bg-green-950/30 text-center",children:[e.jsx(ht,{className:"h-4 w-4 mx-auto mb-1 text-green-600"}),e.jsxs("p",{className:"text-lg font-bold text-green-600",children:["$",a.toLocaleString()]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Total Value"})]}),e.jsxs("div",{className:"p-3 rounded-lg bg-purple-50 dark:bg-purple-950/30 text-center",children:[e.jsx(He,{className:"h-4 w-4 mx-auto mb-1 text-purple-600"}),e.jsx("p",{className:"text-lg font-bold text-purple-600",children:l.length}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Products"})]})]})]}),s.archived&&e.jsxs("div",{className:"p-3 rounded-lg bg-orange-50 dark:bg-orange-950/30 border border-orange-200 dark:border-orange-800",children:[e.jsxs("div",{className:"flex items-center gap-2 text-orange-700 dark:text-orange-300",children:[e.jsx(se,{className:"h-4 w-4"}),e.jsx("span",{className:"font-medium",children:"Archived"})]}),s.archivedAt&&e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:["Archived on ",new Date(s.archivedAt).toLocaleDateString()]})]})]}),e.jsxs(Se,{children:[e.jsx(p,{variant:"outline",onClick:()=>M(null),children:"Close"}),N&&!s.archived&&e.jsxs(p,{onClick:()=>{M(null),handleEdit(s)},children:[e.jsx(mt,{className:"h-4 w-4 mr-2"}),"Edit Supplier"]})]})]})})()})})]})}export{kt as SuppliersView};
