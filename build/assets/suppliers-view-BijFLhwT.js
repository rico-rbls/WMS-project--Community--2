import{F as ws,i as ks,r as i,G as As,aj as Ps,l as Ds,ak as Is,aF as Re,J as n,aG as Fs,aH as Ts,aI as Bs,aJ as Os,aK as Es,j as e,C as k,m as G,n as W,U as xe,o as A,S as Me,P as He,d as Y,t as E,s as $s,D as pe,X as qe,B as p,v as ge,w as je,x as fe,y as ve,L as j,I as S,z as ye,a8 as Ls,Z as Ks,Y as Us,af as Vs,a4 as ze,aL as Ge,aM as Rs,aN as Ms,aO as Hs}from"./index-DBUbOcI2.js";import{S as J,a as X,b as _,c as Z,d as $,T as We,e as qs,f as zs,g as Ye,h as Je,i as Q,j as Gs,k as P}from"./sortable-table-head-D6lIH5nx.js";import{u as Ws,a as Ys,P as Js,F as Xs,B as _s,b as Zs,T as Qs,E as et,d as Ne,c as st}from"./editable-cell-DpKhPm8P.js";import{F as tt}from"./favorite-button-CrEz7B-8.js";import{u as at}from"./useTableSort-Ct_QNtBN.js";import{c as rt,i as lt}from"./permissions-BqDqHH54.js";import{C as Xe}from"./circle-check-big-Wu-J-hRg.js";import{S as it}from"./star-BXfHBBAK.js";import{A as ee,a as _e}from"./archive-zJ_vQktB.js";import{P as Ze}from"./phone-bKG3mz2H.js";import{B as Qe,H as nt,T as ct,S as dt}from"./tag-VHpGevPw.js";import{T as ot}from"./skeleton-DjdjMeGg.js";const Se=["Active","Inactive"],Ce=["Electronics","Furniture","Clothing","Food","Other"];function Ct({initialOpenDialog:be,onDialogOpened:we,initialSupplierId:se,onSupplierDialogOpened:ke}){const{isFavorite:Ae,getFavoritesByType:Pe}=ws(),{user:te}=ks(),y=te?rt(te.role):!1,De=te?lt(te.role):!1,[D,Ie]=i.useState(""),[N,ae]=i.useState("all"),[I,Fe]=i.useState(!1),[d,Te]=i.useState(!1),[L,g]=i.useState(null),[K,es]=i.useState([]),[re,ss]=i.useState([]),[ts,Be]=i.useState(!0),[U,V]=i.useState(!1),[le,F]=i.useState(null),[ie,R]=i.useState(null),[r,m]=i.useState({id:"",name:"",contact:"",email:"",phone:"",category:"",status:"Active"}),ne=As(D,300);i.useEffect(()=>{(async()=>{Be(!0);const[s,t,a]=await Promise.all([Ps(),Ds(),Is()]);g(s),es(t),ss(a),Be(!1)})()},[]),i.useEffect(()=>{be&&!U&&(V(!0),we?.())},[be,we,U]),i.useEffect(()=>{se&&L&&L.find(t=>t.id===se)&&(R(se),ke?.())},[se,L,ke]);const f=i.useMemo(()=>L??[],[L]),h=i.useMemo(()=>{const s=f.length,t=f.filter(c=>c.status==="Active").length,a=f.filter(c=>c.status==="Inactive").length,l=new Set(f.map(c=>c.category)).size,o=K.length,O=K.reduce((c,u)=>(c[u.supplierId]=(c[u.supplierId]||0)+1,c),{});let z=null;if(Object.keys(O).length>0){const c=Object.entries(O).sort((w,he)=>he[1]-w[1])[0],u=f.find(w=>w.id===c[0]);u&&(z={id:u.id,name:u.name,count:c[1]})}const Ue=K.reduce((c,u)=>(c[u.supplierId]=(c[u.supplierId]||0)+u.totalAmount,c),{});let Ve=null;if(Object.keys(Ue).length>0){const c=Object.entries(Ue).sort((w,he)=>he[1]-w[1])[0],u=f.find(w=>w.id===c[0]);u&&(Ve={id:u.id,name:u.name,value:c[1]})}const Cs=re.reduce((c,u)=>(u.supplierId&&(c[u.supplierId]=(c[u.supplierId]||0)+1),c),{}),bs=Object.keys(Cs).length;return{totalSuppliers:s,activeSuppliers:t,inactiveSuppliers:a,uniqueCategories:l,totalPurchaseOrders:o,topSupplierByPO:z,topSupplierByValue:Ve,suppliersWithProducts:bs}},[f,K,re]),ce=i.useMemo(()=>f.filter(s=>{if(s.archived!==d||I&&!Ae("suppliers",s.id)||N!=="all"&&s.status!==N)return!1;if(ne){const t=ne.toLowerCase();if(!(s.name.toLowerCase().includes(t)||s.id.toLowerCase().includes(t)||s.category.toLowerCase().includes(t)||s.contact.toLowerCase().includes(t)||s.email.toLowerCase().includes(t)))return!1}return!0}),[f,ne,N,I,Ae,d]);function as(){Ie(""),ae("all"),Fe(!1),Te(!1)}async function rs(s){try{const t=await Hs(s);g(a=>(a??[]).map(l=>l.id===s?t:l)),F(null),n.success("Supplier archived successfully")}catch(t){n.error(t?.message||"Failed to archive supplier")}}async function ls(s){try{const t=await Rs(s);g(a=>(a??[]).map(l=>l.id===s?t:l)),F(null),n.success("Supplier restored successfully")}catch(t){n.error(t?.message||"Failed to restore supplier")}}async function is(s){try{await Ms(s),g(t=>(t??[]).filter(a=>a.id!==s)),F(null),n.success("Supplier permanently deleted")}catch(t){n.error(t?.message||"Failed to permanently delete supplier")}}const T=s=>{switch(s){case"Active":return"✓";case"Inactive":return"○";default:return"○"}},de=s=>{switch(s){case"Active":return"bg-emerald-500/15 text-emerald-700 dark:text-emerald-400 border-emerald-200";case"Inactive":return"bg-slate-500/15 text-slate-700 dark:text-slate-400 border-slate-200";default:return"bg-slate-500/15 text-slate-700 dark:text-slate-400 border-slate-200"}},{sortedData:ns,sortConfig:M,requestSort:H,getSortDirection:q}=at(ce),{currentPage:Oe,totalPages:cs,paginatedData:Ee,goToPage:ds,totalItems:os,itemsPerPage:us}=Ws(ns,25),{selectedIds:v,selectedItems:$e,selectionCount:B,isAllSelected:ms,isPartiallySelected:hs,hasSelection:oe,toggleItem:xs,toggleAll:ue,deselectAll:x,isSelected:ps}=Ys(Ee),[Le,C]=i.useState(!1),[gs,Ke]=i.useState(!1),[js,b]=i.useState(!1);i.useEffect(()=>{x()},[Oe,x]),i.useEffect(()=>{const s=t=>{(t.metaKey||t.ctrlKey)&&t.key==="a"&&!U&&!le&&(t.preventDefault(),ue()),t.key==="Escape"&&oe&&x()};return window.addEventListener("keydown",s),()=>window.removeEventListener("keydown",s)},[ue,x,oe,U,le]);const me=i.useCallback(async(s,t,a)=>{try{const l={[t]:a},o=await Re({id:s,...l});g(O=>(O??[]).map(z=>z.id===s?o:z)),n.success(`${t.charAt(0).toUpperCase()+t.slice(1)} updated`)}catch(l){throw n.error(l?.message||"Failed to update"),l}},[g]);i.useCallback(async()=>{C(!0);try{const s=Array.from(v),t=await Fs(s);g(a=>a?.filter(l=>!s.includes(l.id))??[]),t.failedCount>0?n.warning(`Deleted ${t.successCount} suppliers. ${t.failedCount} failed.`):n.success(`Successfully deleted ${t.successCount} supplier${t.successCount!==1?"s":""}`),x()}catch(s){n.error(s?.message||"Failed to delete suppliers")}finally{C(!1),b(!1)}},[v,x]);const fs=i.useCallback(async()=>{C(!0);try{const s=Array.from(v),t=await Ts(s);g(a=>a&&a.map(l=>s.includes(l.id)?{...l,archived:!0,archivedAt:new Date().toISOString()}:l)),t.failedCount>0?n.warning(`Archived ${t.successCount} suppliers. ${t.failedCount} failed.`):n.success(`Successfully archived ${t.successCount} supplier${t.successCount!==1?"s":""}`),x()}catch(s){n.error(s?.message||"Failed to archive suppliers")}finally{C(!1),b(!1)}},[v,x]),vs=i.useCallback(async()=>{C(!0);try{const s=Array.from(v),t=await Bs(s);g(a=>a&&a.map(l=>s.includes(l.id)?{...l,archived:!1,archivedAt:void 0}:l)),t.failedCount>0?n.warning(`Restored ${t.successCount} suppliers. ${t.failedCount} failed.`):n.success(`Successfully restored ${t.successCount} supplier${t.successCount!==1?"s":""}`),x()}catch(s){n.error(s?.message||"Failed to restore suppliers")}finally{C(!1),b(!1)}},[v,x]),ys=i.useCallback(async()=>{C(!0);try{const s=Array.from(v),t=await Os(s);g(a=>a?.filter(l=>!s.includes(l.id))??[]),t.failedCount>0?n.warning(`Permanently deleted ${t.successCount} suppliers. ${t.failedCount} failed.`):n.success(`Permanently deleted ${t.successCount} supplier${t.successCount!==1?"s":""}`),x()}catch(s){n.error(s?.message||"Failed to permanently delete suppliers")}finally{C(!1),b(!1)}},[v,x]),Ns=i.useCallback(async s=>{Ke(!0);try{const t=Array.from(v),a=await Es(t,s);g(l=>l&&l.map(o=>t.includes(o.id)?{...o,status:s}:o)),a.failedCount>0?n.warning(`Updated ${a.successCount} suppliers. ${a.failedCount} failed.`):n.success(`Successfully updated ${a.successCount} supplier${a.successCount!==1?"s":""}`),x()}catch(t){n.error(t?.message||"Failed to update suppliers")}finally{Ke(!1)}},[v,x]),Ss=i.useMemo(()=>$e.map(s=>s.name),[$e]);return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:[e.jsxs(k,{className:"relative overflow-hidden",children:[e.jsxs(G,{className:"flex flex-row items-center justify-between pb-2",children:[e.jsx(W,{className:"text-sm font-medium text-muted-foreground",children:"Total Suppliers"}),e.jsx(xe,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(A,{children:[e.jsx("div",{className:"text-2xl font-bold",children:h.totalSuppliers}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:[h.activeSuppliers," active, ",h.inactiveSuppliers," inactive"]})]})]}),e.jsxs(k,{className:"relative overflow-hidden",children:[e.jsxs(G,{className:"flex flex-row items-center justify-between pb-2",children:[e.jsx(W,{className:"text-sm font-medium text-muted-foreground",children:"Active Suppliers"}),e.jsx(Xe,{className:"h-4 w-4 text-emerald-600"})]}),e.jsxs(A,{children:[e.jsx("div",{className:"text-2xl font-bold text-emerald-600",children:h.activeSuppliers}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:h.totalSuppliers>0?`${Math.round(h.activeSuppliers/h.totalSuppliers*100)}% of total`:"No suppliers yet"})]})]}),e.jsxs(k,{className:"relative overflow-hidden",children:[e.jsxs(G,{className:"flex flex-row items-center justify-between pb-2",children:[e.jsx(W,{className:"text-sm font-medium text-muted-foreground",children:"Total Purchase Orders"}),e.jsx(Me,{className:"h-4 w-4 text-blue-600"})]}),e.jsxs(A,{children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:h.totalPurchaseOrders}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:h.topSupplierByPO?`Top: ${h.topSupplierByPO.name} (${h.topSupplierByPO.count})`:"No orders yet"})]})]}),e.jsxs(k,{className:"relative overflow-hidden",children:[e.jsxs(G,{className:"flex flex-row items-center justify-between pb-2",children:[e.jsx(W,{className:"text-sm font-medium text-muted-foreground",children:"Categories"}),e.jsx(He,{className:"h-4 w-4 text-purple-600"})]}),e.jsxs(A,{children:[e.jsx("div",{className:"text-2xl font-bold text-purple-600",children:h.uniqueCategories}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:[h.suppliersWithProducts," suppliers with products"]})]})]})]}),e.jsxs("div",{className:"grid gap-3 grid-cols-1 sm:grid-cols-2",children:[e.jsx(k,{className:Y("cursor-pointer transition-all hover:shadow-md border-l-4",N==="Active"?"ring-2 ring-primary":"","border-l-emerald-400"),onClick:()=>ae(N==="Active"?"all":"Active"),children:e.jsx(A,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-medium text-muted-foreground uppercase tracking-wide",children:"Active"}),e.jsx("p",{className:"text-xl font-bold mt-1",children:h.activeSuppliers})]}),e.jsx(E,{variant:"outline",className:de("Active"),children:T("Active")})]})})}),e.jsx(k,{className:Y("cursor-pointer transition-all hover:shadow-md border-l-4",N==="Inactive"?"ring-2 ring-primary":"","border-l-slate-400"),onClick:()=>ae(N==="Inactive"?"all":"Inactive"),children:e.jsx(A,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-medium text-muted-foreground uppercase tracking-wide",children:"Inactive"}),e.jsx("p",{className:"text-xl font-bold mt-1",children:h.inactiveSuppliers})]}),e.jsx(E,{variant:"outline",className:de("Inactive"),children:T("Inactive")})]})})})]}),e.jsxs(k,{children:[e.jsx(G,{className:"pb-4",children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx(W,{className:"text-xl",children:"Supplier Management"}),e.jsx($s,{className:"mt-1",children:"Manage your supplier relationships and contacts"})]}),e.jsx("div",{className:"flex gap-2",children:e.jsxs(pe,{open:U,onOpenChange:s=>{V(s),s||m({id:"",name:"",contact:"",email:"",phone:"",category:"",status:"Active"})},children:[e.jsx(qe,{asChild:!0,children:e.jsxs(p,{onClick:()=>m({id:"",name:"",contact:"",email:"",phone:"",category:"",status:"Active"}),disabled:!y,title:y?void 0:"You don't have permission to add suppliers",children:[e.jsx(Js,{className:"h-4 w-4 mr-2"}),"Add Supplier"]})}),e.jsxs(ge,{className:"sm:max-w-[500px]",children:[e.jsxs(je,{children:[e.jsx(fe,{children:"Create New Supplier"}),e.jsx(ve,{children:"Enter the details for the new supplier."})]}),e.jsxs("div",{className:"grid gap-4 py-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(j,{htmlFor:"supplier-name",children:"Company Name *"}),e.jsx(S,{id:"supplier-name",placeholder:"Enter company name",value:r.name,onChange:s=>m({...r,name:s.target.value})})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(j,{htmlFor:"supplier-status",children:"Status"}),e.jsxs(J,{value:r.status,onValueChange:s=>m({...r,status:s}),children:[e.jsx(X,{children:e.jsx(_,{placeholder:"Select status"})}),e.jsx(Z,{children:Se.map(s=>e.jsx($,{value:s,children:e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx("span",{children:T(s)}),s]})},s))})]})]})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(j,{htmlFor:"contact-name",children:"Contact Person *"}),e.jsx(S,{id:"contact-name",placeholder:"Enter contact name",value:r.contact,onChange:s=>m({...r,contact:s.target.value})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(j,{htmlFor:"email",children:"Email *"}),e.jsx(S,{id:"email",type:"email",placeholder:"email@example.com",value:r.email,onChange:s=>m({...r,email:s.target.value})})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(j,{htmlFor:"phone",children:"Phone *"}),e.jsx(S,{id:"phone",placeholder:"+1 (555) 000-0000",value:r.phone,onChange:s=>m({...r,phone:s.target.value})})]})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(j,{htmlFor:"category",children:"Category *"}),e.jsxs(J,{value:r.category,onValueChange:s=>m({...r,category:s}),children:[e.jsx(X,{children:e.jsx(_,{placeholder:"Select category"})}),e.jsx(Z,{children:Ce.map(s=>e.jsx($,{value:s,children:s},s))})]})]})]}),e.jsxs(ye,{children:[e.jsx(p,{variant:"outline",onClick:()=>V(!1),children:"Cancel"}),e.jsx(p,{onClick:async()=>{if(!r.name.trim()||!r.contact.trim()||!r.email.trim()||!r.phone.trim()||!r.category.trim()){n.error("Please fill all required fields");return}try{const s=await Ls({name:r.name,contact:r.contact,email:r.email,phone:r.phone,category:r.category,status:r.status});g(t=>[s,...t??[]]),V(!1),n.success("Supplier added successfully"),m({id:"",name:"",contact:"",email:"",phone:"",category:"",status:"Active"})}catch(s){n.error(s?.message||"Failed to add supplier")}},children:"Create Supplier"})]})]})]})})]})}),e.jsxs(A,{children:[e.jsxs("div",{className:"mb-6 space-y-4",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(Ks,{className:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground"}),e.jsx(S,{placeholder:"Search suppliers by name, contact, email...",value:D,onChange:s=>Ie(s.target.value),className:"pl-9"})]}),e.jsxs(J,{value:N,onValueChange:ae,children:[e.jsxs(X,{className:"w-full sm:w-[180px]",children:[e.jsx(Xs,{className:"h-4 w-4 mr-2"}),e.jsx(_,{placeholder:"Filter by status"})]}),e.jsxs(Z,{children:[e.jsx($,{value:"all",children:"All Statuses"}),Se.map(s=>e.jsx($,{value:s,children:e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx("span",{children:T(s)}),s]})},s))]})]})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-4",children:[e.jsxs(p,{variant:I?"default":"outline",size:"sm",onClick:()=>Fe(!I),className:"gap-1",children:[e.jsx(it,{className:Y("h-4 w-4",I&&"fill-current")}),"Favorites",Pe("suppliers").length>0&&e.jsx(E,{variant:"secondary",className:"ml-1 h-5 px-1.5",children:Pe("suppliers").length})]}),e.jsxs(p,{variant:d?"default":"outline",size:"sm",onClick:()=>Te(!d),className:d?"bg-orange-500 hover:bg-orange-600 text-white":"",children:[e.jsx(ee,{className:"h-4 w-4 mr-1"}),d?"Viewing Archived":"View Archived"]}),(D||N!=="all"||I||d)&&e.jsxs(p,{variant:"ghost",size:"sm",onClick:as,className:"gap-1 text-muted-foreground hover:text-foreground",children:[e.jsx(Us,{className:"h-4 w-4"}),"Clear All Filters"]})]})]}),oe&&y&&e.jsx(_s,{selectionCount:B,onClearSelection:x,isLoading:Le||gs,actions:d?[{id:"restore",label:"Restore",icon:e.jsx(_e,{className:"h-4 w-4 mr-1"}),variant:"outline",onClick:vs},...De?[{id:"permanent-delete",label:"Permanently Delete",icon:e.jsx(We,{className:"h-4 w-4 mr-1"}),variant:"destructive",onClick:()=>b(!0)}]:[]]:[{id:"archive",label:"Archive",icon:e.jsx(ee,{className:"h-4 w-4 mr-1"}),variant:"outline",onClick:()=>b(!0)}],actionGroups:d?[]:[{id:"status-update",label:"Update Status",icon:e.jsx(Vs,{className:"h-4 w-4 mr-1"}),options:[{value:"Active",label:"Active"},{value:"Inactive",label:"Inactive"}],onSelect:s=>Ns(s)}],className:"mb-4"}),e.jsx(Zs,{open:js,onOpenChange:b,itemCount:B,itemType:"supplier",itemNames:Ss,onConfirm:d?ys:fs,isLoading:Le,title:d?"Permanently Delete Suppliers":"Archive Suppliers",description:d?`Are you sure you want to permanently delete ${B} supplier${B!==1?"s":""}? This action cannot be undone.`:`Are you sure you want to archive ${B} supplier${B!==1?"s":""}? Archived suppliers can be restored later.`,confirmLabel:d?"Permanently Delete":"Archive"}),ts?e.jsx(Qs,{rows:8}):ce.length===0?e.jsx(et,{icon:d?ee:xe,title:d?"No archived suppliers":"No suppliers found",description:d?"Archived suppliers will appear here":D?"Try adjusting your search criteria":"Get started by adding your first supplier",actionLabel:!d&&!D?"Add Supplier":void 0,onAction:!d&&!D?()=>V(!0):void 0}):e.jsxs("div",{className:"rounded-md border",children:[e.jsxs(qs,{children:[e.jsx(zs,{children:e.jsxs(Ye,{children:[e.jsx(Je,{className:"w-12",children:e.jsx(ze,{checked:ms,ref:s=>{s&&(s.indeterminate=hs)},onCheckedChange:ue,"aria-label":"Select all suppliers"})}),e.jsx(Q,{sortKey:"id",currentSortKey:M.key,sortDirection:q("id"),onSort:s=>H(s),children:"Supplier ID"}),e.jsx(Q,{sortKey:"name",currentSortKey:M.key,sortDirection:q("name"),onSort:s=>H(s),children:"Company Name"}),e.jsx(Q,{sortKey:"contact",currentSortKey:M.key,sortDirection:q("contact"),onSort:s=>H(s),children:"Contact"}),e.jsx(Q,{sortKey:"category",currentSortKey:M.key,sortDirection:q("category"),onSort:s=>H(s),children:"Category"}),e.jsx(Q,{sortKey:"status",currentSortKey:M.key,sortDirection:q("status"),onSort:s=>H(s),children:"Status"}),e.jsx(Je,{children:"Actions"})]})}),e.jsx(Gs,{children:Ee.map(s=>{const t=ps(s.id);return e.jsxs(Ye,{className:Y("hover:bg-muted/50 transition-colors",t&&"bg-muted/50"),children:[e.jsx(P,{children:e.jsx(ze,{checked:t,onCheckedChange:()=>xs(s.id),"aria-label":`Select supplier ${s.name}`})}),e.jsx(P,{className:"font-mono text-sm",children:s.id}),e.jsx(P,{children:e.jsx("button",{className:"text-left font-medium text-primary hover:underline cursor-pointer bg-transparent border-none p-0",onClick:()=>R(s.id),children:s.name})}),e.jsx(P,{children:e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center gap-1 text-sm",children:[e.jsx(Ge,{className:"h-3 w-3 text-muted-foreground"}),e.jsx(Ne,{value:s.email,type:"text",onSave:a=>me(s.id,"email",a),disabled:!y,className:"text-xs text-muted-foreground"})]}),e.jsxs("div",{className:"flex items-center gap-1 text-sm",children:[e.jsx(Ze,{className:"h-3 w-3 text-muted-foreground"}),e.jsx(Ne,{value:s.phone,type:"text",onSave:a=>me(s.id,"phone",a),disabled:!y,className:"text-xs text-muted-foreground"})]})]})}),e.jsx(P,{children:e.jsx(Ne,{value:s.category,type:"select",options:Ce.map(a=>({value:a,label:a})),onSave:a=>me(s.id,"category",a),disabled:!y})}),e.jsx(P,{children:e.jsxs(E,{variant:"outline",className:Y("gap-1",de(s.status)),children:[e.jsx("span",{children:T(s.status)}),s.status]})}),e.jsx(P,{children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(tt,{entityType:"suppliers",entityId:s.id,entityName:s.name}),e.jsxs(pe,{open:le===s.id,onOpenChange:a=>{F(a?s.id:null),a&&m({...s})},children:[e.jsx(qe,{asChild:!0,children:e.jsx(p,{variant:"ghost",size:"sm",disabled:!y,title:y?void 0:"You don't have permission to edit suppliers",children:"Edit"})}),e.jsxs(ge,{className:"sm:max-w-[500px]",children:[e.jsxs(je,{children:[e.jsx(fe,{children:"Edit Supplier"}),e.jsxs(ve,{children:["Supplier ID: ",s.id]})]}),e.jsxs("div",{className:"grid gap-4 py-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(j,{htmlFor:"edit-name",children:"Company Name *"}),e.jsx(S,{id:"edit-name",value:r.name,onChange:a=>m({...r,name:a.target.value})})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(j,{htmlFor:"edit-status",children:"Status"}),e.jsxs(J,{value:r.status,onValueChange:a=>m({...r,status:a}),children:[e.jsx(X,{children:e.jsx(_,{placeholder:"Select status"})}),e.jsx(Z,{children:Se.map(a=>e.jsx($,{value:a,children:e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx("span",{children:T(a)}),a]})},a))})]})]})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(j,{htmlFor:"edit-contact",children:"Contact Person *"}),e.jsx(S,{id:"edit-contact",value:r.contact,onChange:a=>m({...r,contact:a.target.value})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(j,{htmlFor:"edit-email",children:"Email *"}),e.jsx(S,{id:"edit-email",type:"email",value:r.email,onChange:a=>m({...r,email:a.target.value})})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(j,{htmlFor:"edit-phone",children:"Phone *"}),e.jsx(S,{id:"edit-phone",value:r.phone,onChange:a=>m({...r,phone:a.target.value})})]})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(j,{htmlFor:"edit-category",children:"Category *"}),e.jsxs(J,{value:r.category,onValueChange:a=>m({...r,category:a}),children:[e.jsx(X,{children:e.jsx(_,{placeholder:"Select category"})}),e.jsx(Z,{children:Ce.map(a=>e.jsx($,{value:a,children:a},a))})]})]})]}),e.jsxs(ye,{className:"flex-col-reverse sm:flex-row sm:justify-between sm:space-x-2",children:[s.archived?e.jsxs(e.Fragment,{children:[e.jsxs(p,{variant:"outline",onClick:()=>ls(s.id),children:[e.jsx(_e,{className:"h-4 w-4 mr-2"}),"Restore"]}),De&&e.jsxs(p,{variant:"destructive",onClick:()=>is(s.id),children:[e.jsx(We,{className:"h-4 w-4 mr-2"}),"Permanently Delete"]})]}):e.jsxs(p,{variant:"outline",onClick:()=>rs(s.id),className:"text-orange-600 border-orange-300 hover:bg-orange-50",children:[e.jsx(ee,{className:"h-4 w-4 mr-2"}),"Archive"]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(p,{variant:"outline",onClick:()=>F(null),children:"Cancel"}),!s.archived&&e.jsx(p,{onClick:async()=>{if(!r.id){n.error("Missing supplier id");return}if(!r.name.trim()||!r.contact.trim()||!r.email.trim()||!r.phone.trim()||!r.category.trim()){n.error("Please fill all required fields");return}try{const a=await Re({id:r.id,name:r.name,contact:r.contact,email:r.email,phone:r.phone,category:r.category,status:r.status});g(l=>(l??[]).map(o=>o.id===a.id?a:o)),F(null),n.success("Supplier updated")}catch(a){n.error(a?.message||"Failed to update supplier")}},children:"Save Changes"})]})]})]})]})]})})]},s.id)})})]}),ce.length>0&&e.jsx(st,{currentPage:Oe,totalPages:cs,onPageChange:ds,itemsPerPage:us,totalItems:os})]})]})]}),e.jsx(pe,{open:ie!==null,onOpenChange:s=>!s&&R(null),children:e.jsx(ge,{className:"sm:max-w-[600px]",children:ie&&(()=>{const s=f.find(o=>o.id===ie);if(!s)return null;const t=K.filter(o=>o.supplierId===s.id),a=t.reduce((o,O)=>o+O.totalAmount,0),l=re.filter(o=>o.supplierId===s.id);return e.jsxs(e.Fragment,{children:[e.jsxs(je,{children:[e.jsxs(fe,{className:"flex items-center gap-2",children:[e.jsx(Qe,{className:"h-5 w-5 text-primary"}),"Supplier Details"]}),e.jsx(ve,{children:"View supplier information and statistics"})]}),e.jsxs("div",{className:"space-y-6 py-4",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx("h4",{className:"text-sm font-semibold text-muted-foreground uppercase tracking-wide",children:"Basic Information"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center gap-2 text-xs text-muted-foreground",children:[e.jsx(nt,{className:"h-3 w-3"}),"Supplier ID"]}),e.jsx("p",{className:"font-mono text-sm",children:s.id})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center gap-2 text-xs text-muted-foreground",children:[e.jsx(Qe,{className:"h-3 w-3"}),"Name"]}),e.jsx("p",{className:"font-medium",children:s.name})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center gap-2 text-xs text-muted-foreground",children:[e.jsx(ct,{className:"h-3 w-3"}),"Category"]}),e.jsx(E,{variant:"outline",children:s.category})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center gap-2 text-xs text-muted-foreground",children:[e.jsx(Xe,{className:"h-3 w-3"}),"Status"]}),e.jsx(E,{variant:s.status==="Active"?"default":"secondary",children:s.status})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h4",{className:"text-sm font-semibold text-muted-foreground uppercase tracking-wide",children:"Contact Information"}),e.jsxs("div",{className:"grid grid-cols-1 gap-3",children:[e.jsxs("div",{className:"flex items-center gap-3 p-3 rounded-lg bg-muted/30",children:[e.jsx(xe,{className:"h-4 w-4 text-muted-foreground"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Contact Person"}),e.jsx("p",{className:"font-medium",children:s.contact})]})]}),e.jsxs("div",{className:"flex items-center gap-3 p-3 rounded-lg bg-muted/30",children:[e.jsx(Ge,{className:"h-4 w-4 text-muted-foreground"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Email"}),e.jsx("p",{className:"font-medium",children:s.email})]})]}),e.jsxs("div",{className:"flex items-center gap-3 p-3 rounded-lg bg-muted/30",children:[e.jsx(Ze,{className:"h-4 w-4 text-muted-foreground"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground",children:"Phone"}),e.jsx("p",{className:"font-medium",children:s.phone})]})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h4",{className:"text-sm font-semibold text-muted-foreground uppercase tracking-wide",children:"Statistics"}),e.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[e.jsxs("div",{className:"p-3 rounded-lg bg-blue-50 dark:bg-blue-950/30 text-center",children:[e.jsx(Me,{className:"h-4 w-4 mx-auto mb-1 text-blue-600"}),e.jsx("p",{className:"text-lg font-bold text-blue-600",children:t.length}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Purchase Orders"})]}),e.jsxs("div",{className:"p-3 rounded-lg bg-green-50 dark:bg-green-950/30 text-center",children:[e.jsx(ot,{className:"h-4 w-4 mx-auto mb-1 text-green-600"}),e.jsxs("p",{className:"text-lg font-bold text-green-600",children:["$",a.toLocaleString()]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Total Value"})]}),e.jsxs("div",{className:"p-3 rounded-lg bg-purple-50 dark:bg-purple-950/30 text-center",children:[e.jsx(He,{className:"h-4 w-4 mx-auto mb-1 text-purple-600"}),e.jsx("p",{className:"text-lg font-bold text-purple-600",children:l.length}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Products"})]})]})]}),s.archived&&e.jsxs("div",{className:"p-3 rounded-lg bg-orange-50 dark:bg-orange-950/30 border border-orange-200 dark:border-orange-800",children:[e.jsxs("div",{className:"flex items-center gap-2 text-orange-700 dark:text-orange-300",children:[e.jsx(ee,{className:"h-4 w-4"}),e.jsx("span",{className:"font-medium",children:"Archived"})]}),s.archivedAt&&e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:["Archived on ",new Date(s.archivedAt).toLocaleDateString()]})]})]}),e.jsxs(ye,{children:[e.jsx(p,{variant:"outline",onClick:()=>R(null),children:"Close"}),y&&!s.archived&&e.jsxs(p,{onClick:()=>{R(null),handleEdit(s)},children:[e.jsx(dt,{className:"h-4 w-4 mr-2"}),"Edit Supplier"]})]})]})})()})})]})}export{Ct as SuppliersView};
