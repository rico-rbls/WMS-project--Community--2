import{c as hs,F as ms,i as ps,r as n,G as xs,aa as gs,l as vs,ab as js,aw as Ae,J as i,ax as fs,ay as ys,j as e,C as k,m as M,n as V,U as ke,o as D,S as Ss,P as Cs,d as z,t as X,s as ws,D as De,Q as Pe,B as x,v as Fe,w as Ie,x as Te,y as $e,L as g,I as S,z as Be,$ as Ns,V as bs,X as As,a6 as ks,W as Oe,az as Ds}from"./index-CMDl4gqT.js";import{S as q,a as H,b as G,c as W,d as $,T as Ee,e as Ps,f as Fs,g as Le,h as Re,i as _,j as Is,k as P}from"./sortable-table-head-BGKtTNx1.js";import{u as Ts,a as $s,P as Bs,F as Os,B as Es,b as Ls,T as Rs,E as Ks,d as Z,c as Us}from"./editable-cell-SUaTCzZZ.js";import{S as Ms,F as Vs}from"./save-search-dialog-CcP_ZCWe.js";import{u as zs}from"./useTableSort-CeokLFVK.js";import{c as qs}from"./permissions-h-CgIyJX.js";import{C as Hs}from"./circle-check-big-C7d22Pl5.js";import{S as Gs}from"./star-veo8wyR6.js";/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ws=[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]],_s=hs("phone",Ws),oe=["Active","Inactive"],de=["Electronics","Furniture","Clothing","Food","Other"];function at({initialOpenDialog:ue,onDialogOpened:he}){const{isFavorite:me,getFavoritesByType:pe}=ms(),{user:xe}=ps(),f=xe?qs(xe.role):!1,[N,ee]=n.useState(""),[p,B]=n.useState("all"),[C,se]=n.useState(!1),[ge,m]=n.useState(null),[Y,Ke]=n.useState([]),[ve,Ue]=n.useState([]),[Me,je]=n.useState(!0),[O,E]=n.useState(!1),[te,F]=n.useState(null),[r,d]=n.useState({id:"",name:"",contact:"",email:"",phone:"",category:"",status:"Active"}),ae=xs(N,300);n.useEffect(()=>{(async()=>{je(!0);const[s,a,t]=await Promise.all([gs(),vs(),js()]);m(s),Ke(a),Ue(t),je(!1)})()},[]),n.useEffect(()=>{ue&&!O&&(E(!0),he?.())},[ue,he,O]);const y=n.useMemo(()=>ge??[],[ge]),u=n.useMemo(()=>{const s=y.length,a=y.filter(c=>c.status==="Active").length,t=y.filter(c=>c.status==="Inactive").length,l=new Set(y.map(c=>c.category)).size,j=Y.length,Q=Y.reduce((c,o)=>(c[o.supplierId]=(c[o.supplierId]||0)+1,c),{});let U=null;if(Object.keys(Q).length>0){const c=Object.entries(Q).sort((A,ce)=>ce[1]-A[1])[0],o=y.find(A=>A.id===c[0]);o&&(U={id:o.id,name:o.name,count:c[1]})}const Ne=Y.reduce((c,o)=>(c[o.supplierId]=(c[o.supplierId]||0)+o.totalAmount,c),{});let be=null;if(Object.keys(Ne).length>0){const c=Object.entries(Ne).sort((A,ce)=>ce[1]-A[1])[0],o=y.find(A=>A.id===c[0]);o&&(be={id:o.id,name:o.name,value:c[1]})}const ds=ve.reduce((c,o)=>(o.supplierId&&(c[o.supplierId]=(c[o.supplierId]||0)+1),c),{}),us=Object.keys(ds).length;return{totalSuppliers:s,activeSuppliers:a,inactiveSuppliers:t,uniqueCategories:l,totalPurchaseOrders:j,topSupplierByPO:U,topSupplierByValue:be,suppliersWithProducts:us}},[y,Y,ve]),re=n.useMemo(()=>y.filter(s=>{if(s.archived!==showArchived||C&&!me("suppliers",s.id)||p!=="all"&&s.status!==p)return!1;if(ae){const a=ae.toLowerCase();if(!(s.name.toLowerCase().includes(a)||s.id.toLowerCase().includes(a)||s.category.toLowerCase().includes(a)||s.contact.toLowerCase().includes(a)||s.email.toLowerCase().includes(a)))return!1}return!0}),[y,ae,p,C,me,showArchived]),Ve=n.useCallback(s=>{s.searchTerm&&ee(s.searchTerm),s.filters.status&&B(s.filters.status),s.filters.favoritesOnly==="true"&&se(!0)},[]),ze=n.useMemo(()=>{const s={};return p!=="all"&&(s.status=p),C&&(s.favoritesOnly="true"),s},[p,C]);function qe(){ee(""),B("all"),se(!1),setShowArchived(!1)}async function He(s){try{const a=await archiveSupplier(s);m(t=>(t??[]).map(l=>l.id===s?a:l)),F(null),i.success("Supplier archived successfully")}catch(a){i.error(a?.message||"Failed to archive supplier")}}async function Ge(s){try{const a=await restoreSupplier(s);m(t=>(t??[]).map(l=>l.id===s?a:l)),F(null),i.success("Supplier restored successfully")}catch(a){i.error(a?.message||"Failed to restore supplier")}}async function We(s){try{await permanentlyDeleteSupplier(s),m(a=>(a??[]).filter(t=>t.id!==s)),F(null),i.success("Supplier permanently deleted")}catch(a){i.error(a?.message||"Failed to permanently delete supplier")}}const I=s=>{switch(s){case"Active":return"✓";case"Inactive":return"○";default:return"○"}},le=s=>{switch(s){case"Active":return"bg-emerald-500/15 text-emerald-700 dark:text-emerald-400 border-emerald-200";case"Inactive":return"bg-slate-500/15 text-slate-700 dark:text-slate-400 border-slate-200";default:return"bg-slate-500/15 text-slate-700 dark:text-slate-400 border-slate-200"}},{sortedData:_e,sortConfig:L,requestSort:R,getSortDirection:K}=zs(re),{currentPage:fe,totalPages:Ye,paginatedData:ye,goToPage:Je,totalItems:Qe,itemsPerPage:Xe}=Ts(_e,25),{selectedIds:v,selectedItems:Se,selectionCount:T,isAllSelected:Ze,isPartiallySelected:es,hasSelection:ie,toggleItem:ss,toggleAll:ne,deselectAll:h,isSelected:ts}=$s(ye),[Ce,w]=n.useState(!1),[as,we]=n.useState(!1),[rs,b]=n.useState(!1);n.useEffect(()=>{h()},[fe,h]),n.useEffect(()=>{const s=a=>{(a.metaKey||a.ctrlKey)&&a.key==="a"&&!O&&!te&&(a.preventDefault(),ne()),a.key==="Escape"&&ie&&h()};return window.addEventListener("keydown",s),()=>window.removeEventListener("keydown",s)},[ne,h,ie,O,te]);const J=n.useCallback(async(s,a,t)=>{try{const l={[a]:t},j=await Ae({id:s,...l});m(Q=>(Q??[]).map(U=>U.id===s?j:U)),i.success(`${a.charAt(0).toUpperCase()+a.slice(1)} updated`)}catch(l){throw i.error(l?.message||"Failed to update"),l}},[m]);n.useCallback(async()=>{w(!0);try{const s=Array.from(v),a=await fs(s);m(t=>t?.filter(l=>!s.includes(l.id))??[]),a.failedCount>0?i.warning(`Deleted ${a.successCount} suppliers. ${a.failedCount} failed.`):i.success(`Successfully deleted ${a.successCount} supplier${a.successCount!==1?"s":""}`),h()}catch(s){i.error(s?.message||"Failed to delete suppliers")}finally{w(!1),b(!1)}},[v,h]);const ls=n.useCallback(async()=>{w(!0);try{const s=Array.from(v),a=await bulkArchiveSuppliers(s);m(t=>t&&t.map(l=>s.includes(l.id)?{...l,archived:!0,archivedAt:new Date().toISOString()}:l)),a.failedCount>0?i.warning(`Archived ${a.successCount} suppliers. ${a.failedCount} failed.`):i.success(`Successfully archived ${a.successCount} supplier${a.successCount!==1?"s":""}`),h()}catch(s){i.error(s?.message||"Failed to archive suppliers")}finally{w(!1),b(!1)}},[v,h]),is=n.useCallback(async()=>{w(!0);try{const s=Array.from(v),a=await bulkRestoreSuppliers(s);m(t=>t&&t.map(l=>s.includes(l.id)?{...l,archived:!1,archivedAt:void 0}:l)),a.failedCount>0?i.warning(`Restored ${a.successCount} suppliers. ${a.failedCount} failed.`):i.success(`Successfully restored ${a.successCount} supplier${a.successCount!==1?"s":""}`),h()}catch(s){i.error(s?.message||"Failed to restore suppliers")}finally{w(!1),b(!1)}},[v,h]),ns=n.useCallback(async()=>{w(!0);try{const s=Array.from(v),a=await bulkPermanentlyDeleteSuppliers(s);m(t=>t?.filter(l=>!s.includes(l.id))??[]),a.failedCount>0?i.warning(`Permanently deleted ${a.successCount} suppliers. ${a.failedCount} failed.`):i.success(`Permanently deleted ${a.successCount} supplier${a.successCount!==1?"s":""}`),h()}catch(s){i.error(s?.message||"Failed to permanently delete suppliers")}finally{w(!1),b(!1)}},[v,h]),cs=n.useCallback(async s=>{we(!0);try{const a=Array.from(v),t=await ys(a,s);m(l=>l&&l.map(j=>a.includes(j.id)?{...j,status:s}:j)),t.failedCount>0?i.warning(`Updated ${t.successCount} suppliers. ${t.failedCount} failed.`):i.success(`Successfully updated ${t.successCount} supplier${t.successCount!==1?"s":""}`),h()}catch(a){i.error(a?.message||"Failed to update suppliers")}finally{we(!1)}},[v,h]),os=n.useMemo(()=>Se.map(s=>s.name),[Se]);return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:[e.jsxs(k,{className:"relative overflow-hidden",children:[e.jsxs(M,{className:"flex flex-row items-center justify-between pb-2",children:[e.jsx(V,{className:"text-sm font-medium text-muted-foreground",children:"Total Suppliers"}),e.jsx(ke,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(D,{children:[e.jsx("div",{className:"text-2xl font-bold",children:u.totalSuppliers}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:[u.activeSuppliers," active, ",u.inactiveSuppliers," inactive"]})]})]}),e.jsxs(k,{className:"relative overflow-hidden",children:[e.jsxs(M,{className:"flex flex-row items-center justify-between pb-2",children:[e.jsx(V,{className:"text-sm font-medium text-muted-foreground",children:"Active Suppliers"}),e.jsx(Hs,{className:"h-4 w-4 text-emerald-600"})]}),e.jsxs(D,{children:[e.jsx("div",{className:"text-2xl font-bold text-emerald-600",children:u.activeSuppliers}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:u.totalSuppliers>0?`${Math.round(u.activeSuppliers/u.totalSuppliers*100)}% of total`:"No suppliers yet"})]})]}),e.jsxs(k,{className:"relative overflow-hidden",children:[e.jsxs(M,{className:"flex flex-row items-center justify-between pb-2",children:[e.jsx(V,{className:"text-sm font-medium text-muted-foreground",children:"Total Purchase Orders"}),e.jsx(Ss,{className:"h-4 w-4 text-blue-600"})]}),e.jsxs(D,{children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:u.totalPurchaseOrders}),e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:u.topSupplierByPO?`Top: ${u.topSupplierByPO.name} (${u.topSupplierByPO.count})`:"No orders yet"})]})]}),e.jsxs(k,{className:"relative overflow-hidden",children:[e.jsxs(M,{className:"flex flex-row items-center justify-between pb-2",children:[e.jsx(V,{className:"text-sm font-medium text-muted-foreground",children:"Categories"}),e.jsx(Cs,{className:"h-4 w-4 text-purple-600"})]}),e.jsxs(D,{children:[e.jsx("div",{className:"text-2xl font-bold text-purple-600",children:u.uniqueCategories}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:[u.suppliersWithProducts," suppliers with products"]})]})]})]}),e.jsxs("div",{className:"grid gap-3 grid-cols-1 sm:grid-cols-2",children:[e.jsx(k,{className:z("cursor-pointer transition-all hover:shadow-md border-l-4",p==="Active"?"ring-2 ring-primary":"","border-l-emerald-400"),onClick:()=>B(p==="Active"?"all":"Active"),children:e.jsx(D,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-medium text-muted-foreground uppercase tracking-wide",children:"Active"}),e.jsx("p",{className:"text-xl font-bold mt-1",children:u.activeSuppliers})]}),e.jsx(X,{variant:"outline",className:le("Active"),children:I("Active")})]})})}),e.jsx(k,{className:z("cursor-pointer transition-all hover:shadow-md border-l-4",p==="Inactive"?"ring-2 ring-primary":"","border-l-slate-400"),onClick:()=>B(p==="Inactive"?"all":"Inactive"),children:e.jsx(D,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-medium text-muted-foreground uppercase tracking-wide",children:"Inactive"}),e.jsx("p",{className:"text-xl font-bold mt-1",children:u.inactiveSuppliers})]}),e.jsx(X,{variant:"outline",className:le("Inactive"),children:I("Inactive")})]})})})]}),e.jsxs(k,{children:[e.jsx(M,{className:"pb-4",children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx(V,{className:"text-xl",children:"Supplier Management"}),e.jsx(ws,{className:"mt-1",children:"Manage your supplier relationships and contacts"})]}),e.jsx("div",{className:"flex gap-2",children:e.jsxs(De,{open:O,onOpenChange:s=>{E(s),s||d({id:"",name:"",contact:"",email:"",phone:"",category:"",status:"Active"})},children:[e.jsx(Pe,{asChild:!0,children:e.jsxs(x,{onClick:()=>d({id:"",name:"",contact:"",email:"",phone:"",category:"",status:"Active"}),disabled:!f,title:f?void 0:"You don't have permission to add suppliers",children:[e.jsx(Bs,{className:"h-4 w-4 mr-2"}),"Add Supplier"]})}),e.jsxs(Fe,{className:"sm:max-w-[500px]",children:[e.jsxs(Ie,{children:[e.jsx(Te,{children:"Create New Supplier"}),e.jsx($e,{children:"Enter the details for the new supplier."})]}),e.jsxs("div",{className:"grid gap-4 py-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(g,{htmlFor:"supplier-name",children:"Company Name *"}),e.jsx(S,{id:"supplier-name",placeholder:"Enter company name",value:r.name,onChange:s=>d({...r,name:s.target.value})})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(g,{htmlFor:"supplier-status",children:"Status"}),e.jsxs(q,{value:r.status,onValueChange:s=>d({...r,status:s}),children:[e.jsx(H,{children:e.jsx(G,{placeholder:"Select status"})}),e.jsx(W,{children:oe.map(s=>e.jsx($,{value:s,children:e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx("span",{children:I(s)}),s]})},s))})]})]})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(g,{htmlFor:"contact-name",children:"Contact Person *"}),e.jsx(S,{id:"contact-name",placeholder:"Enter contact name",value:r.contact,onChange:s=>d({...r,contact:s.target.value})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(g,{htmlFor:"email",children:"Email *"}),e.jsx(S,{id:"email",type:"email",placeholder:"email@example.com",value:r.email,onChange:s=>d({...r,email:s.target.value})})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(g,{htmlFor:"phone",children:"Phone *"}),e.jsx(S,{id:"phone",placeholder:"+1 (555) 000-0000",value:r.phone,onChange:s=>d({...r,phone:s.target.value})})]})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(g,{htmlFor:"category",children:"Category *"}),e.jsxs(q,{value:r.category,onValueChange:s=>d({...r,category:s}),children:[e.jsx(H,{children:e.jsx(G,{placeholder:"Select category"})}),e.jsx(W,{children:de.map(s=>e.jsx($,{value:s,children:s},s))})]})]})]}),e.jsxs(Be,{children:[e.jsx(x,{variant:"outline",onClick:()=>E(!1),children:"Cancel"}),e.jsx(x,{onClick:async()=>{if(!r.name.trim()||!r.contact.trim()||!r.email.trim()||!r.phone.trim()||!r.category.trim()){i.error("Please fill all required fields");return}try{const s=await Ns({name:r.name,contact:r.contact,email:r.email,phone:r.phone,category:r.category,status:r.status});m(a=>[s,...a??[]]),E(!1),i.success("Supplier added successfully"),d({id:"",name:"",contact:"",email:"",phone:"",category:"",status:"Active"})}catch(s){i.error(s?.message||"Failed to add supplier")}},children:"Create Supplier"})]})]})]})})]})}),e.jsxs(D,{children:[e.jsxs("div",{className:"mb-6 space-y-4",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(bs,{className:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground"}),e.jsx(S,{placeholder:"Search suppliers by name, contact, email...",value:N,onChange:s=>ee(s.target.value),className:"pl-9"})]}),e.jsxs(q,{value:p,onValueChange:B,children:[e.jsxs(H,{className:"w-full sm:w-[180px]",children:[e.jsx(Os,{className:"h-4 w-4 mr-2"}),e.jsx(G,{placeholder:"Filter by status"})]}),e.jsxs(W,{children:[e.jsx($,{value:"all",children:"All Statuses"}),oe.map(s=>e.jsx($,{value:s,children:e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx("span",{children:I(s)}),s]})},s))]})]})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-4",children:[e.jsxs(x,{variant:C?"default":"outline",size:"sm",onClick:()=>se(!C),className:"gap-1",children:[e.jsx(Gs,{className:z("h-4 w-4",C&&"fill-current")}),"Favorites",pe("suppliers").length>0&&e.jsx(X,{variant:"secondary",className:"ml-1 h-5 px-1.5",children:pe("suppliers").length})]}),e.jsx(Ms,{entityType:"suppliers",currentSearchTerm:N,currentFilters:ze,onApplySearch:Ve}),e.jsxs(x,{variant:showArchived?"default":"outline",size:"sm",onClick:()=>setShowArchived(!showArchived),className:showArchived?"bg-orange-500 hover:bg-orange-600 text-white":"",children:[e.jsx(Archive,{className:"h-4 w-4 mr-1"}),showArchived?"Viewing Archived":"View Archived"]}),(N||p!=="all"||C||showArchived)&&e.jsxs(x,{variant:"ghost",size:"sm",onClick:qe,className:"gap-1 text-muted-foreground hover:text-foreground",children:[e.jsx(As,{className:"h-4 w-4"}),"Clear All Filters"]})]})]}),ie&&f&&e.jsx(Es,{selectionCount:T,onClearSelection:h,isLoading:Ce||as,actions:showArchived?[{id:"restore",label:"Restore",icon:e.jsx(ArchiveRestore,{className:"h-4 w-4 mr-1"}),variant:"outline",onClick:is},...canPermanentlyDelete?[{id:"permanent-delete",label:"Permanently Delete",icon:e.jsx(Ee,{className:"h-4 w-4 mr-1"}),variant:"destructive",onClick:()=>b(!0)}]:[]]:[{id:"archive",label:"Archive",icon:e.jsx(Archive,{className:"h-4 w-4 mr-1"}),variant:"outline",onClick:()=>b(!0)}],actionGroups:showArchived?[]:[{id:"status-update",label:"Update Status",icon:e.jsx(ks,{className:"h-4 w-4 mr-1"}),options:[{value:"Active",label:"Active"},{value:"Inactive",label:"Inactive"}],onSelect:s=>cs(s)}],className:"mb-4"}),e.jsx(Ls,{open:rs,onOpenChange:b,itemCount:T,itemType:"supplier",itemNames:os,onConfirm:showArchived?ns:ls,isLoading:Ce,title:showArchived?"Permanently Delete Suppliers":"Archive Suppliers",description:showArchived?`Are you sure you want to permanently delete ${T} supplier${T!==1?"s":""}? This action cannot be undone.`:`Are you sure you want to archive ${T} supplier${T!==1?"s":""}? Archived suppliers can be restored later.`,confirmLabel:showArchived?"Permanently Delete":"Archive"}),Me?e.jsx(Rs,{rows:8}):re.length===0?e.jsx(Ks,{icon:showArchived?Archive:ke,title:showArchived?"No archived suppliers":"No suppliers found",description:showArchived?"Archived suppliers will appear here":N?"Try adjusting your search criteria":"Get started by adding your first supplier",actionLabel:!showArchived&&!N?"Add Supplier":void 0,onAction:!showArchived&&!N?()=>E(!0):void 0}):e.jsxs("div",{className:"rounded-md border",children:[e.jsxs(Ps,{children:[e.jsx(Fs,{children:e.jsxs(Le,{children:[e.jsx(Re,{className:"w-12",children:e.jsx(Oe,{checked:Ze,ref:s=>{s&&(s.indeterminate=es)},onCheckedChange:ne,"aria-label":"Select all suppliers"})}),e.jsx(_,{sortKey:"id",currentSortKey:L.key,sortDirection:K("id"),onSort:s=>R(s),children:"Supplier ID"}),e.jsx(_,{sortKey:"name",currentSortKey:L.key,sortDirection:K("name"),onSort:s=>R(s),children:"Company Name"}),e.jsx(_,{sortKey:"contact",currentSortKey:L.key,sortDirection:K("contact"),onSort:s=>R(s),children:"Contact"}),e.jsx(_,{sortKey:"category",currentSortKey:L.key,sortDirection:K("category"),onSort:s=>R(s),children:"Category"}),e.jsx(_,{sortKey:"status",currentSortKey:L.key,sortDirection:K("status"),onSort:s=>R(s),children:"Status"}),e.jsx(Re,{children:"Actions"})]})}),e.jsx(Is,{children:ye.map(s=>{const a=ts(s.id);return e.jsxs(Le,{className:z("hover:bg-muted/50 transition-colors",a&&"bg-muted/50"),children:[e.jsx(P,{children:e.jsx(Oe,{checked:a,onCheckedChange:()=>ss(s.id),"aria-label":`Select supplier ${s.name}`})}),e.jsx(P,{className:"font-mono text-sm",children:s.id}),e.jsx(P,{children:e.jsx(Z,{value:s.name,type:"text",onSave:t=>J(s.id,"name",t),disabled:!f})}),e.jsx(P,{children:e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center gap-1 text-sm",children:[e.jsx(Ds,{className:"h-3 w-3 text-muted-foreground"}),e.jsx(Z,{value:s.email,type:"text",onSave:t=>J(s.id,"email",t),disabled:!f,className:"text-xs text-muted-foreground"})]}),e.jsxs("div",{className:"flex items-center gap-1 text-sm",children:[e.jsx(_s,{className:"h-3 w-3 text-muted-foreground"}),e.jsx(Z,{value:s.phone,type:"text",onSave:t=>J(s.id,"phone",t),disabled:!f,className:"text-xs text-muted-foreground"})]})]})}),e.jsx(P,{children:e.jsx(Z,{value:s.category,type:"select",options:de.map(t=>({value:t,label:t})),onSave:t=>J(s.id,"category",t),disabled:!f})}),e.jsx(P,{children:e.jsxs(X,{variant:"outline",className:z("gap-1",le(s.status)),children:[e.jsx("span",{children:I(s.status)}),s.status]})}),e.jsx(P,{children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Vs,{entityType:"suppliers",entityId:s.id,entityName:s.name}),e.jsxs(De,{open:te===s.id,onOpenChange:t=>{F(t?s.id:null),t&&d({...s})},children:[e.jsx(Pe,{asChild:!0,children:e.jsx(x,{variant:"ghost",size:"sm",disabled:!f,title:f?void 0:"You don't have permission to edit suppliers",children:"Edit"})}),e.jsxs(Fe,{className:"sm:max-w-[500px]",children:[e.jsxs(Ie,{children:[e.jsx(Te,{children:"Edit Supplier"}),e.jsxs($e,{children:["Supplier ID: ",s.id]})]}),e.jsxs("div",{className:"grid gap-4 py-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(g,{htmlFor:"edit-name",children:"Company Name *"}),e.jsx(S,{id:"edit-name",value:r.name,onChange:t=>d({...r,name:t.target.value})})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(g,{htmlFor:"edit-status",children:"Status"}),e.jsxs(q,{value:r.status,onValueChange:t=>d({...r,status:t}),children:[e.jsx(H,{children:e.jsx(G,{placeholder:"Select status"})}),e.jsx(W,{children:oe.map(t=>e.jsx($,{value:t,children:e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx("span",{children:I(t)}),t]})},t))})]})]})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(g,{htmlFor:"edit-contact",children:"Contact Person *"}),e.jsx(S,{id:"edit-contact",value:r.contact,onChange:t=>d({...r,contact:t.target.value})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(g,{htmlFor:"edit-email",children:"Email *"}),e.jsx(S,{id:"edit-email",type:"email",value:r.email,onChange:t=>d({...r,email:t.target.value})})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(g,{htmlFor:"edit-phone",children:"Phone *"}),e.jsx(S,{id:"edit-phone",value:r.phone,onChange:t=>d({...r,phone:t.target.value})})]})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(g,{htmlFor:"edit-category",children:"Category *"}),e.jsxs(q,{value:r.category,onValueChange:t=>d({...r,category:t}),children:[e.jsx(H,{children:e.jsx(G,{placeholder:"Select category"})}),e.jsx(W,{children:de.map(t=>e.jsx($,{value:t,children:t},t))})]})]})]}),e.jsxs(Be,{className:"flex-col-reverse sm:flex-row sm:justify-between sm:space-x-2",children:[s.archived?e.jsxs(e.Fragment,{children:[e.jsxs(x,{variant:"outline",onClick:()=>Ge(s.id),children:[e.jsx(ArchiveRestore,{className:"h-4 w-4 mr-2"}),"Restore"]}),canPermanentlyDelete&&e.jsxs(x,{variant:"destructive",onClick:()=>We(s.id),children:[e.jsx(Ee,{className:"h-4 w-4 mr-2"}),"Permanently Delete"]})]}):e.jsxs(x,{variant:"outline",onClick:()=>He(s.id),className:"text-orange-600 border-orange-300 hover:bg-orange-50",children:[e.jsx(Archive,{className:"h-4 w-4 mr-2"}),"Archive"]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(x,{variant:"outline",onClick:()=>F(null),children:"Cancel"}),!s.archived&&e.jsx(x,{onClick:async()=>{if(!r.id){i.error("Missing supplier id");return}if(!r.name.trim()||!r.contact.trim()||!r.email.trim()||!r.phone.trim()||!r.category.trim()){i.error("Please fill all required fields");return}try{const t=await Ae({id:r.id,name:r.name,contact:r.contact,email:r.email,phone:r.phone,category:r.category,status:r.status});m(l=>(l??[]).map(j=>j.id===t.id?t:j)),F(null),i.success("Supplier updated")}catch(t){i.error(t?.message||"Failed to update supplier")}},children:"Save Changes"})]})]})]})]})]})})]},s.id)})})]}),re.length>0&&e.jsx(Us,{currentPage:fe,totalPages:Ye,onPageChange:Je,itemsPerPage:Xe,totalItems:Qe})]})]})]})]})}export{at as SuppliersView};
