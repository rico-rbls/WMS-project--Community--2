import{n as me,r as n,W as he,Y as xe,t as i,Z as pe,j as e,C as f,h as v,i as C,k as N,B as j,L as d,I as r,_ as ge,f as je,U as ye,v as K,c as fe,$ as ve,a0 as Ce,a1 as Ne}from"./index-DyWq3L3w.js";import{B as Se}from"./badge-BiRkMtjm.js";import{u as we,j as be,k as ke,D as R,l as _,P as De,a as z,b as G,c as V,d as W,m as Ae,B as Ee,T as Te,n as Pe,o as Be,E as Le,p as Fe,q as Ie,r as Y,s as m,t as $e,v as h,w as Ue}from"./bulk-delete-dialog-BXHSaD15.js";/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Me=[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]],Oe=me("phone",Me);function Re(){const[g,Z]=n.useState(""),[L,x]=n.useState(null),[J,F]=n.useState(!0),[S,w]=n.useState(!1),[b,k]=n.useState(null),[a,c]=n.useState({id:"",name:"",contact:"",email:"",phone:"",category:"",status:"Active"}),D=we(g,300);n.useEffect(()=>{(async()=>{F(!0);const s=await he();x(s),F(!1)})()},[]);const A=n.useMemo(()=>L??[],[L]),E=n.useMemo(()=>{if(!D)return A;const s=D.toLowerCase();return A.filter(l=>l.name.toLowerCase().includes(s)||l.id.toLowerCase().includes(s)||l.category.toLowerCase().includes(s))},[A,D]),{currentPage:I,totalPages:Q,paginatedData:$,goToPage:X,totalItems:ee,itemsPerPage:se}=be(E,25),{selectedIds:y,selectedItems:U,selectionCount:M,isAllSelected:ae,isPartiallySelected:te,hasSelection:T,toggleItem:le,toggleAll:P,deselectAll:o,isSelected:ne}=ke($),[O,q]=n.useState(!1),[ie,H]=n.useState(!1),[ce,B]=n.useState(!1);n.useEffect(()=>{o()},[I,o]),n.useEffect(()=>{const s=l=>{(l.metaKey||l.ctrlKey)&&l.key==="a"&&!S&&!b&&(l.preventDefault(),P()),l.key==="Escape"&&T&&o()};return window.addEventListener("keydown",s),()=>window.removeEventListener("keydown",s)},[P,o,T,S,b]);const re=s=>s==="Active"?"bg-green-500/10 text-green-700":"bg-gray-500/10 text-gray-700",de=n.useCallback(async()=>{q(!0);try{const s=Array.from(y),l=await xe(s);x(t=>t?.filter(u=>!s.includes(u.id))??[]),l.failedCount>0?i.warning(`Deleted ${l.successCount} suppliers. ${l.failedCount} failed.`):i.success(`Successfully deleted ${l.successCount} supplier${l.successCount!==1?"s":""}`),o()}catch(s){i.error(s?.message||"Failed to delete suppliers")}finally{q(!1),B(!1)}},[y,o]),oe=n.useCallback(async s=>{H(!0);try{const l=Array.from(y),t=await pe(l,s);x(u=>u&&u.map(p=>l.includes(p.id)?{...p,status:s}:p)),t.failedCount>0?i.warning(`Updated ${t.successCount} suppliers. ${t.failedCount} failed.`):i.success(`Successfully updated ${t.successCount} supplier${t.successCount!==1?"s":""}`),o()}catch(l){i.error(l?.message||"Failed to update suppliers")}finally{H(!1)}},[y,o]),ue=n.useMemo(()=>U.map(s=>s.name),[U]);return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid gap-4 md:grid-cols-3",children:[e.jsxs(f,{children:[e.jsx(v,{className:"pb-2",children:e.jsx(C,{className:"text-sm text-muted-foreground",children:"Total Suppliers"})}),e.jsx(N,{children:e.jsx("div",{className:"text-2xl",children:"48"})})]}),e.jsxs(f,{children:[e.jsx(v,{className:"pb-2",children:e.jsx(C,{className:"text-sm text-muted-foreground",children:"Active"})}),e.jsx(N,{children:e.jsx("div",{className:"text-2xl",children:"42"})})]}),e.jsxs(f,{children:[e.jsx(v,{className:"pb-2",children:e.jsx(C,{className:"text-sm text-muted-foreground",children:"Categories"})}),e.jsx(N,{children:e.jsx("div",{className:"text-2xl",children:"8"})})]})]}),e.jsxs(f,{children:[e.jsx(v,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(C,{children:"Supplier Management"}),e.jsx("div",{className:"flex gap-2",children:e.jsxs(R,{open:S,onOpenChange:s=>{w(s),s||c({id:"",name:"",contact:"",email:"",phone:"",category:"",status:"Active"})},children:[e.jsx(_,{asChild:!0,children:e.jsxs(j,{onClick:()=>c({id:"",name:"",contact:"",email:"",phone:"",category:"",status:"Active"}),children:[e.jsx(De,{className:"h-4 w-4 mr-2"}),"Add Supplier"]})}),e.jsxs(z,{children:[e.jsxs(G,{children:[e.jsx(V,{children:"Add New Supplier"}),e.jsx(W,{children:"Enter the details for the new supplier."})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{htmlFor:"supplier-name",children:"Company Name"}),e.jsx(r,{id:"supplier-name",placeholder:"Enter company name",value:a.name,onChange:s=>c({...a,name:s.target.value})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{htmlFor:"contact-name",children:"Contact Person"}),e.jsx(r,{id:"contact-name",placeholder:"Enter contact name",value:a.contact,onChange:s=>c({...a,contact:s.target.value})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{htmlFor:"email",children:"Email"}),e.jsx(r,{id:"email",type:"email",placeholder:"email@example.com",value:a.email,onChange:s=>c({...a,email:s.target.value})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{htmlFor:"phone",children:"Phone"}),e.jsx(r,{id:"phone",placeholder:"+1 (555) 000-0000",value:a.phone,onChange:s=>c({...a,phone:s.target.value})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{htmlFor:"category",children:"Category"}),e.jsx(r,{id:"category",placeholder:"e.g., Electronics",value:a.category,onChange:s=>c({...a,category:s.target.value})})]}),e.jsx(j,{className:"w-full",onClick:async()=>{if(!a.name.trim()||!a.contact.trim()||!a.email.trim()||!a.phone.trim()||!a.category.trim()){i.error("Please fill all required fields");return}try{const s=await ge({name:a.name,contact:a.contact,email:a.email,phone:a.phone,category:a.category,status:a.status});x(l=>[s,...l??[]]),w(!1),i.success("Supplier added successfully"),c({id:"",name:"",contact:"",email:"",phone:"",category:"",status:"Active"})}catch(s){i.error(s?.message||"Failed to add supplier")}},children:"Add Supplier"})]})]})]})})]})}),e.jsxs(N,{children:[e.jsx("div",{className:"mb-6",children:e.jsxs("div",{className:"relative",children:[e.jsx(Ae,{className:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground"}),e.jsx(r,{placeholder:"Search suppliers...",value:g,onChange:s=>Z(s.target.value),className:"pl-9"})]})}),T&&e.jsx(Ee,{selectionCount:M,onClearSelection:o,isLoading:O||ie,actions:[{id:"delete",label:"Delete",icon:e.jsx(Te,{className:"h-4 w-4 mr-1"}),variant:"destructive",onClick:()=>B(!0)}],actionGroups:[{id:"status-update",label:"Update Status",icon:e.jsx(je,{className:"h-4 w-4 mr-1"}),options:[{value:"Active",label:"Active"},{value:"Inactive",label:"Inactive"}],onSelect:s=>oe(s)}],className:"mb-4"}),e.jsx(Pe,{open:ce,onOpenChange:B,itemCount:M,itemType:"supplier",itemNames:ue,onConfirm:de,isLoading:O}),J?e.jsx(Be,{rows:8}):E.length===0?e.jsx(Le,{icon:ye,title:"No suppliers found",description:g?"Try adjusting your search criteria":"Get started by adding your first supplier",actionLabel:g?void 0:"Add Supplier",onAction:g?void 0:()=>w(!0)}):e.jsxs("div",{className:"rounded-md border",children:[e.jsxs(Fe,{children:[e.jsx(Ie,{children:e.jsxs(Y,{children:[e.jsx(m,{className:"w-12",children:e.jsx(K,{checked:ae,ref:s=>{s&&(s.indeterminate=te)},onCheckedChange:P,"aria-label":"Select all suppliers"})}),e.jsx(m,{children:"Supplier ID"}),e.jsx(m,{children:"Company Name"}),e.jsx(m,{children:"Contact"}),e.jsx(m,{children:"Category"}),e.jsx(m,{children:"Status"}),e.jsx(m,{children:"Actions"})]})}),e.jsx($e,{children:$.map(s=>{const l=ne(s.id);return e.jsxs(Y,{className:fe(l&&"bg-muted/50"),children:[e.jsx(h,{children:e.jsx(K,{checked:l,onCheckedChange:()=>le(s.id),"aria-label":`Select supplier ${s.name}`})}),e.jsx(h,{children:s.id}),e.jsx(h,{children:s.name}),e.jsx(h,{children:e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center gap-1 text-sm",children:[e.jsx(ve,{className:"h-3 w-3 text-muted-foreground"}),e.jsx("span",{className:"text-xs text-muted-foreground",children:s.email})]}),e.jsxs("div",{className:"flex items-center gap-1 text-sm",children:[e.jsx(Oe,{className:"h-3 w-3 text-muted-foreground"}),e.jsx("span",{className:"text-xs text-muted-foreground",children:s.phone})]})]})}),e.jsx(h,{children:s.category}),e.jsx(h,{children:e.jsx(Se,{variant:"secondary",className:re(s.status),children:s.status})}),e.jsx(h,{children:e.jsxs(R,{open:b===s.id,onOpenChange:t=>{k(t?s.id:null),t&&c({...s})},children:[e.jsx(_,{asChild:!0,children:e.jsx(j,{variant:"ghost",size:"sm",children:"Edit"})}),e.jsxs(z,{children:[e.jsxs(G,{children:[e.jsx(V,{children:"Edit Supplier"}),e.jsx(W,{children:"Update fields and save your changes."})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{htmlFor:"edit-name",children:"Company Name"}),e.jsx(r,{id:"edit-name",value:a.name,onChange:t=>c({...a,name:t.target.value})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{htmlFor:"edit-contact",children:"Contact Person"}),e.jsx(r,{id:"edit-contact",value:a.contact,onChange:t=>c({...a,contact:t.target.value})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{htmlFor:"edit-email",children:"Email"}),e.jsx(r,{id:"edit-email",value:a.email,onChange:t=>c({...a,email:t.target.value})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{htmlFor:"edit-phone",children:"Phone"}),e.jsx(r,{id:"edit-phone",value:a.phone,onChange:t=>c({...a,phone:t.target.value})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{htmlFor:"edit-category",children:"Category"}),e.jsx(r,{id:"edit-category",value:a.category,onChange:t=>c({...a,category:t.target.value})})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(j,{className:"flex-1",onClick:async()=>{if(!a.id){i.error("Missing supplier id");return}if(!a.name.trim()||!a.contact.trim()||!a.email.trim()||!a.phone.trim()||!a.category.trim()){i.error("Please fill all required fields");return}try{const t=await Ce({id:a.id,name:a.name,contact:a.contact,email:a.email,phone:a.phone,category:a.category,status:a.status});x(u=>(u??[]).map(p=>p.id===t.id?t:p)),k(null),i.success("Supplier updated")}catch(t){i.error(t?.message||"Failed to update supplier")}},children:"Save Changes"}),e.jsx(j,{variant:"destructive",onClick:async()=>{try{await Ne(s.id),x(t=>(t??[]).filter(u=>u.id!==s.id)),k(null),i.success("Supplier deleted")}catch(t){i.error(t?.message||"Failed to delete supplier")}},children:"Delete"})]})]})]})]})})]},s.id)})})]}),E.length>0&&e.jsx(Ue,{currentPage:I,totalPages:Q,onPageChange:X,itemsPerPage:se,totalItems:ee})]})]})]})]})}export{Re as SuppliersView};
