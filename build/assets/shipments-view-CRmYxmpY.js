import{n as De,r as n,K as Ne,M as be,t as l,N as we,j as e,C,h as y,i as S,k as D,P as Ie,B as p,L as u,I as d,X as ke,f as Te,l as Pe,v as X,c as Ee,O as Ae,Q as Fe,V as Be}from"./index-DyWq3L3w.js";import{B as J}from"./badge-BiRkMtjm.js";import{u as Le,j as Oe,k as $e,D as W,l as Y,P as Ue,a as Z,b as ee,c as se,d as ae,m as Me,B as qe,T as He,n as Re,o as Ke,E as ze,p as Ge,q as Ve,r as te,s as m,t as _e,v as j,w as Qe}from"./bulk-delete-dialog-BXHSaD15.js";import{D as Xe}from"./date-range-filter-BzVaznTC.js";/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Je=[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]],We=De("map-pin",Je);function as(){const[f,re]=n.useState(""),[c,L]=n.useState(""),[o,O]=n.useState(""),[$,g]=n.useState(null),[ne,U]=n.useState(!0),[N,b]=n.useState(!1),[w,I]=n.useState(null),[a,i]=n.useState({id:"",orderId:"",destination:"",carrier:"",status:"Pending",eta:""}),k=Le(f,300);n.useEffect(()=>{(async()=>{U(!0);const s=await Ne();g(s),U(!1)})()},[]);const M=n.useMemo(()=>$??[],[$]),T=n.useMemo(()=>M.filter(s=>{if(k){const t=k.toLowerCase();if(!(s.id.toLowerCase().includes(t)||s.orderId.toLowerCase().includes(t)||s.destination.toLowerCase().includes(t)))return!1}if(c||o)try{const t=new Date(s.eta);if(c){const r=new Date(c);if(t<r)return!1}if(o){const r=new Date(o);if(r.setHours(23,59,59,999),t>r)return!1}}catch{return!1}return!0}),[M,k,c,o]),{currentPage:q,totalPages:ie,paginatedData:H,goToPage:le,totalItems:de,itemsPerPage:ce}=Oe(T,25),{selectedIds:v,selectedItems:R,selectionCount:K,isAllSelected:oe,isPartiallySelected:ue,hasSelection:P,toggleItem:he,toggleAll:E,deselectAll:h,isSelected:xe}=$e(H),[z,G]=n.useState(!1),[me,V]=n.useState(!1),[je,A]=n.useState(!1);n.useEffect(()=>{h()},[q,h]),n.useEffect(()=>{const s=t=>{(t.metaKey||t.ctrlKey)&&t.key==="a"&&!N&&!w&&(t.preventDefault(),E()),t.key==="Escape"&&P&&h()};return window.addEventListener("keydown",s),()=>window.removeEventListener("keydown",s)},[E,h,P,N,w]);function F(){i({id:"",orderId:"",destination:"",carrier:"",status:"Pending",eta:""})}function _(){L(""),O("")}function Q(){return a.orderId.trim()?a.destination.trim()?a.carrier.trim()?a.eta.trim()?null:"ETA is required":"Carrier is required":"Destination is required":"Order ID is required"}async function ge(){const s=Q();if(s){l.error(s);return}const t=await Ae({orderId:a.orderId,destination:a.destination,carrier:a.carrier,status:a.status,eta:a.eta});g(r=>[t,...r??[]]),b(!1),F(),l.success("Shipment created successfully")}async function fe(){const s=Q();if(s){l.error(s);return}if(!a.id){l.error("Missing shipment id");return}const t=await Fe({id:a.id,orderId:a.orderId,destination:a.destination,carrier:a.carrier,status:a.status,eta:a.eta});g(r=>(r??[]).map(x=>x.id===t.id?t:x)),I(null),l.success("Shipment updated successfully")}async function pe(s){await Be(s),g(t=>(t??[]).filter(r=>r.id!==s)),I(null),l.success("Shipment deleted successfully")}const ve=s=>{switch(s){case"Delivered":return"bg-green-500/10 text-green-700";case"In Transit":return"bg-blue-500/10 text-blue-700";case"Processing":return"bg-orange-500/10 text-orange-700";case"Pending":return"bg-gray-500/10 text-gray-700";default:return"bg-gray-500/10 text-gray-700"}},Ce=n.useCallback(async()=>{G(!0);try{const s=Array.from(v),t=await be(s);g(r=>r?.filter(x=>!s.includes(x.id))??[]),t.failedCount>0?l.warning(`Deleted ${t.successCount} shipments. ${t.failedCount} failed.`):l.success(`Successfully deleted ${t.successCount} shipment${t.successCount!==1?"s":""}`),h()}catch(s){l.error(s?.message||"Failed to delete shipments")}finally{G(!1),A(!1)}},[v,h]),ye=n.useCallback(async s=>{V(!0);try{const t=Array.from(v),r=await we(t,s);g(x=>x&&x.map(B=>t.includes(B.id)?{...B,status:s}:B)),r.failedCount>0?l.warning(`Updated ${r.successCount} shipments. ${r.failedCount} failed.`):l.success(`Successfully updated ${r.successCount} shipment${r.successCount!==1?"s":""}`),h()}catch(t){l.error(t?.message||"Failed to update shipments")}finally{V(!1)}},[v,h]),Se=n.useMemo(()=>R.map(s=>`${s.id} â†’ ${s.destination}`),[R]);return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid gap-4 md:grid-cols-3",children:[e.jsxs(C,{children:[e.jsx(y,{className:"pb-2",children:e.jsx(S,{className:"text-sm text-muted-foreground",children:"Active Shipments"})}),e.jsx(D,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ie,{className:"h-5 w-5 text-blue-600"}),e.jsx("div",{className:"text-2xl",children:"89"})]})})]}),e.jsxs(C,{children:[e.jsx(y,{className:"pb-2",children:e.jsx(S,{className:"text-sm text-muted-foreground",children:"In Transit"})}),e.jsx(D,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(We,{className:"h-5 w-5 text-orange-600"}),e.jsx("div",{className:"text-2xl",children:"67"})]})})]}),e.jsxs(C,{children:[e.jsx(y,{className:"pb-2",children:e.jsx(S,{className:"text-sm text-muted-foreground",children:"On-Time Rate"})}),e.jsx(D,{children:e.jsx("div",{className:"text-2xl",children:"94%"})})]})]}),e.jsxs(C,{children:[e.jsx(y,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(S,{children:"Shipment Tracking"}),e.jsx("div",{className:"flex gap-2",children:e.jsxs(W,{open:N,onOpenChange:s=>{b(s),s||F()},children:[e.jsx(Y,{asChild:!0,children:e.jsxs(p,{onClick:()=>F(),children:[e.jsx(Ue,{className:"h-4 w-4 mr-2"}),"Add Shipment"]})}),e.jsxs(Z,{children:[e.jsxs(ee,{children:[e.jsx(se,{children:"Add New Shipment"}),e.jsx(ae,{children:"Enter the details for the new shipment."})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{htmlFor:"orderId",children:"Order ID"}),e.jsx(d,{id:"orderId",placeholder:"ORD-0001",value:a.orderId,onChange:s=>i({...a,orderId:s.target.value})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{htmlFor:"destination",children:"Destination"}),e.jsx(d,{id:"destination",placeholder:"City, ST",value:a.destination,onChange:s=>i({...a,destination:s.target.value})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{htmlFor:"carrier",children:"Carrier"}),e.jsx(d,{id:"carrier",placeholder:"FedEx/UPS/DHL",value:a.carrier,onChange:s=>i({...a,carrier:s.target.value})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{htmlFor:"status",children:"Status"}),e.jsx(d,{id:"status",placeholder:"Pending",value:a.status,onChange:s=>i({...a,status:s.target.value})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{htmlFor:"eta",children:"ETA"}),e.jsx(d,{id:"eta",placeholder:"Oct 20, 2025",value:a.eta,onChange:s=>i({...a,eta:s.target.value})})]}),e.jsx(p,{className:"w-full",onClick:ge,children:"Add Shipment"})]})]})]})})]})}),e.jsxs(D,{children:[e.jsxs("div",{className:"mb-6 space-y-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx(Me,{className:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground"}),e.jsx(d,{placeholder:"Search shipments...",value:f,onChange:s=>re(s.target.value),className:"pl-9"})]}),e.jsx(Xe,{fromDate:c,toDate:o,onFromDateChange:L,onToDateChange:O,onClear:_,label:"Filter by ETA Date"}),(c||o)&&e.jsx("div",{className:"flex flex-wrap gap-2",children:e.jsxs(J,{variant:"secondary",className:"gap-1",children:["ETA: ",c||"..."," to ",o||"...",e.jsx("button",{onClick:_,className:"ml-1 hover:bg-secondary-foreground/20 rounded-full p-0.5",children:e.jsx(ke,{className:"h-3 w-3"})})]})})]}),P&&e.jsx(qe,{selectionCount:K,onClearSelection:h,isLoading:z||me,actions:[{id:"delete",label:"Delete",icon:e.jsx(He,{className:"h-4 w-4 mr-1"}),variant:"destructive",onClick:()=>A(!0)}],actionGroups:[{id:"status-update",label:"Update Status",icon:e.jsx(Te,{className:"h-4 w-4 mr-1"}),options:[{value:"Pending",label:"Pending"},{value:"Processing",label:"Processing"},{value:"In Transit",label:"In Transit"},{value:"Delivered",label:"Delivered"}],onSelect:s=>ye(s)}],className:"mb-4"}),e.jsx(Re,{open:je,onOpenChange:A,itemCount:K,itemType:"shipment",itemNames:Se,onConfirm:Ce,isLoading:z}),ne?e.jsx(Ke,{rows:8}):T.length===0?e.jsx(ze,{icon:Pe,title:"No shipments found",description:f||c||o?"Try adjusting your search or date filters":"Get started by creating your first shipment",actionLabel:f||c||o?void 0:"Create Shipment",onAction:f||c||o?void 0:()=>b(!0)}):e.jsxs("div",{className:"rounded-md border",children:[e.jsxs(Ge,{children:[e.jsx(Ve,{children:e.jsxs(te,{children:[e.jsx(m,{className:"w-12",children:e.jsx(X,{checked:oe,ref:s=>{s&&(s.indeterminate=ue)},onCheckedChange:E,"aria-label":"Select all shipments"})}),e.jsx(m,{children:"Shipment ID"}),e.jsx(m,{children:"Order ID"}),e.jsx(m,{children:"Destination"}),e.jsx(m,{children:"Carrier"}),e.jsx(m,{children:"Status"}),e.jsx(m,{children:"ETA"}),e.jsx(m,{children:"Actions"})]})}),e.jsx(_e,{children:H.map(s=>{const t=xe(s.id);return e.jsxs(te,{className:Ee(t&&"bg-muted/50"),children:[e.jsx(j,{children:e.jsx(X,{checked:t,onCheckedChange:()=>he(s.id),"aria-label":`Select shipment ${s.id}`})}),e.jsx(j,{children:s.id}),e.jsx(j,{children:s.orderId}),e.jsx(j,{children:s.destination}),e.jsx(j,{children:s.carrier}),e.jsx(j,{children:e.jsx(J,{variant:"secondary",className:ve(s.status),children:s.status})}),e.jsx(j,{children:s.eta}),e.jsx(j,{children:e.jsxs(W,{open:w===s.id,onOpenChange:r=>{I(r?s.id:null),r&&i({...s})},children:[e.jsx(Y,{asChild:!0,children:e.jsx(p,{variant:"ghost",size:"sm",children:"Track"})}),e.jsxs(Z,{children:[e.jsxs(ee,{children:[e.jsxs(se,{children:["Edit Shipment - ",s.id]}),e.jsx(ae,{children:"Update fields and save your changes."})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{htmlFor:"edit-orderId",children:"Order ID"}),e.jsx(d,{id:"edit-orderId",value:a.orderId,onChange:r=>i({...a,orderId:r.target.value})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{htmlFor:"edit-destination",children:"Destination"}),e.jsx(d,{id:"edit-destination",value:a.destination,onChange:r=>i({...a,destination:r.target.value})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{htmlFor:"edit-carrier",children:"Carrier"}),e.jsx(d,{id:"edit-carrier",value:a.carrier,onChange:r=>i({...a,carrier:r.target.value})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{htmlFor:"edit-status",children:"Status"}),e.jsx(d,{id:"edit-status",value:a.status,onChange:r=>i({...a,status:r.target.value})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(u,{htmlFor:"edit-eta",children:"ETA"}),e.jsx(d,{id:"edit-eta",value:a.eta,onChange:r=>i({...a,eta:r.target.value})})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(p,{className:"flex-1",onClick:fe,children:"Save Changes"}),e.jsx(p,{variant:"destructive",onClick:()=>pe(s.id),children:"Delete"})]})]})]})]})})]},s.id)})})]}),T.length>0&&e.jsx(Qe,{currentPage:q,totalPages:ie,onPageChange:le,itemsPerPage:ce,totalItems:de})]})]})]})]})}export{as as ShipmentsView};
